# ğŸ“Š è¡¨æ ¼è¡¨å¤´è´§å¸ç¬¦å·åŠ¨æ€åˆ‡æ¢ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

åœ¨ data-analysis.html é¡µé¢ä¸­,è¡¨æ ¼è¡¨å¤´çš„è´§å¸å•ä½æ˜¯ç¡¬ç¼–ç çš„:
- **ä¸­æ–‡ç¯å¢ƒ**: æ˜¾ç¤º `å……ç”µæˆæœ¬(å…ƒ)`ã€`å–ç”µåˆ©æ¶¦(å…ƒ)` ç­‰
- **è‹±æ–‡ç¯å¢ƒ**: æ˜¾ç¤º `Charge Cost(Â¥)`ã€`Selling Profit(Â¥)` ç­‰

**é—®é¢˜:** è‹±æ–‡ç¯å¢ƒä¸‹åº”è¯¥æ˜¾ç¤º `$` ç¬¦å·,è€Œä¸æ˜¯ `Â¥` ç¬¦å·!

### é”™è¯¯ç¤ºä¾‹
```
è‹±æ–‡ç¯å¢ƒä¸‹çš„è¡¨å¤´:
Charge Cost(Â¥) | Selling Profit(Â¥) | Net Profit(Â¥)
                âŒ åº”è¯¥æ˜¯ $ è€Œä¸æ˜¯ Â¥
```

## ğŸ” æ ¹æœ¬åŸå› 

### 1. ç¿»è¯‘æ–‡æœ¬ç¡¬ç¼–ç äº†è´§å¸ç¬¦å·

**common.js ä¸­çš„ç¿»è¯‘å®šä¹‰:**

```javascript
// ä¸­æ–‡ç¿»è¯‘
zh: {
    dataAnalysisTableHeaderChargeCost: 'å……ç”µæˆæœ¬(å…ƒ)',  // âŒ ç¡¬ç¼–ç 
    dataAnalysisTableHeaderSellProfit: 'å–ç”µåˆ©æ¶¦(å…ƒ)',
    // ...
}

// è‹±æ–‡ç¿»è¯‘
en: {
    dataAnalysisTableHeaderChargeCost: 'Charge Cost(Â¥)',  // âŒ ç¡¬ç¼–ç 
    dataAnalysisTableHeaderSellProfit: 'Selling Profit(Â¥)',
    // ...
}
```

### 2. setLanguage åªåšé™æ€ç¿»è¯‘æ›¿æ¢

`setLanguage` å‡½æ•°ç›´æ¥ä½¿ç”¨ç¿»è¯‘æ–‡æœ¬,æ— æ³•åŠ¨æ€ä¿®æ”¹è´§å¸ç¬¦å·:

```javascript
// å¤„ç†data-translateå±æ€§çš„å…ƒç´ 
document.querySelectorAll('[data-translate]').forEach(el => {
    const key = el.getAttribute('data-translate');
    if (t[key]) {
        el.textContent = t[key];  // âŒ ç›´æ¥ä½¿ç”¨å¸¦ç¡¬ç¼–ç ç¬¦å·çš„ç¿»è¯‘
    }
});
```

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯
**åˆ†ç¦»å†…å®¹ä¸æ ¼å¼:**
1. ç¿»è¯‘æ–‡æœ¬ä¸­åªä¿ç•™åŸºç¡€æ–‡æœ¬(ä¸å«è´§å¸ç¬¦å·)
2. æ·»åŠ ä¸“é—¨çš„å‡½æ•°åŠ¨æ€æ·»åŠ è´§å¸å•ä½
3. è¯­è¨€åˆ‡æ¢æ—¶è‡ªåŠ¨æ›´æ–°

### å®ç°æ­¥éª¤

#### æ­¥éª¤ 1: ä¿®æ”¹ç¿»è¯‘æ–‡æœ¬ (common.js)

**ä¿®æ”¹å‰:**
```javascript
zh: {
    dataAnalysisTableHeaderChargeCost: 'å……ç”µæˆæœ¬(å…ƒ)',
    dataAnalysisTableHeaderSellProfit: 'å–ç”µåˆ©æ¶¦(å…ƒ)',
    dataAnalysisTableHeaderNetProfit: 'å‡€åˆ©æ¶¦(å…ƒ)',
    dataAnalysisTableHeaderSelfSaving: 'è‡ªç”¨èŠ‚çœ(å…ƒ)',
    dataAnalysisTableHeaderTotalRevenue: 'æ€»æ”¶ç›Š(å…ƒ)',
}

en: {
    dataAnalysisTableHeaderChargeCost: 'Charge Cost(Â¥)',
    dataAnalysisTableHeaderSellProfit: 'Selling Profit(Â¥)',
    dataAnalysisTableHeaderNetProfit: 'Net Profit(Â¥)',
    dataAnalysisTableHeaderSelfSaving: 'Self-use Saving(Â¥)',
    dataAnalysisTableHeaderTotalRevenue: 'Total Revenue(Â¥)',
}
```

**ä¿®æ”¹å:**
```javascript
zh: {
    dataAnalysisTableHeaderChargeCost: 'å……ç”µæˆæœ¬',  // âœ… ç§»é™¤ (å…ƒ)
    dataAnalysisTableHeaderSellProfit: 'å–ç”µåˆ©æ¶¦',
    dataAnalysisTableHeaderNetProfit: 'å‡€åˆ©æ¶¦',
    dataAnalysisTableHeaderSelfSaving: 'è‡ªç”¨èŠ‚çœ',
    dataAnalysisTableHeaderTotalRevenue: 'æ€»æ”¶ç›Š',
}

en: {
    dataAnalysisTableHeaderChargeCost: 'Charge Cost',  // âœ… ç§»é™¤ (Â¥)
    dataAnalysisTableHeaderSellProfit: 'Selling Profit',
    dataAnalysisTableHeaderNetProfit: 'Net Profit',
    dataAnalysisTableHeaderSelfSaving: 'Self-use Saving',
    dataAnalysisTableHeaderTotalRevenue: 'Total Revenue',
}
```

**ä¿®æ”¹ä½ç½®:**
- [common.js:3041-3045](common.js#L3041-L3045) - ä¸­æ–‡ç¿»è¯‘
- [common.js:6419-6423](common.js#L6419-L6423) - è‹±æ–‡ç¿»è¯‘

#### æ­¥éª¤ 2: æ·»åŠ  updateTableHeaderCurrency å‡½æ•° (common.js)

**æ–°å¢å‡½æ•°:**
```javascript
// æ›´æ–°è¡¨æ ¼è¡¨å¤´ä¸­çš„è´§å¸ç¬¦å·
function updateTableHeaderCurrency() {
    const currencyUnit = currentLang === 'zh' ? '(å…ƒ)' : `(${getCurrencySymbol()})`;

    // Data Analysis é¡µé¢çš„è¡¨å¤´
    const revenueHeaders = [
        'dataAnalysisTableHeaderChargeCost',
        'dataAnalysisTableHeaderSellProfit',
        'dataAnalysisTableHeaderNetProfit',
        'dataAnalysisTableHeaderSelfSaving',
        'dataAnalysisTableHeaderTotalRevenue'
    ];

    revenueHeaders.forEach(key => {
        const elements = document.querySelectorAll(`[data-translate="${key}"]`);
        elements.forEach(element => {
            const baseText = translations[currentLang][key];
            if (baseText) {
                element.textContent = `${baseText}${currencyUnit}`;
            }
        });
    });
}
```

**åŠŸèƒ½è¯´æ˜:**
- **ä¸­æ–‡ç¯å¢ƒ**: æ·»åŠ  `(å…ƒ)` å•ä½
- **è‹±æ–‡ç¯å¢ƒ**: æ·»åŠ  `($)` å•ä½,åŠ¨æ€è·å–è´§å¸ç¬¦å·

**æ·»åŠ ä½ç½®:** [common.js:7050-7072](common.js#L7050-L7072)

#### æ­¥éª¤ 3: åœ¨ setLanguage ä¸­è°ƒç”¨ (common.js)

åœ¨ `setLanguage` å‡½æ•°æœ«å°¾æ·»åŠ è°ƒç”¨:

```javascript
function setLanguage(lang) {
    // ... ç°æœ‰çš„ç¿»è¯‘é€»è¾‘ ...

    // æ›´æ–°è¡¨æ ¼è¡¨å¤´ä¸­çš„è´§å¸ç¬¦å·
    if (typeof updateTableHeaderCurrency === 'function') {
        updateTableHeaderCurrency();
    }
}
```

**ä¿®æ”¹ä½ç½®:** [common.js:7180-7183](common.js#L7180-L7183)

#### æ­¥éª¤ 4: åœ¨é¡µé¢åˆå§‹åŒ–æ—¶è°ƒç”¨ (data-analysis.html)

```javascript
document.addEventListener('DOMContentLoaded', function() {
    // åˆå§‹åŒ–è´§å¸æ˜¾ç¤º
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // åˆå§‹åŒ–è¡¨å¤´è´§å¸ç¬¦å·
    if (typeof updateTableHeaderCurrency === 'function') {
        updateTableHeaderCurrency();  // âœ… æ–°å¢
    }

    initStatisticTimePicker('monthly');
    initCharts();
    queryData();
});
```

**ä¿®æ”¹ä½ç½®:** [data-analysis.html:1137-1140](data-analysis.html#L1137-L1140)

#### æ­¥éª¤ 5: åœ¨è¯­è¨€åˆ‡æ¢æ—¶è°ƒç”¨ (data-analysis.html)

```javascript
window.addEventListener('languageChanged', function() {
    // æ›´æ–°æ‰€æœ‰å¸¦ data-revenue å±æ€§çš„å…ƒç´ 
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // æ›´æ–°è¡¨å¤´è´§å¸ç¬¦å·
    if (typeof updateTableHeaderCurrency === 'function') {
        updateTableHeaderCurrency();  // âœ… æ–°å¢
    }

    // æ›´æ–°å›¾è¡¨
    if (typeof updateRevenueTrendChart === 'function') {
        updateRevenueTrendChart();
    }
    if (typeof updateRevenueStructureChart === 'function') {
        updateRevenueStructureChart();
    }
});
```

**ä¿®æ”¹ä½ç½®:** [data-analysis.html:1154-1157](data-analysis.html#L1154-L1157)

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¸­æ–‡ç¯å¢ƒ
```
è¡¨å¤´æ˜¾ç¤º:
å……ç”µæˆæœ¬(å…ƒ) | å–ç”µåˆ©æ¶¦(å…ƒ) | å‡€åˆ©æ¶¦(å…ƒ) | è‡ªç”¨èŠ‚çœ(å…ƒ) | æ€»æ”¶ç›Š(å…ƒ)
```

### è‹±æ–‡ç¯å¢ƒ
```
è¡¨å¤´æ˜¾ç¤º:
Charge Cost($) | Selling Profit($) | Net Profit($) | Self-use Saving($) | Total Revenue($)
         âœ… æ­£ç¡®æ˜¾ç¤º $ ç¬¦å·
```

## ğŸ“Š å®Œæ•´çš„æ›´æ–°æµç¨‹

```
é¡µé¢åŠ è½½
    â†“
DOMContentLoaded äº‹ä»¶
    â†“
setLanguage(currentLang)
    â†“
ç¿»è¯‘åŸºç¡€æ–‡æœ¬ â†’ updateTableHeaderCurrency()
    â†“
æ·»åŠ è´§å¸å•ä½: "å……ç”µæˆæœ¬" + "(å…ƒ)" / "Charge Cost" + "($)"
    â†“
æœ€ç»ˆæ˜¾ç¤º: "å……ç”µæˆæœ¬(å…ƒ)" / "Charge Cost($)"

---

ç”¨æˆ·åˆ‡æ¢è¯­è¨€
    â†“
selectLanguage(lang)
    â†“
window.dispatchEvent('languageChanged')
    â†“
languageChanged äº‹ä»¶ç›‘å¬å™¨
    â†“
updateTableHeaderCurrency()
    â†“
é‡æ–°æ·»åŠ è´§å¸å•ä½
    â†“
è¡¨å¤´æ›´æ–°å®Œæˆ
```

## âœ… éªŒè¯æ¸…å•

### åŸºç¡€éªŒè¯
- [ ] é¡µé¢åŠ è½½å,ä¸­æ–‡ç¯å¢ƒè¡¨å¤´æ˜¾ç¤º `(å…ƒ)`
- [ ] é¡µé¢åŠ è½½å,è‹±æ–‡ç¯å¢ƒè¡¨å¤´æ˜¾ç¤º `($)`
- [ ] è¡¨å¤´æ–‡æœ¬ç¿»è¯‘æ­£ç¡®

### åŠ¨æ€åˆ‡æ¢éªŒè¯
- [ ] ä¸­æ–‡ â†’ è‹±æ–‡: è¡¨å¤´ä» `(å…ƒ)` å˜ä¸º `($)`
- [ ] è‹±æ–‡ â†’ ä¸­æ–‡: è¡¨å¤´ä» `($)` å˜ä¸º `(å…ƒ)`
- [ ] åˆ‡æ¢ååŸºç¡€æ–‡æœ¬ç¿»è¯‘æ­£ç¡®

### å®Œæ•´æ€§éªŒè¯
- [ ] æ‰€æœ‰ 5 ä¸ªæ”¶ç›Šç›¸å…³è¡¨å¤´éƒ½æ­£ç¡®æ›´æ–°
  - Charge Cost / å……ç”µæˆæœ¬
  - Selling Profit / å–ç”µåˆ©æ¶¦
  - Net Profit / å‡€åˆ©æ¶¦
  - Self-use Saving / è‡ªç”¨èŠ‚çœ
  - Total Revenue / æ€»æ”¶ç›Š

### å…¶ä»–é¡µé¢éªŒè¯
- [ ] dashboard.html ä¸å—å½±å“
- [ ] devices.html ä¸å—å½±å“
- [ ] å…¶ä»–é¡µé¢æ­£å¸¸å·¥ä½œ

## ğŸš€ æ‰©å±•æ€§

### æ”¯æŒæ›´å¤šé¡µé¢

å¦‚æœå…¶ä»–é¡µé¢ä¹Ÿéœ€è¦è¡¨å¤´è´§å¸ç¬¦å·åŠ¨æ€åˆ‡æ¢:

```javascript
function updateTableHeaderCurrency() {
    const currencyUnit = currentLang === 'zh' ? '(å…ƒ)' : `(${getCurrencySymbol()})`;

    // å®šä¹‰æ‰€æœ‰éœ€è¦åŠ¨æ€è´§å¸ç¬¦å·çš„è¡¨å¤´
    const revenueHeaders = [
        // Data Analysis é¡µé¢
        'dataAnalysisTableHeaderChargeCost',
        'dataAnalysisTableHeaderSellProfit',
        // ... å…¶ä»–è¡¨å¤´

        // æ–°å¢å…¶ä»–é¡µé¢çš„è¡¨å¤´
        'otherPageHeaderRevenue',
        'otherPageHeaderProfit',
    ];

    // ... æ›´æ–°é€»è¾‘ä¿æŒä¸å˜
}
```

### æ”¯æŒæ›´å¤šè´§å¸

ä¿®æ”¹ `getCurrencySymbol()` å³å¯:

```javascript
function getCurrencySymbol() {
    const currencyMap = {
        'zh': 'Â¥',
        'en': '$',
        'eu': 'â‚¬',
        'jp': 'Â¥',
    };
    return currencyMap[currentLang] || '$';
}
```

ä¸­æ–‡ç¯å¢ƒä»ç„¶ä½¿ç”¨ `(å…ƒ)`,å…¶ä»–è¯­è¨€ä½¿ç”¨ `(ç¬¦å·)`:

```javascript
const currencyUnit = currentLang === 'zh'
    ? '(å…ƒ)'
    : `(${getCurrencySymbol()})`;
```

## ğŸ“ ä»£ç è´¨é‡

### âœ… ç¬¦åˆçš„åŸåˆ™

**KISS (Keep It Simple):**
- ç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥,æ— å¤æ‚é€»è¾‘
- æ¸…æ™°çš„å‡½æ•°å‘½å

**DRY (Don't Repeat Yourself):**
- ç»Ÿä¸€çš„ `updateTableHeaderCurrency()` å‡½æ•°
- é¿å…åœ¨å¤šå¤„ç¡¬ç¼–ç è´§å¸å•ä½

**å•ä¸€èŒè´£:**
- `updateTableHeaderCurrency()` åªè´Ÿè´£æ›´æ–°è¡¨å¤´è´§å¸ç¬¦å·
- ä¸å½±å“å…¶ä»–ç¿»è¯‘é€»è¾‘

**å¯æ‰©å±•æ€§:**
- æ˜“äºæ·»åŠ æ–°çš„è¡¨å¤´
- æ˜“äºæ”¯æŒæ–°çš„è¯­è¨€/è´§å¸

## ğŸ‰ ä¿®å¤æ€»ç»“

| ä¿®æ”¹é¡¹ | æ–‡ä»¶ | è¡Œå· | è¯´æ˜ |
|--------|------|------|------|
| ç§»é™¤ç¡¬ç¼–ç (ä¸­æ–‡) | common.js | 3041-3045 | ç§»é™¤ `(å…ƒ)` |
| ç§»é™¤ç¡¬ç¼–ç (è‹±æ–‡) | common.js | 6419-6423 | ç§»é™¤ `(Â¥)` |
| æ–°å¢å‡½æ•° | common.js | 7050-7072 | `updateTableHeaderCurrency()` |
| setLanguageè°ƒç”¨ | common.js | 7180-7183 | æ·»åŠ å‡½æ•°è°ƒç”¨ |
| é¡µé¢åˆå§‹åŒ– | data-analysis.html | 1137-1140 | æ·»åŠ å‡½æ•°è°ƒç”¨ |
| è¯­è¨€åˆ‡æ¢ç›‘å¬ | data-analysis.html | 1154-1157 | æ·»åŠ å‡½æ•°è°ƒç”¨ |

---

**ä¿®å¤å®Œæˆæ—¥æœŸ**: 2026-01-13
**ä¿®å¤è€…**: Claude Code
**ç›¸å…³æ–‡æ¡£**:
- [æ”¶ç›Šè´§å¸ç¬¦å·å›½é™…åŒ–è¯´æ˜.md](./æ”¶ç›Šè´§å¸ç¬¦å·å›½é™…åŒ–è¯´æ˜.md)
- [NaNé”™è¯¯ä¿®å¤è¯´æ˜.md](./NaNé”™è¯¯ä¿®å¤è¯´æ˜.md)
