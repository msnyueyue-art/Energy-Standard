# 触摸屏数据页历史数据标签恢复显示说明

## 问题描述
在触摸屏数据页面 (touchscreen/data.html) 的英文环境下,所有组件(整机、EMS、PCS、BMS、电表、温度、消防)的"Historical Data"(历史数据)标签被隐藏,用户无法点击查看历史数据。

## 问题原因
代码中有一个 `toggleHistoricalDataTabs()` 函数(第8430-8460行),该函数在英文环境下强制隐藏了所有组件的历史数据标签。

**原始代码:**
```javascript
const hiddenComponents = [
    'overall',  // 整机
    'ems',      // EMS
    'pcs',      // PCS
    'bms',      // BMS
    'meter',    // 电表
    'thermal',  // 温度
    'fire'      // 消防
];
```

当语言为英文时,这些组件的历史数据标签会被设置为 `display: 'none'`,导致完全不可见和不可点击。

## 修复方案

### 清空隐藏组件列表

将 `hiddenComponents` 数组中的所有组件注释掉,使其成为空数组:

**修改前:**
```javascript
const hiddenComponents = [
    'overall',  // 整机
    'ems',      // EMS
    'pcs',      // PCS
    'bms',      // BMS
    'meter',    // 电表
    'thermal',  // 温度
    'fire'      // 消防
];
```

**修改后:**
```javascript
// 已恢复所有组件的历史数据标签显示
const hiddenComponents = [
    // 'overall',  // 整机 - 已恢复显示
    // 'ems',      // EMS - 已恢复显示
    // 'pcs',      // PCS - 已恢复显示
    // 'bms',      // BMS - 已恢复显示
    // 'meter',    // 电表 - 已恢复显示
    // 'thermal',  // 温度 - 已恢复显示
    // 'fire'      // 消防 - 已恢复显示
];
```

## 修复效果

### 英文环境下
所有组件的"Historical Data"标签现在都会正常显示并支持点击:
- ✅ **Overall** - Historical Data 标签可见可点击
- ✅ **EMS** - Historical Data 标签可见可点击
- ✅ **PCS** - Historical Data 标签可见可点击
- ✅ **BMS** - Historical Data 标签可见可点击
- ✅ **Meter** - Historical Data 标签可见可点击
- ✅ **Temp** (温度) - Historical Data 标签可见可点击
- ✅ **Fire Prote...** (消防) - Historical Data 标签可见可点击

### 中文环境下
所有组件的"历史数据"标签保持正常显示(原本就正常):
- ✅ **整机** - 历史数据标签可见可点击
- ✅ **EMS** - 历史数据标签可见可点击
- ✅ **PCS** - 历史数据标签可见可点击
- ✅ **BMS** - 历史数据标签可见可点击
- ✅ **电表** - 历史数据标签可见可点击
- ✅ **温度** - 历史数据标签可见可点击
- ✅ **消防** - 历史数据标签可见可点击

## 测试方法

### 英文环境测试
1. 打开触摸屏数据页面: `touchscreen/data.html`
2. 切换到英文环境(点击右上角语言切换按钮)
3. 逐个点击左侧设备列表中的设备:
   - Overall
   - EMS
   - PCS
   - BMS
   - Meter
   - Temp
   - Fire Prote...
4. 对每个设备,验证顶部有两个标签:
   - "Real-time Data" (实时数据)
   - "Historical Data" (历史数据) ← 应该可见
5. 点击"Historical Data"标签,验证可以正常切换到历史数据视图

### 中文环境测试
1. 切换到中文环境
2. 重复上述测试步骤
3. 验证"历史数据"标签正常显示和点击

## 功能说明

历史数据标签用于展示各组件的历史数据图表,包括:
- **整机**: 功率与SOC综合分析、收益分析、能量统计等
- **EMS**: 策略执行历史、调度指令记录等
- **PCS**: 功率转换历史、效率分析等
- **BMS**: 电池电压历史、温度趋势等
- **电表**: 功率趋势、电能质量分析等
- **温度**: 温度分布历史、温控性能分析等
- **消防**: 系统状态历史、告警记录等

## 技术说明

`toggleHistoricalDataTabs()` 函数的工作原理:
1. 获取当前语言设置
2. 遍历 `hiddenComponents` 数组中的组件
3. 找到每个组件的历史数据按钮
4. 根据语言设置控制按钮的 `display` 样式

通过清空 `hiddenComponents` 数组,函数不再隐藏任何组件的历史数据标签。

## 相关文件
- `touchscreen/data.html` - 数据页面(包含所有组件的实时和历史数据视图)

## 修复日期
2026-01-14

## 注意事项
- 此修复不影响任何现有功能
- 历史数据标签的国际化翻译已经正确配置
- 标签点击事件已经正确绑定到 `switchSubTab()` 函数
- 如果将来需要隐藏某个组件的历史数据标签,只需在 `hiddenComponents` 数组中添加对应的组件名称即可
