# 电价设置页面英文模拟数据修复说明

## 修复概述

为电价设置页面 (`electricity-price-new.html`) 在英文环境下添加了模拟数据显示功能。

## 问题描述

之前在英文环境下切换语言时,购电模板和上网模板列表会清空,不显示任何数据。这是因为代码中将英文环境的数据设置为空数组。

## 修复内容

### 1. 新增英文模拟数据数组 `mockTemplatesEn`

在 `electricity-price-new.html` 文件的第 2560-3175 行,新增了完整的英文版模拟数据数组,包含 18 个模板:

**购电模板 (Purchase Templates) - 9个:**
1. Tiered Pricing - Fixed (阶梯电价-固定)
2. Tiered Pricing - Monthly (阶梯电价-逐月)
3. Tiered Pricing - Seasonal (阶梯电价-分季节)
4. Time-of-Use - Fixed (分时电价-固定)
5. Time-of-Use - Monthly (分时电价-逐月)
6. Time-of-Use - Seasonal (分时电价-分季节)
7. Fixed Price - Fixed (固定电价-固定)
8. Fixed Price - Monthly (固定电价-逐月)
9. Fixed Price - Seasonal (固定电价-分季节)

**上网模板 (Feed-in Templates) - 9个:**
10. Tiered Feed-in - Fixed (阶梯上网-固定)
11. Tiered Feed-in - Monthly (阶梯上网-逐月)
12. Tiered Feed-in - Seasonal (阶梯上网-分季节)
13. Time-of-Use Feed-in - Fixed (分时上网-固定)
14. Time-of-Use Feed-in - Monthly (分时上网-逐月)
15. Time-of-Use Feed-in - Seasonal (分时上网-分季节)
16. Fixed Feed-in - Fixed (固定上网-固定)
17. Fixed Feed-in - Monthly (固定上网-逐月)
18. Fixed Feed-in - Seasonal (固定上网-分季节)

### 2. 修改数据初始化逻辑

**修改位置:** 第 3177-3182 行

**修改前:**
```javascript
// 根据语言环境初始化数据
if (currentLang === 'zh') {
    templates = mockTemplatesZh;
}
```

**修改后:**
```javascript
// 根据语言环境初始化数据
if (currentLang === 'zh') {
    templates = mockTemplatesZh;
} else {
    templates = mockTemplatesEn;
}
```

### 3. 修改语言切换事件监听器

**修改位置:** 第 3678-3689 行

**修改前:**
```javascript
window.addEventListener('languageChanged', function(event) {
    const newLang = localStorage.getItem('language') || 'zh';
    if (newLang === 'zh') {
        templates = mockTemplatesZh;
    } else {
        templates = [];  // 英文环境清空数据
    }
    renderTemplates();
    renderSites();
});
```

**修改后:**
```javascript
window.addEventListener('languageChanged', function(event) {
    const newLang = localStorage.getItem('language') || 'zh';
    if (newLang === 'zh') {
        templates = mockTemplatesZh;
    } else {
        templates = mockTemplatesEn;
    }
    renderTemplates();
    renderSites();
});
```

## 数据特点

1. **结构一致性:** 英文数据结构与中文数据完全一致,仅翻译了以下字段:
   - `name`: 模板名称
   - `typeName`: 电价类型名称
   - `description`: 模板描述
   - 季节名称 (Summer, Winter, Spring and Autumn)
   - 时段名称 (Peak, Sharp Peak, Flat, Valley)

2. **数据完整性:** 包含所有必要字段:
   - 基本信息: id, name, type, typeName, description, purpose
   - 配置数据: tiers, periods (根据模板类型不同)
   - 时间信息: createTime

3. **交互功能保持不变:** 所有交互逻辑和功能保持不变,仅改变显示数据

## 测试建议

1. 在中文环境下,验证购电和上网模板显示中文数据
2. 切换到英文环境,验证购电和上网模板显示英文数据
3. 来回切换语言,确保数据正确切换
4. 验证表格各列数据显示正确:
   - Template Name (模板名称)
   - Price Type (电价类型)
   - Description (描述)
   - Applied Sites (已应用站点)
   - Created Time (创建时间)
   - Actions (操作)

## 日期

修复日期: 2026-01-14
