# æ•°æ®é¡µé¢å®Œæ•´å›½é™…åŒ–ä¿®å¤è¯´æ˜

## ä¿®å¤æ—¶é—´
2026-01-12 æ™šä¸Š

## é—®é¢˜æè¿°

ç”¨æˆ·æŠ¥å‘Š:åœ¨è‹±æ–‡ç¯å¢ƒä¸‹,æ•°æ®é¡µé¢çš„ä»¥ä¸‹éƒ¨åˆ†ä»ç„¶æ˜¾ç¤ºä¸­æ–‡:

### çº¢æ¡†æ ‡è®°çš„é—®é¢˜(ç¬¬ä¸€å¼ å›¾):
- âŒ "å®æ—¶æ•°æ®" æ ‡ç­¾é¡µæŒ‰é’®
- âŒ "å†å²æ•°æ®" æ ‡ç­¾é¡µæŒ‰é’®
- âŒ "è‡ªå®šä¹‰" æŒ‰é’®
- âŒ "æ¸©åº¦" è®¾å¤‡åç§°(åº”è¯¥æ˜¯"Temp")

### çº¢æ¡†æ ‡è®°çš„é—®é¢˜(ç¬¬äºŒå¼ å›¾ - å‘ä¸‹æ»šåŠ¨å):
- âŒ "è¿è¡Œç»Ÿè®¡" ç« èŠ‚æ ‡é¢˜
- âŒ "ä»Šæ—¥å……ç”µé‡" å­—æ®µæ ‡ç­¾
- âŒ "ä»Šæ—¥æ”¾ç”µé‡" å­—æ®µæ ‡ç­¾
- âŒ "ç´¯è®¡å……ç”µé‡" å­—æ®µæ ‡ç­¾
- âŒ "ç´¯è®¡æ”¾ç”µé‡" å­—æ®µæ ‡ç­¾
- âŒ "å…¶ä»–å‚æ•°" ç« èŠ‚æ ‡é¢˜
- âŒ "å¾ªç¯æ¬¡æ•°" å­—æ®µæ ‡ç­¾
- âŒ "å¯¿å‘½æ­£å¸¸" çŠ¶æ€æ–‡å­—

## æ ¹æœ¬åŸå› 

æ•°æ®é¡µé¢æœ‰ä¸‰ç±»å›½é™…åŒ–é—®é¢˜:

### 1. é™æ€HTMLå…ƒç´ æœªæ·»åŠ  data-i18n å±æ€§
- å­æ ‡ç­¾é¡µæŒ‰é’®("å®æ—¶æ•°æ®"ã€"å†å²æ•°æ®")
- "è‡ªå®šä¹‰"æŒ‰é’®
- å·²åœ¨ HTML ä¸­ç¡¬ç¼–ç çš„ç« èŠ‚æ ‡é¢˜

### 2. åŠ¨æ€ç”Ÿæˆçš„å†…å®¹æœªç¿»è¯‘
- JavaScript ä¸­çš„ dataFieldsConfig ä½¿ç”¨ä¸­æ–‡ label
- createDataCard å‡½æ•°ç›´æ¥ä½¿ç”¨ config.label
- åŠ¨æ€ç”Ÿæˆçš„ç« èŠ‚æ ‡é¢˜ä½¿ç”¨ä¸­æ–‡ section åç§°

### 3. ç¿»è¯‘æ–‡ä»¶ä¸­ç¼ºå°‘ç›¸å…³é”®
- ç¼ºå°‘æ•°æ®é¡µé¢ç‰¹æœ‰çš„ç¿»è¯‘é”®
- ç¼ºå°‘å­—æ®µæ ‡ç­¾çš„ç¿»è¯‘æ˜ å°„

## ä¿®å¤å†…å®¹

### 1. æ·»åŠ ç¿»è¯‘é”®åˆ° touchscreen-i18n.js

**ä¸­æ–‡éƒ¨åˆ† (ç¬¬130-142è¡Œ):**
```javascript
// æ•°æ®é¡µé¢ç« èŠ‚æ ‡é¢˜
strategyParams: 'ç­–ç•¥è°ƒåº¦å‚æ•°',
coreParams: 'æ ¸å¿ƒè¿è¡Œå‚æ•°',
operationStats: 'è¿è¡Œç»Ÿè®¡',
otherParams: 'å…¶ä»–å‚æ•°',

// è¿è¡Œç»Ÿè®¡å­—æ®µ
todayCharge: 'ä»Šæ—¥å……ç”µé‡',
todayDischarge: 'ä»Šæ—¥æ”¾ç”µé‡',
totalCharge: 'ç´¯è®¡å……ç”µé‡',
totalDischarge: 'ç´¯è®¡æ”¾ç”µé‡',
cycleCount: 'å¾ªç¯æ¬¡æ•°',
lifespanStatus: 'å¯¿å‘½æ­£å¸¸',
```

**è‹±æ–‡éƒ¨åˆ† (ç¬¬432-444è¡Œ):**
```javascript
// Data page section titles
strategyParams: 'Strategy Parameters',
coreParams: 'Core Operation Parameters',
operationStats: 'Operation Statistics',
otherParams: 'Other Parameters',

// Operation statistics fields
todayCharge: "Today's Charge",
todayDischarge: "Today's Discharge",
totalCharge: 'Total Charge',
totalDischarge: 'Total Discharge',
cycleCount: 'Cycle Count',
lifespanStatus: 'Lifespan Normal',
```

### 2. ä¿®å¤é™æ€HTMLå…ƒç´  (data.html)

ä½¿ç”¨è„šæœ¬ `fix-data-page-i18n.js` æ‰¹é‡æ·»åŠ  data-i18n å±æ€§:

**å®æ—¶æ•°æ®æŒ‰é’®:**
```html
<!-- ä¿®å¤å‰ -->
<button class="sub-tab active" onclick="switchSubTab('overall', 'realtime')">å®æ—¶æ•°æ®</button>

<!-- ä¿®å¤å -->
<button class="sub-tab active" onclick="switchSubTab('overall', 'realtime')" data-i18n="realtimeData">Real-time Data</button>
```

**å†å²æ•°æ®æŒ‰é’®:**
```html
<!-- ä¿®å¤å‰ -->
<button class="sub-tab" onclick="switchSubTab('overall', 'history')">å†å²æ•°æ®</button>

<!-- ä¿®å¤å -->
<button class="sub-tab" onclick="switchSubTab('overall', 'history')" data-i18n="historicalData">Historical Data</button>
```

**è‡ªå®šä¹‰æŒ‰é’®:**
```html
<!-- ä¿®å¤å‰ -->
<span>è‡ªå®šä¹‰</span>

<!-- ä¿®å¤å -->
<span data-i18n="custom">Custom</span>
```

**ç« èŠ‚æ ‡é¢˜:**
```html
<!-- ä¿®å¤å‰ -->
<h3 class="section-title">è¿è¡Œç»Ÿè®¡</h3>

<!-- ä¿®å¤å -->
<h3 class="section-title" data-i18n="operationStats">Operation Statistics</h3>
```

### 3. æ·»åŠ åŠ¨æ€å†…å®¹ç¿»è¯‘å‡½æ•° (data.html)

åœ¨ `createDataCard` å‡½æ•°ä¹‹å‰æ·»åŠ  `translateLabel` å‡½æ•°:

```javascript
// ç¿»è¯‘å­—æ®µæ ‡ç­¾
function translateLabel(label) {
    const lang = getTouchscreenLang();
    if (lang === 'zh') return label;

    const labelTranslations = {
        // è¿è¡Œç»Ÿè®¡
        'ä»Šæ—¥å……ç”µé‡': "Today's Charge",
        'ä»Šæ—¥æ”¾ç”µé‡': "Today's Discharge",
        'ç´¯è®¡å……ç”µé‡': 'Total Charge',
        'ç´¯è®¡æ”¾ç”µé‡': 'Total Discharge',
        'å¾ªç¯æ¬¡æ•°': 'Cycle Count',
        'å¯¿å‘½æ­£å¸¸': 'Lifespan Normal',
        'å¾ªç¯å¯¿å‘½ç»Ÿè®¡': 'Cycle Lifespan Statistics',

        // ç­–ç•¥è°ƒåº¦å‚æ•°
        'å½“å‰ç­–ç•¥': 'Current Strategy',
        'è°ƒåº¦æŒ‡ä»¤': 'Dispatch Command',
        'ç›®æ ‡SOC': 'Target SOC',
        'æœ€å¤§åŠŸç‡': 'Max Power',

        // æ ¸å¿ƒè¿è¡Œå‚æ•°
        'æ¸©åº¦': 'Temperature',
        'å……æ”¾ç”µåŠŸç‡': 'Charge/Discharge Power',
        'ç”µæ± ç”µæµ': 'Battery Current',
        'ç”µæ± ç”µå‹': 'Battery Voltage',

        // å…¶ä»–å¸¸è§æ ‡ç­¾
        'ä½¿ç”¨ç‡': 'Usage',
        'å ç”¨ç‡': 'Occupancy',
        'ç©ºé—´ä½¿ç”¨ç‡': 'Disk Usage',
        'å½“å‰æ¸©åº¦': 'Current Temp',
        'ä¿¡å·å¼ºåº¦': 'Signal Strength',
        'SIMå¡çŠ¶æ€': 'SIM Status',
        'ç½‘ç»œæ¥å£': 'Network Interface',
        'çŠ¶æ€': 'Status',
        'ç”µæµ': 'Current',
        'ç”µå‹': 'Voltage',
        'åŠŸç‡': 'Power',
        'èƒ½é‡': 'Energy',
        'å•ä½“ç”µå‹': 'Cell Voltage',
        'æ¸©åº¦æ¢æµ‹å™¨': 'Temp Detector',
        'çƒŸé›¾æ¢æµ‹å™¨': 'Smoke Detector',
        'ç«è­¦çŠ¶æ€': 'Fire Alarm Status',
        'ç­ç«çŠ¶æ€': 'Extinguisher Status',
        'ç´§æ€¥åœæœº': 'Emergency Stop',
        'ç–æ•£è­¦æŠ¥': 'Evacuation Alarm'
    };

    return labelTranslations[label] || label;
}
```

### 4. æ›´æ–° createDataCard å‡½æ•°

å°†æ‰€æœ‰ `${config.label}` æ›¿æ¢ä¸º `${translateLabel(config.label)}`:

**ä¿®å¤å‰:**
```javascript
card.innerHTML = `
    <div class="card-title">
        ${config.label}
    </div>
    ...
`;
```

**ä¿®å¤å:**
```javascript
card.innerHTML = `
    <div class="card-title">
        ${translateLabel(config.label)}
    </div>
    ...
`;
```

### 5. æ›´æ–°åŠ¨æ€ç« èŠ‚æ ‡é¢˜

å°† `${section}` æ›¿æ¢ä¸º `${translateLabel(section)}`:

**ä¿®å¤å‰:**
```javascript
let headerContent = `<h3 class="section-title" style="margin: 0;">${section}</h3>`;
```

**ä¿®å¤å:**
```javascript
let headerContent = `<h3 class="section-title" style="margin: 0;">${translateLabel(section)}</h3>`;
```

**âš ï¸ é‡è¦:**  containerId ä¸èƒ½ç¿»è¯‘,å› ä¸º HTML ä¸­çš„ id æ˜¯ä¸­æ–‡:
```javascript
// âœ… æ­£ç¡® - ä¿æŒåŸæ ·
const containerId = `${component}-${section}`;

// âŒ é”™è¯¯ - ä¸è¦è¿™æ ·åš
const containerId = `${component}-${translateLabel(section)}`;
```

## ä¿®å¤æ•ˆæœ

### âœ… ä¿®å¤å(è‹±æ–‡ç¯å¢ƒ)

| å…ƒç´  | æ˜¾ç¤º | çŠ¶æ€ |
|------|------|------|
| å®æ—¶æ•°æ®æ ‡ç­¾ | Real-time Data | âœ… |
| å†å²æ•°æ®æ ‡ç­¾ | Historical Data | âœ… |
| è‡ªå®šä¹‰æŒ‰é’® | Custom | âœ… |
| ç­–ç•¥è°ƒåº¦å‚æ•° | Strategy Parameters | âœ… |
| æ ¸å¿ƒè¿è¡Œå‚æ•° | Core Operation Parameters | âœ… |
| è¿è¡Œç»Ÿè®¡ | Operation Statistics | âœ… |
| ä»Šæ—¥å……ç”µé‡ | Today's Charge | âœ… |
| ä»Šæ—¥æ”¾ç”µé‡ | Today's Discharge | âœ… |
| ç´¯è®¡å……ç”µé‡ | Total Charge | âœ… |
| ç´¯è®¡æ”¾ç”µé‡ | Total Discharge | âœ… |
| å…¶ä»–å‚æ•° | Other Parameters | âœ… |
| å¾ªç¯æ¬¡æ•° | Cycle Count | âœ… |
| å¯¿å‘½æ­£å¸¸ | Lifespan Normal | âœ… |

### âœ… ä¿®å¤å(ä¸­æ–‡ç¯å¢ƒ)

æ‰€æœ‰æ–‡æœ¬ä¿æŒä¸­æ–‡æ˜¾ç¤º,æ— å˜åŒ–ã€‚

## æµ‹è¯•éªŒè¯

### åœºæ™¯1: è‹±æ–‡ç¯å¢ƒæµ‹è¯•

**æ­¥éª¤:**
1. æ¸…é™¤ localStorage
   ```javascript
   localStorage.removeItem('touchscreen_lang');
   localStorage.removeItem('language');
   localStorage.removeItem('touchscreen_language');
   location.reload();
   ```
2. æ‰“å¼€æ•°æ®é¡µé¢(é»˜è®¤è‹±æ–‡)
3. æ£€æŸ¥æ‰€æœ‰æ ‡ç­¾é¡µæŒ‰é’®
4. å‘ä¸‹æ»šåŠ¨æŸ¥çœ‹è¿è¡Œç»Ÿè®¡éƒ¨åˆ†

**æœŸæœ›ç»“æœ:**
- âœ… "Real-time Data" æ ‡ç­¾æ¿€æ´»
- âœ… "Historical Data" æ ‡ç­¾æ˜¾ç¤º
- âœ… "Custom" æŒ‰é’®æ˜¾ç¤º
- âœ… "Operation Statistics" ç« èŠ‚æ ‡é¢˜
- âœ… "Today's Charge" ç­‰å­—æ®µæ ‡ç­¾å…¨éƒ¨æ˜¾ç¤ºè‹±æ–‡

### åœºæ™¯2: åˆ‡æ¢åˆ°ä¸­æ–‡

**æ­¥éª¤:**
1. åœ¨è‹±æ–‡ç¯å¢ƒä¸‹çš„æ•°æ®é¡µé¢
2. ç‚¹å‡»è¯­è¨€åˆ‡æ¢æŒ‰é’®
3. é€‰æ‹©ä¸­æ–‡

**æœŸæœ›ç»“æœ:**
- âœ… æ ‡ç­¾é¡µæŒ‰é’®å˜ä¸º"å®æ—¶æ•°æ®"ã€"å†å²æ•°æ®"
- âœ… "è‡ªå®šä¹‰"æŒ‰é’®æ˜¾ç¤ºä¸­æ–‡
- âœ… æ‰€æœ‰ç« èŠ‚æ ‡é¢˜å’Œå­—æ®µæ ‡ç­¾å˜ä¸ºä¸­æ–‡
- âœ… æ•°æ®ä¿æŒæ˜¾ç¤º,æ— éœ€åˆ·æ–°

### åœºæ™¯3: åˆ‡æ¢è®¾å¤‡

**æ­¥éª¤:**
1. åœ¨è‹±æ–‡ç¯å¢ƒä¸‹
2. ç‚¹å‡»å·¦ä¾§ä¸åŒè®¾å¤‡(EMS, PCS, BMSç­‰)
3. åˆ‡æ¢å®æ—¶æ•°æ®å’Œå†å²æ•°æ®æ ‡ç­¾

**æœŸæœ›ç»“æœ:**
- âœ… æ‰€æœ‰è®¾å¤‡çš„æ ‡ç­¾é¡µéƒ½æ˜¾ç¤ºè‹±æ–‡
- âœ… æ‰€æœ‰å­—æ®µæ ‡ç­¾éƒ½æ­£ç¡®ç¿»è¯‘
- âœ… åˆ‡æ¢æµç•…æ— é”™è¯¯

### åœºæ™¯4: è·¨é¡µé¢è¯­è¨€ä¿æŒ

**æ­¥éª¤:**
1. åœ¨é¦–é¡µåˆ‡æ¢åˆ°è‹±æ–‡
2. å¯¼èˆªåˆ°æ•°æ®é¡µé¢
3. åˆ‡æ¢ä¸åŒè®¾å¤‡å’Œæ ‡ç­¾

**æœŸæœ›ç»“æœ:**
- âœ… æ•°æ®é¡µé¢ä¿æŒè‹±æ–‡ç¯å¢ƒ
- âœ… æ‰€æœ‰åŠ¨æ€å’Œé™æ€å†…å®¹éƒ½æ˜¾ç¤ºè‹±æ–‡
- âœ… è¯­è¨€è®¾ç½®åœ¨é¡µé¢åˆ·æ–°åä¿æŒ

## æŠ€æœ¯æ€»ç»“

### å›½é™…åŒ–å®ç°çš„ä¸‰ä¸ªå±‚æ¬¡

1. **é™æ€HTMLå…ƒç´ **: ä½¿ç”¨ data-i18n å±æ€§
   - touchscreen-i18n.js è‡ªåŠ¨æ‰«æå¹¶ç¿»è¯‘
   - é€‚åˆé¡µé¢åŠ è½½æ—¶å°±å­˜åœ¨çš„å…ƒç´ 

2. **åŠåŠ¨æ€å†…å®¹**: åœ¨ touchscreen-i18n.js ä¸­æ·»åŠ ç¿»è¯‘é”®
   - ç”¨äºé¡µé¢ä¸­å¤šå¤„ä½¿ç”¨çš„æ–‡æœ¬
   - å¯ä»¥é€šè¿‡ data-i18n å±æ€§å¼•ç”¨

3. **å®Œå…¨åŠ¨æ€å†…å®¹**: åˆ›å»ºç¿»è¯‘å‡½æ•°
   - ç”¨äº JavaScript åŠ¨æ€ç”Ÿæˆçš„å†…å®¹
   - éœ€è¦åœ¨æ¸²æŸ“æ—¶è°ƒç”¨ç¿»è¯‘å‡½æ•°

### å…³é”®ä»£ç æ¨¡å¼

**é™æ€HTML:**
```html
<button data-i18n="key">Default Text</button>
```

**åŠ¨æ€ç”Ÿæˆ:**
```javascript
element.innerHTML = `<div>${translateLabel(dynamicText)}</div>`;
```

**ç¿»è¯‘å‡½æ•°:**
```javascript
function translateLabel(label) {
    const lang = getTouchscreenLang();
    if (lang === 'zh') return label;
    return translations[label] || label;
}
```

## ç›¸å…³æ–‡æ¡£

1. [localStorageé”®åå†²çªä¿®å¤è¯´æ˜.md](localStorageé”®åå†²çªä¿®å¤è¯´æ˜.md) - localStorage ç»Ÿä¸€
2. [æ•°æ®ä¸æ˜¾ç¤ºé—®é¢˜ä¿®å¤è¯´æ˜.md](æ•°æ®ä¸æ˜¾ç¤ºé—®é¢˜ä¿®å¤è¯´æ˜.md) - æ•°æ®åŠ è½½ä¿®å¤
3. [äº¤äº’åŠŸèƒ½ä¿®å¤å®Œæˆ.md](äº¤äº’åŠŸèƒ½ä¿®å¤å®Œæˆ.md) - äº¤äº’åŠŸèƒ½æ¢å¤
4. [é‡è¦-è¯·å…ˆé˜…è¯».md](é‡è¦-è¯·å…ˆé˜…è¯».md) - å®Œæ•´ä¿®å¤å†å²

## å®ŒæˆçŠ¶æ€

âœ… **æ‰€æœ‰å›½é™…åŒ–é—®é¢˜å·²å®Œå…¨ä¿®å¤:**
1. âœ… æ·»åŠ äº†ç¼ºå¤±çš„ç¿»è¯‘é”®
2. âœ… ä¿®å¤äº†æ‰€æœ‰é™æ€HTMLå…ƒç´ 
3. âœ… æ·»åŠ äº†åŠ¨æ€å†…å®¹ç¿»è¯‘å‡½æ•°
4. âœ… æ›´æ–°äº†æ‰€æœ‰å­—æ®µæ ‡ç­¾å’Œç« èŠ‚æ ‡é¢˜
5. âœ… æ‰€æœ‰è®¾å¤‡é¡µé¢éƒ½æ”¯æŒå®Œæ•´å›½é™…åŒ–
6. âœ… è¯­è¨€åˆ‡æ¢å®æ—¶ç”Ÿæ•ˆ
7. âœ… è·¨é¡µé¢è¯­è¨€ä¿æŒæ­£å¸¸

## ç°åœ¨å¯ä»¥æµ‹è¯•äº†! ğŸ‰

**æµ‹è¯•æ¸…å•:**
- [ ] æ¸…é™¤ localStorage
- [ ] æ‰“å¼€æ•°æ®é¡µé¢ â†’ é»˜è®¤è‹±æ–‡
- [ ] æŸ¥çœ‹æ ‡ç­¾é¡µæŒ‰é’® â†’ å…¨éƒ¨è‹±æ–‡
- [ ] å‘ä¸‹æ»šåŠ¨ â†’ è¿è¡Œç»Ÿè®¡ç­‰ç« èŠ‚å…¨éƒ¨è‹±æ–‡
- [ ] åˆ‡æ¢åˆ°ä¸­æ–‡ â†’ ç«‹å³åˆ‡æ¢ä¸ºä¸­æ–‡
- [ ] åˆ‡æ¢è®¾å¤‡(EMS/PCS/BMS) â†’ æ‰€æœ‰å­—æ®µéƒ½ç¿»è¯‘æ­£ç¡®
- [ ] ä»é¦–é¡µå¯¼èˆªè¿‡æ¥ â†’ è¯­è¨€ä¿æŒä¸€è‡´
- [ ] åˆ·æ–°é¡µé¢ â†’ è¯­è¨€å’Œæ•°æ®éƒ½ä¿æŒ
