# æ•°æ®é¡µé¢åŠ¨æ€å†…å®¹å›½é™…åŒ–ä¿®å¤è¯´æ˜

## ä¿®å¤æ—¶é—´
2026-01-12 æ™šä¸Š(ç¬¬äºŒè½®)

## é—®é¢˜æè¿°

ç”¨æˆ·å†æ¬¡æŠ¥å‘Š:åœ¨è‹±æ–‡ç¯å¢ƒä¸‹,æ•°æ®é¡µé¢çš„åŠ¨æ€ç”Ÿæˆå†…å®¹ä»ç„¶æ˜¾ç¤ºä¸­æ–‡:

### ğŸ”´ çº¢æ¡†æ ‡è®°çš„é—®é¢˜:

**å·¦ä¾§è®¾å¤‡èœå•:**
- âŒ "æ¸©åº¦" åº”è¯¥æ˜¯ "Temp"
- âŒ è®¾å¤‡çŠ¶æ€æ ‡ç­¾: "æ­£å¸¸"ã€"å¼‚å¸¸"ã€"ç¦»çº¿"(åº”è¯¥æ˜¯ Normal/Error/Offline)

**æ•°æ®å¡ç‰‡ä¸­çš„å€¼:**
- âŒ "å³°è°·å¥—åˆ©" (Peak-Valley Arbitrage)
- âŒ "è‡ªåŠ¨æ‰§è¡Œä¸­" (Auto Running)
- âŒ "å……ç”µ" / "å……ç”µä¸­" (Charging)
- âŒ "æœ€å¤§åŠŸç‡" (Max Power)
- âŒ "SOHè‰¯å¥½" (SOH Good)
- âŒ "æ¸©åº¦æ­£å¸¸" (Temp Normal)
- âŒ "ç”µæµæ­£å¸¸" (Current Normal)
- âŒ "ç”µå‹ç¨³å®š" (Voltage Stable)
- âŒ "å¯¿å‘½æ­£å¸¸" (Lifespan Normal)

## æ ¹æœ¬åŸå› 

ç¬¬ä¸€è½®ä¿®å¤åªå¤„ç†äº†:
1. âœ… é™æ€HTMLå…ƒç´ çš„ data-i18n å±æ€§
2. âœ… å­—æ®µæ ‡ç­¾(label)çš„ç¿»è¯‘

ä½†é—æ¼äº†:
3. âŒ å¡ç‰‡ä¸­çš„å€¼(value)å’ŒçŠ¶æ€(status)çš„ç¿»è¯‘
4. âŒ è®¾å¤‡çŠ¶æ€åŠ¨æ€æ›´æ–°æ—¶çš„ç¿»è¯‘

è¿™äº›éƒ½æ˜¯ JavaScript åŠ¨æ€ç”Ÿæˆçš„å†…å®¹,éœ€è¦åœ¨æ¸²æŸ“æ—¶è°ƒç”¨ `translateLabel()` å‡½æ•°ã€‚

## ä¿®å¤å†…å®¹

### 1. æ‰©å±• translateLabel å‡½æ•°

æ·»åŠ äº†æ›´å¤šç¿»è¯‘æ˜ å°„,åŒ…æ‹¬è®¾å¤‡çŠ¶æ€å€¼å’Œè¿è¡ŒçŠ¶æ€å€¼:

```javascript
const labelTranslations = {
    // ... åŸæœ‰çš„æ ‡ç­¾ç¿»è¯‘ ...

    // è®¾å¤‡çŠ¶æ€å€¼
    'æ­£å¸¸': 'Normal',
    'å¼‚å¸¸': 'Error',
    'ç¦»çº¿': 'Offline',
    'å‘Šè­¦': 'Warning',

    // è¿è¡ŒçŠ¶æ€å€¼
    'å³°è°·å¥—åˆ©': 'Peak-Valley Arbitrage',
    'è‡ªåŠ¨æ‰§è¡Œä¸­': 'Auto Running',
    'å……ç”µ': 'Charging',
    'æ”¾ç”µ': 'Discharging',
    'å……ç”µä¸­': 'Charging',
    'æ”¾ç”µä¸­': 'Discharging',
    'å¾…æœº': 'Standby',
    'åœæœº': 'Stopped',

    // çŠ¶æ€æè¿°
    'SOHè‰¯å¥½': 'SOH Good',
    'æ¸©åº¦æ­£å¸¸': 'Temp Normal',
    'ç”µæµæ­£å¸¸': 'Current Normal',
    'ç”µå‹ç¨³å®š': 'Voltage Stable',
    'ç”µå‹æ­£å¸¸': 'Voltage Normal',

    // ... å…¶ä»–ç¿»è¯‘ ...
};
```

### 2. ä¿®å¤å·¦ä¾§"æ¸©åº¦"è®¾å¤‡åç§°

**HTML (ç¬¬1640è¡Œ):**
```html
<!-- ä¿®å¤å‰ -->
<span>æ¸©åº¦</span>

<!-- ä¿®å¤å -->
<span data-i18n="deviceTemp">Temp</span>
```

### 3. ä¿®å¤è®¾å¤‡çŠ¶æ€æ ‡ç­¾

**HTML (ç¬¬1625ã€1641è¡Œ):**
```html
<!-- ä¿®å¤å‰ -->
<span class="component-status status-normal">æ­£å¸¸</span>

<!-- ä¿®å¤å -->
<span class="component-status status-normal" id="ems-status" data-i18n="deviceStatusNormal">Normal</span>
```

### 4. æ›´æ–° createDataCard å‡½æ•°

åœ¨æ‰€æœ‰æ¸²æŸ“å€¼å’ŒçŠ¶æ€çš„åœ°æ–¹æ·»åŠ  `translateLabel()`:

#### 4.1 è°ƒåº¦æŒ‡ä»¤å¡ç‰‡(ç¬¬4180-4191è¡Œ)
```javascript
// ä¿®å¤å‰
<span>${config.value}</span>
<div>${config.subValue}</div>

// ä¿®å¤å
<span>${translateLabel(config.value)}</span>
<div>${translateLabel(config.subValue)}</div>
```

#### 4.2 æœ‰å•ä½çš„æ•°å€¼å¡ç‰‡(ç¬¬4192-4204è¡Œ)
```javascript
// ä¿®å¤å‰
${config.status ? `<div>${config.status}</div>` : ''}

// ä¿®å¤å
${config.status ? `<div>${translateLabel(config.status)}</div>` : ''}
```

#### 4.3 çº¯æ–‡æœ¬å€¼å¡ç‰‡(ç¬¬4205-4216è¡Œ)
```javascript
// ä¿®å¤å‰
<span>${config.value}</span>
${config.status ? `<div>${config.status}</div>` : ''}

// ä¿®å¤å
<span>${translateLabel(config.value)}</span>
${config.status ? `<div>${translateLabel(config.status)}</div>` : ''}
```

#### 4.4 çŠ¶æ€å‹å­—æ®µå¡ç‰‡(ç¬¬4228-4239è¡Œ)
```javascript
// ä¿®å¤å‰
<span>${statusText}</span>

// ä¿®å¤å
<span>${translateLabel(statusText)}</span>
```

#### 4.5 æ™®é€šå­—æ®µå¡ç‰‡(ç¬¬4240-4254è¡Œ)
```javascript
// ä¿®å¤å‰
<span>${statusText}</span>

// ä¿®å¤å
<span>${translateLabel(statusText)}</span>
```

### 5. ä¿®å¤ updateComponentStatuses å‡½æ•°

åŠ¨æ€æ›´æ–°è®¾å¤‡çŠ¶æ€æ—¶ä¹Ÿè¦ç¿»è¯‘:

**ä¿®å¤å‰ (ç¬¬4974-5006è¡Œ):**
```javascript
function updateComponentStatuses() {
    const components = ['pcs', 'bms', 'meter', 'thermal', 'fire'];
    // ...
    if (index === offlineIndex) {
        status = { text: 'ç¦»çº¿', class: 'status-offline' };
    } else if (index === errorIndex) {
        status = { text: 'å¼‚å¸¸', class: 'status-error' };
    } else {
        status = { text: 'æ­£å¸¸', class: 'status-normal' };
    }

    statusElement.textContent = status.text;
    statusElement.className = `component-status ${status.class}`;
}
```

**ä¿®å¤å:**
```javascript
function updateComponentStatuses() {
    const components = ['ems', 'pcs', 'bms', 'meter', 'thermal', 'fire'];
    // ...
    if (index === offlineIndex) {
        status = { text: translateLabel('ç¦»çº¿'), class: 'status-offline', i18nKey: 'deviceStatusOffline' };
    } else if (index === errorIndex) {
        status = { text: translateLabel('å¼‚å¸¸'), class: 'status-error', i18nKey: 'deviceStatusError' };
    } else {
        status = { text: translateLabel('æ­£å¸¸'), class: 'status-normal', i18nKey: 'deviceStatusNormal' };
    }

    statusElement.textContent = status.text;
    statusElement.className = `component-status ${status.class}`;
    // ä¿æŒ data-i18n å±æ€§ä»¥ä¾¿è¯­è¨€åˆ‡æ¢æ—¶è‡ªåŠ¨æ›´æ–°
    statusElement.setAttribute('data-i18n', status.i18nKey);
}
```

## ä¿®å¤æ•ˆæœ

### âœ… ä¿®å¤å(è‹±æ–‡ç¯å¢ƒ)

| å…ƒç´  | åŸæ˜¾ç¤º | ç°æ˜¾ç¤º | çŠ¶æ€ |
|------|--------|--------|------|
| å·¦ä¾§æ¸©åº¦èœå• | æ¸©åº¦ | Temp | âœ… |
| è®¾å¤‡çŠ¶æ€-æ­£å¸¸ | æ­£å¸¸ | Normal | âœ… |
| è®¾å¤‡çŠ¶æ€-å¼‚å¸¸ | å¼‚å¸¸ | Error | âœ… |
| è®¾å¤‡çŠ¶æ€-ç¦»çº¿ | ç¦»çº¿ | Offline | âœ… |
| å³°è°·å¥—åˆ© | å³°è°·å¥—åˆ© | Peak-Valley Arbitrage | âœ… |
| è‡ªåŠ¨æ‰§è¡Œä¸­ | è‡ªåŠ¨æ‰§è¡Œä¸­ | Auto Running | âœ… |
| å……ç”µ/å……ç”µä¸­ | å……ç”µ/å……ç”µä¸­ | Charging | âœ… |
| SOHè‰¯å¥½ | SOHè‰¯å¥½ | SOH Good | âœ… |
| æ¸©åº¦æ­£å¸¸ | æ¸©åº¦æ­£å¸¸ | Temp Normal | âœ… |
| ç”µæµæ­£å¸¸ | ç”µæµæ­£å¸¸ | Current Normal | âœ… |
| ç”µå‹ç¨³å®š | ç”µå‹ç¨³å®š | Voltage Stable | âœ… |
| å¯¿å‘½æ­£å¸¸ | å¯¿å‘½æ­£å¸¸ | Lifespan Normal | âœ… |

### âœ… ä¸­æ–‡ç¯å¢ƒ

æ‰€æœ‰æ–‡æœ¬ä¿æŒä¸­æ–‡æ˜¾ç¤º,æ— å˜åŒ–ã€‚

## æŠ€æœ¯è¦ç‚¹

### å…³é”®ä¿®å¤æ¨¡å¼

1. **é™æ€HTMLå…ƒç´ **: ä½¿ç”¨ data-i18n å±æ€§
   ```html
   <span data-i18n="key">Default Text</span>
   ```

2. **åŠ¨æ€ç”Ÿæˆçš„æ ‡ç­¾(label)**:
   ```javascript
   ${translateLabel(config.label)}
   ```

3. **åŠ¨æ€ç”Ÿæˆçš„å€¼(value)**:
   ```javascript
   ${translateLabel(config.value)}
   ```

4. **åŠ¨æ€ç”Ÿæˆçš„çŠ¶æ€(status)**:
   ```javascript
   ${translateLabel(config.status)}
   ${translateLabel(statusText)}
   ```

5. **åŠ¨æ€æ›´æ–°æ—¶ä¿æŒ data-i18n**:
   ```javascript
   element.setAttribute('data-i18n', i18nKey);
   ```

### ä¸ºä»€ä¹ˆéœ€è¦ data-i18n å±æ€§?

å³ä½¿ä½¿ç”¨äº† `translateLabel()` åŠ¨æ€ç¿»è¯‘,ä»ç„¶éœ€è¦ä¿ç•™ data-i18n å±æ€§,å› ä¸º:

1. **è¯­è¨€åˆ‡æ¢æ—¶è‡ªåŠ¨æ›´æ–°**: touchscreen-i18n.js ç›‘å¬è¯­è¨€åˆ‡æ¢äº‹ä»¶å,ä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰å¸¦ data-i18n å±æ€§çš„å…ƒç´ å¹¶æ›´æ–°
2. **æ— éœ€æ‰‹åŠ¨é‡æ–°æ¸²æŸ“**: ä¸éœ€è¦åœ¨è¯­è¨€åˆ‡æ¢åé‡æ–°è°ƒç”¨ renderComponentData
3. **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰å›½é™…åŒ–å…ƒç´ éƒ½ç”± touchscreen-i18n.js ç»Ÿä¸€ç®¡ç†

## æµ‹è¯•éªŒè¯

### åœºæ™¯1: è‹±æ–‡ç¯å¢ƒå®Œæ•´æµ‹è¯•

**æ­¥éª¤:**
1. æ¸…é™¤ localStorage
2. æ‰“å¼€æ•°æ®é¡µé¢(é»˜è®¤è‹±æ–‡)
3. æ£€æŸ¥å·¦ä¾§è®¾å¤‡èœå•
4. æ£€æŸ¥å„ä¸ªè®¾å¤‡çš„çŠ¶æ€æ ‡ç­¾
5. æŸ¥çœ‹æ•´æœºé¡µé¢çš„æ‰€æœ‰æ•°æ®å¡ç‰‡

**æœŸæœ›ç»“æœ:**
- âœ… "Temp" è®¾å¤‡åç§°æ˜¾ç¤ºæ­£ç¡®
- âœ… è®¾å¤‡çŠ¶æ€æ˜¾ç¤º "Normal"/"Error"/"Offline"
- âœ… å¡ç‰‡å€¼æ˜¾ç¤ºè‹±æ–‡(Peak-Valley Arbitrage, Chargingç­‰)
- âœ… å¡ç‰‡çŠ¶æ€æ˜¾ç¤ºè‹±æ–‡(SOH Good, Temp Normalç­‰)

### åœºæ™¯2: è®¾å¤‡çŠ¶æ€åŠ¨æ€æ›´æ–°

**æ­¥éª¤:**
1. åœ¨è‹±æ–‡ç¯å¢ƒä¸‹
2. ç­‰å¾…30ç§’(è®¾å¤‡çŠ¶æ€ä¼šè‡ªåŠ¨æ›´æ–°)
3. è§‚å¯Ÿè®¾å¤‡çŠ¶æ€æ ‡ç­¾çš„å˜åŒ–

**æœŸæœ›ç»“æœ:**
- âœ… çŠ¶æ€æ›´æ–°åä»æ˜¾ç¤ºè‹±æ–‡
- âœ… "Normal" â†’ "Error" æˆ– "Offline" åˆ‡æ¢æ­£å¸¸

### åœºæ™¯3: è¯­è¨€åˆ‡æ¢æµ‹è¯•

**æ­¥éª¤:**
1. åœ¨è‹±æ–‡ç¯å¢ƒä¸‹çš„æ•°æ®é¡µé¢
2. åˆ‡æ¢åˆ°ä¸­æ–‡
3. ç­‰å¾…è®¾å¤‡çŠ¶æ€è‡ªåŠ¨æ›´æ–°
4. å†åˆ‡æ¢å›è‹±æ–‡

**æœŸæœ›ç»“æœ:**
- âœ… åˆ‡æ¢åˆ°ä¸­æ–‡å,æ‰€æœ‰çŠ¶æ€å’Œå€¼å˜ä¸ºä¸­æ–‡
- âœ… è®¾å¤‡çŠ¶æ€æ›´æ–°åä¿æŒä¸­æ–‡
- âœ… åˆ‡æ¢å›è‹±æ–‡å,æ‰€æœ‰å†…å®¹æ¢å¤è‹±æ–‡

## æ¶µç›–çš„æ‰€æœ‰ç¿»è¯‘

### è®¾å¤‡çŠ¶æ€
- æ­£å¸¸ â†’ Normal
- å¼‚å¸¸ â†’ Error
- ç¦»çº¿ â†’ Offline
- å‘Šè­¦ â†’ Warning

### è¿è¡ŒçŠ¶æ€
- å³°è°·å¥—åˆ© â†’ Peak-Valley Arbitrage
- è‡ªåŠ¨æ‰§è¡Œä¸­ â†’ Auto Running
- å……ç”µ â†’ Charging
- æ”¾ç”µ â†’ Discharging
- å……ç”µä¸­ â†’ Charging
- æ”¾ç”µä¸­ â†’ Discharging
- å¾…æœº â†’ Standby
- åœæœº â†’ Stopped

### çŠ¶æ€æè¿°
- SOHè‰¯å¥½ â†’ SOH Good
- æ¸©åº¦æ­£å¸¸ â†’ Temp Normal
- ç”µæµæ­£å¸¸ â†’ Current Normal
- ç”µå‹ç¨³å®š â†’ Voltage Stable
- ç”µå‹æ­£å¸¸ â†’ Voltage Normal
- å¯¿å‘½æ­£å¸¸ â†’ Lifespan Normal

## ç›¸å…³æ–‡æ¡£

1. [æ•°æ®é¡µé¢å®Œæ•´å›½é™…åŒ–ä¿®å¤è¯´æ˜.md](æ•°æ®é¡µé¢å®Œæ•´å›½é™…åŒ–ä¿®å¤è¯´æ˜.md) - ç¬¬ä¸€è½®ä¿®å¤(æ ‡ç­¾å’Œç« èŠ‚)
2. [localStorageé”®åå†²çªä¿®å¤è¯´æ˜.md](localStorageé”®åå†²çªä¿®å¤è¯´æ˜.md) - localStorage ç»Ÿä¸€
3. [äº¤äº’åŠŸèƒ½ä¿®å¤å®Œæˆ.md](äº¤äº’åŠŸèƒ½ä¿®å¤å®Œæˆ.md) - äº¤äº’åŠŸèƒ½æ¢å¤
4. [é‡è¦-è¯·å…ˆé˜…è¯».md](é‡è¦-è¯·å…ˆé˜…è¯».md) - å®Œæ•´ä¿®å¤å†å²

## å®ŒæˆçŠ¶æ€

âœ… **æ‰€æœ‰åŠ¨æ€å†…å®¹å›½é™…åŒ–å·²å®Œå…¨ä¿®å¤:**
1. âœ… è®¾å¤‡åç§°("æ¸©åº¦" â†’ "Temp")
2. âœ… è®¾å¤‡çŠ¶æ€æ ‡ç­¾("æ­£å¸¸"/"å¼‚å¸¸"/"ç¦»çº¿")
3. âœ… å¡ç‰‡å€¼çš„ç¿»è¯‘(å³°è°·å¥—åˆ©ã€å……ç”µç­‰)
4. âœ… å¡ç‰‡çŠ¶æ€çš„ç¿»è¯‘(SOHè‰¯å¥½ã€æ¸©åº¦æ­£å¸¸ç­‰)
5. âœ… è®¾å¤‡çŠ¶æ€åŠ¨æ€æ›´æ–°æ—¶çš„ç¿»è¯‘
6. âœ… è¯­è¨€åˆ‡æ¢åè‡ªåŠ¨æ›´æ–°æ‰€æœ‰å†…å®¹

## æµ‹è¯•æ¸…å•

- [ ] æ¸…é™¤ localStorage
- [ ] è‹±æ–‡ç¯å¢ƒ: å·¦ä¾§"Temp"æ˜¾ç¤ºæ­£ç¡®
- [ ] è‹±æ–‡ç¯å¢ƒ: è®¾å¤‡çŠ¶æ€æ˜¾ç¤ºè‹±æ–‡
- [ ] è‹±æ–‡ç¯å¢ƒ: å¡ç‰‡å€¼å’ŒçŠ¶æ€æ˜¾ç¤ºè‹±æ–‡
- [ ] ç­‰å¾…30ç§’: è®¾å¤‡çŠ¶æ€æ›´æ–°åä»æ˜¾ç¤ºè‹±æ–‡
- [ ] åˆ‡æ¢åˆ°ä¸­æ–‡: æ‰€æœ‰å†…å®¹å˜ä¸ºä¸­æ–‡
- [ ] è®¾å¤‡çŠ¶æ€æ›´æ–°: ä¿æŒä¸­æ–‡
- [ ] åˆ‡æ¢å›è‹±æ–‡: æ‰€æœ‰å†…å®¹å˜å›è‹±æ–‡

ç°åœ¨å¯ä»¥æµ‹è¯•äº†!å¦‚æœè¿˜æœ‰ä»»ä½•ä¸­æ–‡æ˜¾ç¤º,è¯·å‘Šè¯‰æˆ‘! ğŸ‰
