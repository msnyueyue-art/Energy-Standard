<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Settings - Energy Storage System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="common-header-styles.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0e1a;
            color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ÁßëÊäÄÈ£éËÉåÊôØÁΩëÊ†º */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 150, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 150, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        /* Âä®ÊÄÅÂÖâÊïàËÉåÊôØ */
        .bg-effects {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            z-index: 0;
        }

        .bg-effects::after {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 150, 255, 0.15) 0%, transparent 50%);
            animation: rotate 20s linear infinite;
            top: -50%;
            left: -50%;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Â§¥ÈÉ®ÂØºËà™ */
        .header {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            height: 60px;
            display: flex;
            align-items: center;
            padding: 0 30px;
            border-bottom: 1px solid rgba(0, 150, 255, 0.3);
            position: relative;
            z-index: 100;
            gap: 40px;
            flex-wrap: nowrap;
            min-width: 0;
        }

        /* LogoÂå∫Âüü */
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: none;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 600;
            background: linear-gradient(90deg, #0096ff, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ÂØºËà™ËèúÂçï */
        .nav-menu {
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            justify-content: center;
            flex-wrap: nowrap;
            min-width: 0;
        }

        .nav-item {
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 17px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            white-space: nowrap;
            display: inline-block;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .nav-item:hover {
            color: #00d4ff;
            background: rgba(0, 150, 255, 0.1);
        }

        .nav-item:hover::before {
            width: 80%;
        }

        .nav-item.active {
            color: #00d4ff;
            background: rgba(0, 150, 255, 0.15);
        }

        .nav-item.active::before {
            width: 80%;
            background: #00d4ff;
            box-shadow: 0 0 10px #00d4ff;
        }

        /* Â§¥ÈÉ®Âè≥‰æß */
        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Êó∂Èó¥ÊòæÁ§∫ */
        .header-time {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-family: 'SF Mono', monospace;
            letter-spacing: 1px;
        }

        /* ÁßëÊäÄÈ£éÂõæÊ†áÊåâÈíÆ */
        .tech-icon-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 150, 255, 0.1);
            border: 1px solid rgba(0, 150, 255, 0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tech-icon-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(0, 150, 255, 0.6) 0%, transparent 70%);
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }

        .tech-icon-btn:hover {
            background: rgba(0, 150, 255, 0.2);
            border-color: rgba(0, 150, 255, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 150, 255, 0.4);
        }

        .tech-icon-btn:hover::before {
            width: 100px;
            height: 100px;
        }

        .tech-icon-btn:active {
            transform: translateY(0);
        }

        /* ÂõæÊ†áÊ†∑Âºè */
        .tech-icon {
            width: 20px;
            height: 20px;
            position: relative;
            z-index: 1;
        }

        /* ËØ≠Ë®ÄÂàáÊç¢ÂõæÊ†á */
        .lang-icon {
            width: 20px;
            height: 20px;
            border: 2px solid #00d4ff;
            border-radius: 50%;
            position: relative;
        }

        .lang-icon::before,
        .lang-icon::after {
            content: '';
            position: absolute;
            border: 1px solid #00d4ff;
            border-radius: 50%;
        }

        .lang-icon::before {
            width: 100%;
            height: 8px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .lang-icon::after {
            width: 8px;
            height: 100%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Â∑•ÂÖ∑ÊèêÁ§∫ */
        .tooltip {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .tech-icon-btn:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }


        /* ‰∏ªÂÜÖÂÆπÂå∫ */
        .main-content {
            height: calc(100vh - 60px);
            margin-top: 20px;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            gap: 20px;
        }

        /* ËÆæÁΩÆËèúÂçï */
        .settings-menu {
            width: 250px;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            height: fit-content;
        }

        .menu-title {
            font-size: 16px;
            font-weight: 600;
            color: #00d4ff;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .menu-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: linear-gradient(45deg, #0096ff, #00d4ff);
            border-radius: 2px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            margin-bottom: 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            font-weight: 500;
            min-height: 56px;
        }

        .menu-item:hover {
            background: rgba(0, 150, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }

        .menu-item.active {
            background: rgba(0, 150, 255, 0.2);
            color: #00d4ff;
            border: 1px solid rgba(0, 150, 255, 0.3);
        }

        .menu-item i {
            width: 20px;
            font-size: 18px;
            text-align: center;
        }

        /* ËÆæÁΩÆÂÜÖÂÆπÂå∫ */
        .settings-content {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            width: 100%;
            max-width: calc(100% - 270px);
            overflow-y: auto;
            max-height: calc(100vh - 120px);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #00d4ff;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(45deg, #0096ff, #00d4ff);
            border-radius: 2px;
        }

        /* ËÆæÁΩÆÁªÑ */
        .setting-group {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .group-title {
            font-size: 20px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .group-title i {
            color: #00d4ff;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid rgba(0, 150, 255, 0.1);
            min-height: 60px;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            flex: 1;
        }

        .setting-name {
            font-size: 18px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 6px;
        }

        .setting-desc {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.6);
        }

        .setting-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Ë°®ÂçïÊéß‰ª∂ */
        .form-input,
        .form-select {
            height: 52px;
            padding: 0 16px;
            border: 2px solid rgba(0, 150, 255, 0.3);
            border-radius: 10px;
            font-size: 18px;
            background: rgba(15, 25, 42, 0.8);
            color: rgba(255, 255, 255, 0.9);
            transition: all 0.2s;
            min-width: 240px;
            font-weight: 500;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        }

        /* ÂºÄÂÖ≥Êéß‰ª∂ */
        .switch {
            position: relative;
            display: inline-block;
            width: 64px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(107, 114, 128, 0.8);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #00d4ff;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* ÊåâÈíÆ */
        .btn {
            height: 52px;
            padding: 0 24px;
            border: 2px solid rgba(0, 150, 255, 0.3);
            border-radius: 10px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            background: rgba(30, 41, 59, 0.8);
            color: rgba(255, 255, 255, 0.9);
            min-width: 120px;
            justify-content: center;
        }

        .btn:hover {
            background: rgba(0, 150, 255, 0.1);
            border-color: #00d4ff;
        }

        .btn.primary {
            background: #00d4ff;
            color: #0a0e1a;
            border-color: #00d4ff;
        }

        .btn.primary:hover {
            background: #0096ff;
            transform: translateY(-1px);
        }

        .btn.danger {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
        }

        .btn.danger:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* ÂØÜÁ†ÅË°®ÂçïÊ†∑Âºè */
        .password-form {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
        }
        
        .password-form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 16px;
        }
        
        .form-column {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .form-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .form-label {
            flex: 0 0 90px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }
        
        .label-text {
            font-size: 18px;
            font-weight: 600;
            color: #00d4ff;
            letter-spacing: 0.5px;
        }
        
        .form-row .form-input {
            flex: 1;
            max-width: 260px;
        }
        
        .form-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
            padding: 16px 0 0;
            border-top: 1px solid rgba(0, 150, 255, 0.2);
            margin-top: 4px;
        }
        
        .form-actions .btn,
        .form-actions .btn.primary {
            min-width: 120px;
            height: 52px;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .form-actions .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
        }
        
        .form-actions .btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-1px);
        }
        
        .form-actions .btn.primary {
            background: linear-gradient(135deg, #0096ff, #00d4ff);
            border: 1px solid #00d4ff;
            color: #fff;
        }
        
        .form-actions .btn.primary:hover {
            background: linear-gradient(135deg, #007acc, #00b8e6);
            border-color: #00b8e6;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }

        /* ÈÄöÁü•Ê†∑Âºè */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 6px;
            color: white;
            font-size: 14px;
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #10b981;
        }

        .notification.error {
            background: #ef4444;
        }

        .notification.info {
            background: #3b82f6;
        }

        .notification.warning {
            background: #f59e0b;
        }

        /* ÈÄÄÂá∫ÊåâÈíÆÊ†∑Âºè */
        .logout-btn {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 18px;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.15);
            border-color: rgba(239, 68, 68, 0.4);
            transform: scale(1.05);
            color: #ef4444;
        }

        /* ÈÄÄÂá∫Á°ÆËÆ§ÂºπÁ™ó - Â∑•‰∏öÈ£éÊ†º */
        .logout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .logout-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logout-content {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 16px;
            padding: 40px;
            width: 480px;
            max-width: 90%;
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.2s ease;
            position: relative;
        }

        .logout-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: rgba(239, 68, 68, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ef4444;
            font-size: 28px;
        }

        .logout-title {
            font-size: 24px;
            font-weight: 600;
            color: #ffffff;
            text-align: center;
            margin-bottom: 12px;
        }

        .logout-message {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            line-height: 1.6;
            margin-bottom: 28px;
        }

        .logout-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .logout-btn-action {
            padding: 12px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            min-width: 120px;
        }

        .logout-btn-action.cancel {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .logout-btn-action.cancel:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .logout-btn-action.confirm {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .logout-btn-action.confirm:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
                gap: 16px;
            }

            .settings-menu {
                width: 100%;
                height: auto;
            }

            .settings-content {
                padding: 20px;
            }

            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .setting-control {
                width: 100%;
                justify-content: flex-end;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 10px;
            }

            .settings-menu,
            .settings-content {
                padding: 16px;
            }

            .form-input,
            .form-select {
                min-width: 150px;
            }
        }

        /* ÊªöÂä®Êù°Ê†∑Âºè */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 150, 255, 0.3);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 150, 255, 0.5);
        }


        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* ========== Áîµ‰ª∑ËÆæÁΩÆÊ†∑Âºè ========== */

        /* ÂΩìÂâçÁîµ‰ª∑ÊñπÊ°à */
        .electricity-current-plan {
            padding: 20px;
        }

        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .plan-name {
            font-size: 20px;
            font-weight: 600;
            color: #00d4ff;
        }

        /* 24Â∞èÊó∂Áº©Áï•Âõæ */
        .time-preview-bar {
            height: 32px;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.3);
        }

        .time-block {
            flex: 1;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .time-block:hover {
            opacity: 0.8;
            transform: scaleY(1.1);
        }

        .time-block.peak {
            background: #FF6B4A;
        }

        .time-block.flat {
            background: #4A90E2;
        }

        .time-block.valley {
            background: #52C41A;
        }

        /* Áîµ‰ª∑ÊëòË¶Å */
        .price-summary {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .price-tag {
            flex: 1;
            min-width: 150px;
            padding: 16px 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .price-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .price-tag.peak-tag {
            background: rgba(255, 107, 74, 0.2);
            border: 1px solid rgba(255, 107, 74, 0.3);
        }

        .price-tag.flat-tag {
            background: rgba(74, 144, 226, 0.2);
            border: 1px solid rgba(74, 144, 226, 0.3);
        }

        .price-tag.valley-tag {
            background: rgba(82, 196, 26, 0.2);
            border: 1px solid rgba(82, 196, 26, 0.3);
        }

        .tag-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        .tag-value {
            font-size: 20px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .peak-tag .tag-value {
            color: #FF6B4A;
        }

        .flat-tag .tag-value {
            color: #4A90E2;
        }

        .valley-tag .tag-value {
            color: #52C41A;
        }

        /* Âø´ÈÄüÈÖçÁΩÆÊåâÈíÆ */
        .quick-config-buttons {
            display: flex;
            gap: 20px;
            padding: 10px 0;
        }

        .config-btn {
            flex: 1;
            height: 80px;
            border: 2px solid rgba(0, 150, 255, 0.3);
            border-radius: 12px;
            background: rgba(30, 41, 59, 0.6);
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .config-btn:hover {
            background: rgba(0, 150, 255, 0.2);
            border-color: #00d4ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }

        .config-btn i {
            font-size: 24px;
            color: #00d4ff;
        }

        /* Êó∂Èó¥ËΩ¥ÁºñËæëÂô® */
        .timeline-editor {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }

        .timeline-header {
            margin-bottom: 20px;
        }

        .timeline-title {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 8px;
        }

        .timeline-hint {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.5);
        }

        .timeline-canvas {
            position: relative;
            padding: 10px 0;
        }

        .timeline-scale {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 0 5px;
        }

        .scale-item {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-family: monospace;
        }

        .timeline-blocks {
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .timeline-block {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .timeline-block:hover {
            filter: brightness(1.2);
        }

        .timeline-block.peak {
            background: #FF6B4A;
        }

        .timeline-block.flat {
            background: #4A90E2;
        }

        .timeline-block.valley {
            background: #52C41A;
        }

        .timeline-block-handle {
            position: absolute;
            right: -4px;
            top: 0;
            width: 8px;
            height: 100%;
            background: rgba(255, 255, 255, 0.6);
            cursor: ew-resize;
            z-index: 10;
            transition: all 0.2s ease;
        }

        .timeline-block-handle:hover {
            background: rgba(255, 255, 255, 0.9);
            width: 12px;
            right: -6px;
        }

        /* Êó∂ÊÆµÂàóË°® */
        .period-list {
            margin-top: 30px;
        }

        .period-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 150, 255, 0.2);
        }

        .period-list-header span {
            font-size: 16px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .btn-small {
            height: 36px;
            padding: 0 16px;
            border: 1px solid rgba(0, 150, 255, 0.3);
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            background: rgba(0, 150, 255, 0.1);
            color: #00d4ff;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-small:hover {
            background: rgba(0, 150, 255, 0.2);
            border-color: #00d4ff;
        }

        .period-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .period-item {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .period-item:hover {
            border-color: rgba(0, 150, 255, 0.5);
            background: rgba(0, 0, 0, 0.3);
        }

        .period-item-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .period-color-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .period-color-dot.peak {
            background: #FF6B4A;
            box-shadow: 0 0 10px rgba(255, 107, 74, 0.5);
        }

        .period-color-dot.flat {
            background: #4A90E2;
            box-shadow: 0 0 10px rgba(74, 144, 226, 0.5);
        }

        .period-color-dot.valley {
            background: #52C41A;
            box-shadow: 0 0 10px rgba(82, 196, 26, 0.5);
        }

        .period-type {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            flex: 1;
        }

        .period-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .icon-btn.delete:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.4);
        }

        .period-time {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 12px;
        }

        .period-price-input {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .price-input-wrapper {
            flex: 1;
            max-width: 200px;
        }

        .price-input {
            width: 100%;
            height: 44px;
            padding: 0 12px;
            border: 2px solid rgba(0, 150, 255, 0.3);
            border-radius: 8px;
            background: rgba(15, 25, 42, 0.8);
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .price-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        }

        .price-slider {
            flex: 1;
        }

        .slider-container {
            position: relative;
            padding: 10px 0;
        }

        .slider-track {
            height: 4px;
            background: rgba(0, 150, 255, 0.2);
            border-radius: 2px;
            position: relative;
        }

        .slider-fill {
            height: 100%;
            background: linear-gradient(90deg, #0096ff, #00d4ff);
            border-radius: 2px;
            transition: width 0.1s ease;
        }

        .slider-thumb {
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #00d4ff;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .slider-thumb:hover {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
        }

        .slider-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ÁºñËæëÂô®Êìç‰ΩúÊåâÈíÆ */
        .editor-actions {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 150, 255, 0.2);
        }

        /* Ê®°ÊùøÂàóË°® */
        .template-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
            padding: 10px 0;
        }

        .template-card {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(0, 150, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #00d4ff;
            background: rgba(0, 150, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }

        .template-name {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 12px;
        }

        .template-preview {
            height: 24px;
            border-radius: 6px;
            overflow: hidden;
            display: flex;
            margin-bottom: 12px;
        }

        .template-preview-block {
            flex: 1;
        }

        .template-info {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ÂìçÂ∫îÂºè‰ºòÂåñ */
        @media (max-width: 768px) {
            .quick-config-buttons {
                flex-direction: column;
            }

            .config-btn {
                width: 100%;
            }

            .price-summary {
                flex-direction: column;
            }

            .price-tag {
                min-width: 100%;
            }

            .template-list {
                grid-template-columns: 1fr;
            }
        }







    </style>
    <script src="touchscreen-i18n.js"></script>
    <link rel="stylesheet" href="english-text-optimization.css">
    <script src="page-transition.js"></script>
</head>
<body>
    <!-- ÁßëÊäÄÈ£éËÉåÊôØÊïàÊûú -->
    <div class="bg-effects"></div>

    <!-- Â§¥ÈÉ®ÂØºËà™ -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">
                    <img src="logo.png" alt="Logo">
                </div>
                <div class="logo-text" data-i18n="systemName">Energy Storage System</div>
            </div>
        </div>
        
        <!-- ÂØºËà™ËèúÂçï -->
        <nav class="nav-menu">
            <div class="nav-item" data-i18n="navHome" onclick="smoothSwitchPage('home')">Home</div>
            <a href="#data" class="nav-item" data-i18n="navData" onclick="smoothSwitchPage('data')">Data</a>
            <a href="#" class="nav-item" data-i18n="navHistory" onclick="smoothSwitchPage('history')">History</a>
            <a href="#control" class="nav-item" data-i18n="navControl" onclick="smoothSwitchPage('control')">Control</a>
            <a href="#alarm" class="nav-item" data-i18n="navAlarm" onclick="smoothSwitchPage('alarm')">Alarm</a>
            <a href="#log" class="nav-item" data-i18n="navLog" onclick="smoothSwitchPage('log')">Log</a>
            <a href="#settings" class="nav-item active" data-i18n="navSettings" onclick="smoothSwitchPage('settings')">Settings</a>
        </nav>
        
        <div class="header-right">
            <div class="header-time" id="currentTime">2024-01-31 14:30:00</div>
            
            <!-- ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ -->
            <div class="lang-switcher">
                <button class="lang-btn" onclick="toggleLanguageDropdown(event)">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                </button>
                <div class="lang-dropdown" id="langDropdown">
                    <div class="lang-option" onclick="changeLanguage('zh', event)">
                        <span class="flag">üá®üá≥</span>
                        <span>‰∏≠Êñá</span>
                    </div>
                    <div class="lang-option" onclick="changeLanguage('en', event)">
                        <span class="flag">üá∫üá∏</span>
                        <span>English</span>
                    </div>
                </div>
            </div>
            
            <!-- ÈÄÄÂá∫ÊåâÈíÆ -->
            <button class="logout-btn" onclick="logout()" title="ÈÄÄÂá∫ÁôªÂΩï">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </header>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
    <div class="main-content">
        <!-- ËÆæÁΩÆËèúÂçï -->
        <div class="settings-menu">
            <div class="menu-title" data-i18n="settingsMenuTitle">Settings Menu</div>
            <div class="menu-item active" data-section="account" onclick="switchSection('account')">
                <i class="fas fa-user-cog"></i>
                <span data-i18n="accountSettings">Account Settings</span>
            </div>
            <div class="menu-item" data-section="security" onclick="switchSection('security')">
                <i class="fas fa-shield-alt"></i>
                <span data-i18n="securitySettings">Security Settings</span>
            </div>
            <div class="menu-item" data-section="system" onclick="switchSection('system')">
                <i class="fas fa-cogs"></i>
                <span data-i18n="systemConfig">System Configuration</span>
            </div>
            <div class="menu-item" data-section="electricity" onclick="switchSection('electricity')">
                <i class="fas fa-bolt"></i>
                <span data-i18n="electricityPrice">Electricity Price</span>
            </div>
        </div>

        <!-- ËÆæÁΩÆÂÜÖÂÆπÂå∫ -->
        <div class="settings-content">
            <!-- Ë¥¶Âè∑ËÆæÁΩÆ -->
            <div class="content-section active" data-section="account">
                <div class="section-title">
                    <i class="fas fa-user-cog"></i>
                    <span data-i18n="accountSettings">Account Settings</span>
                </div>

                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-user-cog"></i>
                        <span data-i18n="accountInfo">Account Information</span>
                    </div>

                    <!-- Ë¥¶Âè∑ -->
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="username">Username</div>
                            <div class="setting-desc" data-i18n="systemLoginAccount">System login account</div>
                        </div>
                        <div class="setting-control">
                            <span style="color: rgba(255,255,255,0.9); font-weight: 500;">admin</span>
                        </div>
                    </div>

                    <!-- ÂØÜÁ†ÅËÆæÁΩÆ -->
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="password">Password</div>
                        </div>
                        <div class="setting-control">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="color: rgba(255,255,255,0.5);">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                                <button class="btn" id="editPasswordBtn" onclick="enablePasswordEdit()">
                                    <i class="fas fa-edit"></i>
                                    <span data-i18n="changePassword">Change Password</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂØÜÁ†Å‰øÆÊîπÂå∫ÂüüÔºàÈªòËÆ§ÈöêËóèÔºâ -->
                    <div id="passwordEditSection" style="display: none;">
                        <!-- ÂØÜÁ†Å‰øÆÊîπË°®Âçï -->
                        <div class="password-form">
                            <div class="password-form-grid">
                                <!-- Â∑¶ÂàóÔºöÂΩìÂâçÂØÜÁ†Å -->
                                <div class="form-column">
                                    <div class="form-row">
                                        <label class="form-label">
                                            <span class="label-text" data-i18n="currentPassword">Current Password</span>
                                        </label>
                                        <input type="password" class="form-input" id="currentPassword" data-i18n-placeholder="currentPasswordPlaceholder" placeholder="Enter current password">
                                    </div>
                                </div>

                                <!-- Âè≥ÂàóÔºöÊñ∞ÂØÜÁ†ÅÂíåÁ°ÆËÆ§ÂØÜÁ†Å -->
                                <div class="form-column">
                                    <div class="form-row">
                                        <label class="form-label">
                                            <span class="label-text" data-i18n="newPassword">New Password</span>
                                        </label>
                                        <input type="password" class="form-input" id="newPassword" data-i18n-placeholder="newPasswordPlaceholder" placeholder="Enter new password">
                                    </div>

                                    <div class="form-row">
                                        <label class="form-label">
                                            <span class="label-text" data-i18n="confirmPassword">Confirm Password</span>
                                        </label>
                                        <input type="password" class="form-input" id="confirmPassword" data-i18n-placeholder="confirmPasswordPlaceholder" placeholder="Confirm new password">
                                    </div>
                                </div>
                            </div>

                            <!-- Êìç‰ΩúÊåâÈíÆ -->
                            <div class="form-actions">
                                <button class="btn" onclick="cancelPasswordEdit()">
                                    <i class="fas fa-times"></i>
                                    <span data-i18n="cancelBtn">Cancel</span>
                                </button>
                                <button class="btn primary" onclick="savePasswordChange()">
                                    <i class="fas fa-save"></i>
                                    <span data-i18n="saveBtn">Save</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÂÆâÂÖ®ËÆæÁΩÆ -->
            <div class="content-section" data-section="security">
                <div class="section-title">
                    <i class="fas fa-shield-alt"></i>
                    <span data-i18n="securitySettings">Security Settings</span>
                </div>

                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-lock"></i>
                        <span data-i18n="loginSecurity">Login Security</span>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="autoLock">Auto Lock</div>
                            <div class="setting-desc" data-i18n="autoLockDesc">Auto lock system when idle</div>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="autoLock" checked onchange="toggleAutoLock()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="lockTimeout">Lock Timeout</div>
                            <div class="setting-desc" data-i18n="lockTimeoutDesc">Auto lock after idle time</div>
                        </div>
                        <div class="setting-control">
                            <select class="form-select" id="lockTimeout">
                                <option value="5" data-i18n="fiveMinutes">5 Minutes</option>
                                <option value="10" data-i18n="tenMinutes">10 Minutes</option>
                                <option value="15" selected data-i18n="fifteenMinutes">15 Minutes</option>
                                <option value="30" data-i18n="thirtyMinutes">30 Minutes</option>
                                <option value="60" data-i18n="oneHour">1 Hour</option>
                                <option value="never" data-i18n="never">Never</option>
                            </select>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Á≥ªÁªüÈÖçÁΩÆ -->
            <div class="content-section" data-section="system">
                <div class="section-title">
                    <i class="fas fa-cogs"></i>
                    <span data-i18n="systemConfig">System Configuration</span>
                </div>

                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-cog"></i>
                        <span data-i18n="systemSettings">System Settings</span>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="dataRefreshInterval">Data Refresh Interval</div>
                            <div class="setting-desc" data-i18n="dataRefreshIntervalDesc">Real-time data refresh frequency</div>
                        </div>
                        <div class="setting-control">
                            <select class="form-select" id="refreshInterval">
                                <option value="1" data-i18n="oneSecond">1 Second</option>
                                <option value="3" selected data-i18n="threeSeconds">3 Seconds</option>
                                <option value="5" data-i18n="fiveSeconds">5 Seconds</option>
                                <option value="10" data-i18n="tenSeconds">10 Seconds</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-bell"></i>
                        <span data-i18n="notificationSettings">Notification Settings</span>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="alarmNotification">Alarm Notification</div>
                            <div class="setting-desc" data-i18n="alarmNotificationDesc">Receive device alarm notifications</div>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="alarmNotification" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name" data-i18n="soundAlert">Sound Alert</div>
                            <div class="setting-desc" data-i18n="soundAlertDesc">Play notification sound</div>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="soundAlert" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Áîµ‰ª∑ËÆæÁΩÆ -->
            <div class="content-section" data-section="electricity">
                <div class="section-title">
                    <i class="fas fa-bolt"></i>
                    <span data-i18n="electricityPrice">Electricity Price</span>
                </div>

                <!-- ÂΩìÂâçÁîµ‰ª∑ÊñπÊ°à -->
                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-chart-line"></i>
                        <span data-i18n="currentPricePlan">Current Price Plan</span>
                    </div>

                    <div class="electricity-current-plan">
                        <div class="plan-header">
                            <div class="plan-name" id="currentPlanName" data-i18n="noPricePlan">No price plan set</div>
                            <button class="btn" onclick="togglePriceEditor()">
                                <i class="fas fa-edit"></i>
                                <span data-i18n="editBtn">Edit</span>
                            </button>
                        </div>

                        <!-- 24Â∞èÊó∂Áº©Áï•Âõæ -->
                        <div class="time-preview-bar" id="timePreviewBar">
                            <!-- ÈÄöËøáJSÂä®ÊÄÅÁîüÊàê24Â∞èÊó∂Êó∂ÊÆµËâ≤Âùó -->
                        </div>

                        <!-- Áîµ‰ª∑ÊëòË¶Å -->
                        <div class="price-summary" id="priceSummary">
                            <div class="price-tag peak-tag">
                                <span class="tag-label" data-i18n="peakTime">Peak</span>
                                <span class="tag-value">--/kWh</span>
                            </div>
                            <div class="price-tag flat-tag">
                                <span class="tag-label" data-i18n="normalTime">Normal</span>
                                <span class="tag-value">--/kWh</span>
                            </div>
                            <div class="price-tag valley-tag">
                                <span class="tag-label" data-i18n="valleyTime">Valley</span>
                                <span class="tag-value">--/kWh</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Âø´ÈÄüÈÖçÁΩÆ -->
                <div class="setting-group">
                    <div class="group-title">
                        <i class="fas fa-bolt-lightning"></i>
                        <span data-i18n="quickConfig">Quick Configuration</span>
                    </div>

                    <div class="quick-config-buttons">
                        <button class="config-btn" onclick="showTemplateSelector()">
                            <i class="fas fa-clipboard-list"></i>
                            <span data-i18n="applyTemplate">Apply Template</span>
                        </button>
                        <button class="config-btn" onclick="showCustomEditor()">
                            <i class="fas fa-sliders-h"></i>
                            <span data-i18n="customConfig">Custom Configuration</span>
                        </button>
                    </div>
                </div>

                <!-- Áîµ‰ª∑ÁºñËæëÂô®(ÈªòËÆ§ÈöêËóè) -->
                <div id="priceEditorSection" class="price-editor-section" style="display: none;">
                    <div class="setting-group">
                        <div class="group-title">
                            <i class="fas fa-clock"></i>
                            <span data-i18n="timeSlotConfig">Time Slot Configuration</span>
                            <button class="btn" style="margin-left: auto;" onclick="closePriceEditor()">
                                <i class="fas fa-times"></i>
                                <span data-i18n="closeBtn">Close</span>
                            </button>
                        </div>

                        <!-- 24Â∞èÊó∂Êó∂Èó¥ËΩ¥ÁºñËæëÂô® -->
                        <div class="timeline-editor">
                            <div class="timeline-header">
                                <div class="timeline-title" data-i18n="timeSlot24h">24-Hour Time Slots</div>
                                <div class="timeline-hint" data-i18n="timeSlotHint">Click to switch type, drag boundary to adjust time</div>
                            </div>

                            <div class="timeline-canvas" id="timelineCanvas">
                                <!-- Êó∂Èó¥ÂàªÂ∫¶ -->
                                <div class="timeline-scale">
                                    <div class="scale-item">00</div>
                                    <div class="scale-item">04</div>
                                    <div class="scale-item">08</div>
                                    <div class="scale-item">12</div>
                                    <div class="scale-item">16</div>
                                    <div class="scale-item">20</div>
                                    <div class="scale-item">24</div>
                                </div>

                                <!-- Êó∂ÊÆµËâ≤ÂùóÂÆπÂô® -->
                                <div class="timeline-blocks" id="timelineBlocks">
                                    <!-- ÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                                </div>
                            </div>
                        </div>

                        <!-- Êó∂ÊÆµÂàóË°® -->
                        <div class="period-list" id="periodList">
                            <div class="period-list-header">
                                <span data-i18n="currentPeriodConfig">Current Period Configuration</span>
                                <button class="btn-small" onclick="addPeriod()">
                                    <i class="fas fa-plus"></i>
                                    <span data-i18n="addPeriod">Add Period</span>
                                </button>
                            </div>

                            <div class="period-items" id="periodItems">
                                <!-- ÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                            </div>
                        </div>

                        <!-- Êìç‰ΩúÊåâÈíÆ -->
                        <div class="editor-actions">
                            <button class="btn" onclick="resetToDefault()">
                                <i class="fas fa-undo"></i>
                                <span data-i18n="resetToDefault">Reset to Default</span>
                            </button>
                            <button class="btn primary" onclick="savePriceConfig()">
                                <i class="fas fa-save"></i>
                                <span data-i18n="savePlan">Save Plan</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ê®°ÊùøÈÄâÊã©Âô®(ÈªòËÆ§ÈöêËóè) -->
                <div id="templateSelectorSection" class="template-selector-section" style="display: none;">
                    <div class="setting-group">
                        <div class="group-title">
                            <i class="fas fa-clipboard-list"></i>
                            <span data-i18n="selectPriceTemplate">Select Price Template</span>
                            <button class="btn" style="margin-left: auto;" onclick="closeTemplateSelector()">
                                <i class="fas fa-times"></i>
                                <span data-i18n="closeBtn">Close</span>
                            </button>
                        </div>

                        <div class="template-list" id="templateList">
                            <!-- ÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // È°µÈù¢ÂàùÂßãÂåñ
        window.onload = function() {
            // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
            const user = localStorage.getItem('touchscreen_user') || sessionStorage.getItem('touchscreen_user');
            if (!user) {
                window.location.href = 'login.html';
                return;
            }

            // Âä†ËΩΩÁî®Êà∑ËÆæÁΩÆ
            loadUserSettings();
            
            // Êõ¥Êñ∞Êó∂Èó¥
            updateTime();
            setInterval(updateTime, 1000);
        };

        // Êõ¥Êñ∞Êó∂Èó¥ÊòæÁ§∫
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        // ÂàáÊç¢È°µÈù¢
        function switchPage(page) {
            // È°µÈù¢Ë∑≥ËΩ¨
            if (page === 'home') {
                window.location.href = 'home.html';
            } else if (page === 'data') {
                window.location.href = 'data.html';
            } else if (page === 'control') {
                window.location.href = 'control.html';
            } else if (page === 'alarm') {
                window.location.href = 'alarm.html';
            } else if (page === 'history') {
                window.location.href = 'history.html';
            } else if (page === 'log') {
                window.location.href = 'logs.html';
            } else if (page === 'settings') {
                window.location.href = 'settings.html';
            }
        }

        // ÂàáÊç¢ËØ≠Ë®Ä‰∏ãÊãâËèúÂçï
        function toggleLanguage(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('langDropdown');
            dropdown.classList.toggle('show');
        }

        // ÈÄâÊã©ËØ≠Ë®Ä
        function selectLanguage(lang, event) {
            event.stopPropagation();
            
            // Êõ¥Êñ∞ÈÄâ‰∏≠Áä∂ÊÄÅ
            document.querySelectorAll('.lang-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ‰øùÂ≠òËØ≠Ë®ÄËÆæÁΩÆ
            localStorage.setItem('touchscreen_language', lang);
            
            // ÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
            document.getElementById('langDropdown').classList.remove('show');
            
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ËØ≠Ë®ÄÂàáÊç¢ÈÄªËæë
            console.log('ÂàáÊç¢ËØ≠Ë®ÄÂà∞:', lang);
        }

        // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠‰∏ãÊãâËèúÂçï
        document.addEventListener('click', function(e) {
            const langBtn = document.querySelector('.tech-icon-btn');
            if (langBtn && !langBtn.contains(e.target)) {
                document.getElementById('langDropdown').classList.remove('show');
            }
        });

        // ÂàáÊç¢ËÆæÁΩÆÈ°µÈù¢
        function switchSection(section) {
            // Êõ¥Êñ∞ËèúÂçïÁä∂ÊÄÅ
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.toggle('active', item.dataset.section === section);
            });

            // Êõ¥Êñ∞ÂÜÖÂÆπÂå∫
            const contentSections = document.querySelectorAll('.content-section');
            contentSections.forEach(content => {
                content.classList.toggle('active', content.dataset.section === section);
            });
        }

        // Ê£ÄÊü•ÂØÜÁ†ÅÂº∫Â∫¶
        function checkPasswordStrength() {
            const password = document.getElementById('newPassword').value;
            const strengthBar = document.getElementById('passwordStrengthBar');
            if (password.length === 0) {
                strengthBar.className = 'password-strength-bar';
                return;
            }

            let score = 0;
            if (password.length >= 8) score++;
            if (/[a-z]/.test(password)) score++;
            if (/[A-Z]/.test(password)) score++;
            if (/[0-9]/.test(password)) score++;
            if (/[^A-Za-z0-9]/.test(password)) score++;

            if (score <= 2) {
                strengthBar.className = 'password-strength-bar weak';
            } else if (score <= 3) {
                strengthBar.className = 'password-strength-bar medium';
            } else {
                strengthBar.className = 'password-strength-bar strong';
            }
        }

        // ÂêØÁî®ÂØÜÁ†ÅÁºñËæë
        function enablePasswordEdit() {
            document.getElementById('passwordEditSection').style.display = 'block';
            document.getElementById('editPasswordBtn').style.display = 'none';
        }
        
        // ÂèñÊ∂àÂØÜÁ†ÅÁºñËæë
        function cancelPasswordEdit() {
            document.getElementById('passwordEditSection').style.display = 'none';
            document.getElementById('editPasswordBtn').style.display = 'inline-flex';
            
            // Ê∏ÖÁ©∫ÂØÜÁ†ÅÂ≠óÊÆµ
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }
        
        // ‰øùÂ≠òÂØÜÁ†Å‰øÆÊîπ
        function savePasswordChange() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword) {
                showNotification('ËØ∑ËæìÂÖ•ÂΩìÂâçÂØÜÁ†Å', 'error');
                return;
            }

            if (!newPassword) {
                showNotification('ËØ∑ËæìÂÖ•Êñ∞ÂØÜÁ†Å', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showNotification('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥', 'error');
                return;
            }

            if (newPassword.length < 8) {
                showNotification('Êñ∞ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë8‰Ωç', 'error');
                return;
            }

            // ËøôÈáåÂ∫îËØ•Ë∞ÉÁî®ÂêéÁ´ØAPIÈ™åËØÅÂΩìÂâçÂØÜÁ†ÅÂíå‰øùÂ≠òÊñ∞ÂØÜÁ†Å
            // ÁõÆÂâçÂè™ÊòØÊ®°Êãü‰øùÂ≠òÊàêÂäü
            showNotification('ÂØÜÁ†Å‰øÆÊîπÊàêÂäü', 'success');
            
            // ÂÖ≥Èó≠ÁºñËæëÊ®°Âºè
            cancelPasswordEdit();
        }

        // ÂàáÊç¢Ëá™Âä®ÈîÅÂÆö
        function toggleAutoLock() {
            const autoLockEnabled = document.getElementById('autoLock').checked;
            const lockTimeoutSelect = document.getElementById('lockTimeout');
            
            if (!autoLockEnabled) {
                // ÂΩìËá™Âä®ÈîÅÂÆöÂÖ≥Èó≠Êó∂ÔºåËÆæÁΩÆ‰∏∫Ê∞∏‰∏ç
                lockTimeoutSelect.value = 'never';
                lockTimeoutSelect.disabled = true;
            } else {
                // ÂΩìËá™Âä®ÈîÅÂÆöÂºÄÂêØÊó∂ÔºåÊÅ¢Â§çÂèØÈÄâÊã©Áä∂ÊÄÅ
                lockTimeoutSelect.disabled = false;
                if (lockTimeoutSelect.value === 'never') {
                    lockTimeoutSelect.value = '15'; // ÈªòËÆ§15ÂàÜÈíü
                }
            }
        }

        // ‰øùÂ≠òÂÆâÂÖ®ËÆæÁΩÆ
        function saveSecuritySettings() {
            const settings = {
                autoLock: document.getElementById('autoLock').checked,
                lockTimeout: document.getElementById('lockTimeout').value
            };

            localStorage.setItem('securitySettings', JSON.stringify(settings));
            showNotification('ÂÆâÂÖ®ËÆæÁΩÆ‰øùÂ≠òÊàêÂäü', 'success');
        }

        // ‰øùÂ≠òÁ≥ªÁªüËÆæÁΩÆ
        function saveSystemSettings() {
            const settings = {
                refreshInterval: document.getElementById('refreshInterval').value,
                alarmNotification: document.getElementById('alarmNotification').checked,
                soundAlert: document.getElementById('soundAlert').checked
            };

            localStorage.setItem('systemSettings', JSON.stringify(settings));
            showNotification('Á≥ªÁªüËÆæÁΩÆ‰øùÂ≠òÊàêÂäü', 'success');
        }

        // Âä†ËΩΩÁî®Êà∑ËÆæÁΩÆ
        function loadUserSettings() {
            // Âä†ËΩΩË¥¶Âè∑ËÆæÁΩÆ
            const accountSettings = JSON.parse(localStorage.getItem('userAccountSettings') || '{}');
            if (accountSettings.displayName) {
                document.getElementById('displayName').value = accountSettings.displayName;
            }
            if (accountSettings.email) {
                document.getElementById('email').value = accountSettings.email;
            }

            // Âä†ËΩΩÂÆâÂÖ®ËÆæÁΩÆ
            const securitySettings = JSON.parse(localStorage.getItem('securitySettings') || '{}');
            if (securitySettings.autoLock !== undefined) {
                document.getElementById('autoLock').checked = securitySettings.autoLock;
            }
            if (securitySettings.lockTimeout) {
                document.getElementById('lockTimeout').value = securitySettings.lockTimeout;
            }
            
            // ÂàùÂßãÂåñËá™Âä®ÈîÅÂÆöÁä∂ÊÄÅ
            toggleAutoLock();

            // Âä†ËΩΩÁ≥ªÁªüËÆæÁΩÆ
            const systemSettings = JSON.parse(localStorage.getItem('systemSettings') || '{}');
            if (systemSettings.refreshInterval) {
                document.getElementById('refreshInterval').value = systemSettings.refreshInterval;
            }
            if (systemSettings.alarmNotification !== undefined) {
                document.getElementById('alarmNotification').checked = systemSettings.alarmNotification;
            }
            if (systemSettings.soundAlert !== undefined) {
                document.getElementById('soundAlert').checked = systemSettings.soundAlert;
            }
        }

        // ÊòæÁ§∫ÈÄöÁü•
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('show');
            }, 100);

            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // ========== Áîµ‰ª∑ËÆæÁΩÆÂäüËÉΩ ==========

        // Ëé∑ÂèñÊó∂ÊÆµÁ±ªÂûãÁöÑÊú¨Âú∞ÂåñÊ†áÁ≠æ
        function getPeriodLabel(type) {
            const labels = {
                peak: t('peakTime'),
                flat: t('normalTime'),
                valley: t('valleyTime')
            };
            return labels[type] || type;
        }

        // Áîµ‰ª∑ÊñπÊ°àÊï∞ÊçÆÁªìÊûÑ
        let currentPriceScheme = {
            name: t('defaultPeakValley'),
            periods: [
                { type: 'valley', start: 0, end: 6, price: 0.32, label: 'valley' },
                { type: 'peak', start: 6, end: 8, price: 0.85, label: 'peak' },
                { type: 'flat', start: 8, end: 12, price: 0.56, label: 'flat' },
                { type: 'peak', start: 12, end: 14, price: 0.85, label: 'peak' },
                { type: 'flat', start: 14, end: 18, price: 0.56, label: 'flat' },
                { type: 'peak', start: 18, end: 21, price: 0.85, label: 'peak' },
                { type: 'valley', start: 21, end: 24, price: 0.32, label: 'valley' }
            ]
        };

        // Ëé∑ÂèñÁîµ‰ª∑Ê®°ÊùøÊï∞ÊçÆ(ÂõΩÈôÖÂåñ)
        function getPriceTemplates() {
            return [
                {
                    name: t('jiangsuIndustrial'),
                    description: `${t('peakTime')}0.85  ${t('normalTime')}0.56  ${t('valleyTime')}0.32${t('priceUnit')}`,
                    periods: [
                        { type: 'valley', start: 0, end: 8, price: 0.32, label: 'valley' },
                        { type: 'peak', start: 8, end: 12, price: 0.85, label: 'peak' },
                        { type: 'flat', start: 12, end: 18, price: 0.56, label: 'flat' },
                        { type: 'peak', start: 18, end: 22, price: 0.85, label: 'peak' },
                        { type: 'valley', start: 22, end: 24, price: 0.32, label: 'valley' }
                    ]
                },
                {
                    name: t('shanghaiCommercial'),
                    description: `${t('peakTime')}0.92  ${t('normalTime')}0.58  ${t('valleyTime')}0.28${t('priceUnit')}`,
                    periods: [
                        { type: 'valley', start: 0, end: 6, price: 0.28, label: 'valley' },
                        { type: 'flat', start: 6, end: 10, price: 0.58, label: 'flat' },
                        { type: 'peak', start: 10, end: 12, price: 0.92, label: 'peak' },
                        { type: 'flat', start: 12, end: 19, price: 0.58, label: 'flat' },
                        { type: 'peak', start: 19, end: 21, price: 0.92, label: 'peak' },
                        { type: 'valley', start: 21, end: 24, price: 0.28, label: 'valley' }
                    ]
                },
                {
                    name: t('zhejiangIndustrial'),
                    description: `${t('peakTime')}0.89  ${t('normalTime')}0.55  ${t('valleyTime')}0.30${t('priceUnit')}`,
                    periods: [
                        { type: 'valley', start: 0, end: 7, price: 0.30, label: 'valley' },
                        { type: 'peak', start: 7, end: 11, price: 0.89, label: 'peak' },
                        { type: 'flat', start: 11, end: 18, price: 0.55, label: 'flat' },
                        { type: 'peak', start: 18, end: 23, price: 0.89, label: 'peak' },
                        { type: 'valley', start: 23, end: 24, price: 0.30, label: 'valley' }
                    ]
                },
                {
                    name: t('guangdongIndustrial'),
                    description: `${t('peakTime')}0.88  ${t('normalTime')}0.60  ${t('valleyTime')}0.35${t('priceUnit')}`,
                    periods: [
                        { type: 'valley', start: 0, end: 8, price: 0.35, label: 'valley' },
                        { type: 'peak', start: 8, end: 12, price: 0.88, label: 'peak' },
                        { type: 'flat', start: 12, end: 14, price: 0.60, label: 'flat' },
                        { type: 'peak', start: 14, end: 17, price: 0.88, label: 'peak' },
                        { type: 'flat', start: 17, end: 19, price: 0.60, label: 'flat' },
                        { type: 'peak', start: 19, end: 22, price: 0.88, label: 'peak' },
                        { type: 'valley', start: 22, end: 24, price: 0.35, label: 'valley' }
                    ]
                }
            ];
        }

        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñÁîµ‰ª∑ËÆæÁΩÆ
        document.addEventListener('DOMContentLoaded', function() {
            // Âä†ËΩΩ‰øùÂ≠òÁöÑÁîµ‰ª∑ÊñπÊ°à
            loadElectricityPriceScheme();
            // Ê∏≤ÊüìÁïåÈù¢
            updatePriceDisplay();
        });

        // Âä†ËΩΩÁîµ‰ª∑ÊñπÊ°à
        function loadElectricityPriceScheme() {
            const savedScheme = localStorage.getItem('electricityPriceScheme');
            if (savedScheme) {
                currentPriceScheme = JSON.parse(savedScheme);
            }
        }

        // Êõ¥Êñ∞Áîµ‰ª∑ÊòæÁ§∫
        function updatePriceDisplay() {
            // Êõ¥Êñ∞ÊñπÊ°àÂêçÁß∞
            document.getElementById('currentPlanName').textContent = currentPriceScheme.name || 'Êú™ËÆæÁΩÆÁîµ‰ª∑ÊñπÊ°à';

            // Ê∏≤Êüì24Â∞èÊó∂Áº©Áï•Âõæ
            renderTimePreviewBar();

            // Êõ¥Êñ∞Áîµ‰ª∑ÊëòË¶Å
            updatePriceSummary();
        }

        // Ê∏≤Êüì24Â∞èÊó∂Áº©Áï•Âõæ
        function renderTimePreviewBar() {
            const container = document.getElementById('timePreviewBar');
            if (!container) return;

            container.innerHTML = '';

            // ÂàõÂª∫24‰∏™Â∞èÊó∂ÁöÑËâ≤Âùó
            for (let hour = 0; hour < 24; hour++) {
                const block = document.createElement('div');
                block.className = 'time-block';

                // ÊâæÂà∞ÂØπÂ∫îÊó∂ÊÆµÁöÑÁ±ªÂûã
                const period = currentPriceScheme.periods.find(p =>
                    hour >= p.start && hour < p.end
                );

                if (period) {
                    block.classList.add(period.type);
                }

                container.appendChild(block);
            }
        }

        // Êõ¥Êñ∞Áîµ‰ª∑ÊëòË¶Å
        function updatePriceSummary() {
            const peakPeriods = currentPriceScheme.periods.filter(p => p.type === 'peak');
            const flatPeriods = currentPriceScheme.periods.filter(p => p.type === 'flat');
            const valleyPeriods = currentPriceScheme.periods.filter(p => p.type === 'valley');

            const peakPrice = peakPeriods.length > 0 ? peakPeriods[0].price : '--';
            const flatPrice = flatPeriods.length > 0 ? flatPeriods[0].price : '--';
            const valleyPrice = valleyPeriods.length > 0 ? valleyPeriods[0].price : '--';

            document.querySelector('.peak-tag .tag-value').textContent =
                typeof peakPrice === 'number' ? `${peakPrice}${t('priceUnit')}` : `--${t('priceUnit')}`;
            document.querySelector('.flat-tag .tag-value').textContent =
                typeof flatPrice === 'number' ? `${flatPrice}${t('priceUnit')}` : `--${t('priceUnit')}`;
            document.querySelector('.valley-tag .tag-value').textContent =
                typeof valleyPrice === 'number' ? `${valleyPrice}${t('priceUnit')}` : `--${t('priceUnit')}`;
        }

        // ÂàáÊç¢‰ª∑Ê†ºÁºñËæëÂô®
        function togglePriceEditor() {
            showCustomEditor();
        }

        // ÊòæÁ§∫Ëá™ÂÆö‰πâÁºñËæëÂô®
        function showCustomEditor() {
            document.getElementById('priceEditorSection').style.display = 'block';
            document.getElementById('templateSelectorSection').style.display = 'none';

            // Ê∏≤ÊüìÊó∂Èó¥ËΩ¥
            renderTimeline();
            // Ê∏≤ÊüìÊó∂ÊÆµÂàóË°®
            renderPeriodList();
        }

        // ÂÖ≥Èó≠‰ª∑Ê†ºÁºñËæëÂô®
        function closePriceEditor() {
            document.getElementById('priceEditorSection').style.display = 'none';
        }

        // ÊòæÁ§∫Ê®°ÊùøÈÄâÊã©Âô®
        function showTemplateSelector() {
            document.getElementById('templateSelectorSection').style.display = 'block';
            document.getElementById('priceEditorSection').style.display = 'none';

            // Ê∏≤ÊüìÊ®°ÊùøÂàóË°®
            renderTemplateList();
        }

        // ÂÖ≥Èó≠Ê®°ÊùøÈÄâÊã©Âô®
        function closeTemplateSelector() {
            document.getElementById('templateSelectorSection').style.display = 'none';
        }

        // Ê∏≤ÊüìÊ®°ÊùøÂàóË°®
        function renderTemplateList() {
            const container = document.getElementById('templateList');
            if (!container) return;

            container.innerHTML = '';

            getPriceTemplates().forEach((template, index) => {
                const card = document.createElement('div');
                card.className = 'template-card';
                card.onclick = () => applyTemplate(index);

                // Ê®°ÊùøÂêçÁß∞
                const name = document.createElement('div');
                name.className = 'template-name';
                name.textContent = template.name;
                card.appendChild(name);

                // Êó∂ÊÆµÈ¢ÑËßà
                const preview = document.createElement('div');
                preview.className = 'template-preview';

                for (let hour = 0; hour < 24; hour++) {
                    const block = document.createElement('div');
                    block.className = 'template-preview-block';

                    const period = template.periods.find(p =>
                        hour >= p.start && hour < p.end
                    );

                    if (period) {
                        if (period.type === 'peak') block.style.background = '#FF6B4A';
                        else if (period.type === 'flat') block.style.background = '#4A90E2';
                        else if (period.type === 'valley') block.style.background = '#52C41A';
                    }

                    preview.appendChild(block);
                }
                card.appendChild(preview);

                // ÊèèËø∞‰ø°ÊÅØ
                const info = document.createElement('div');
                info.className = 'template-info';
                info.textContent = template.description;
                card.appendChild(info);

                container.appendChild(card);
            });
        }

        // Â∫îÁî®Ê®°Êùø
        function applyTemplate(templateIndex) {
            const template = getPriceTemplates()[templateIndex];

            currentPriceScheme = {
                name: template.name,
                periods: JSON.parse(JSON.stringify(template.periods))
            };

            // Êõ¥Êñ∞ÊòæÁ§∫
            updatePriceDisplay();

            // ‰øùÂ≠òÂà∞localStorage
            localStorage.setItem('electricityPriceScheme', JSON.stringify(currentPriceScheme));

            showNotification(t('templateAppliedSuccess'), 'success');
            closeTemplateSelector();
        }

        // Ê∏≤ÊüìÊó∂Èó¥ËΩ¥
        function renderTimeline() {
            const container = document.getElementById('timelineBlocks');
            if (!container) return;

            container.innerHTML = '';

            currentPriceScheme.periods.forEach((period, index) => {
                const width = ((period.end - period.start) / 24) * 100;

                const block = document.createElement('div');
                block.className = `timeline-block ${period.type}`;
                block.style.width = `${width}%`;
                block.textContent = getPeriodLabel(period.type);
                block.onclick = () => cyclePeriodType(index);

                container.appendChild(block);
            });
        }

        // Âæ™ÁéØÂàáÊç¢Êó∂ÊÆµÁ±ªÂûã
        function cyclePeriodType(periodIndex) {
            const types = ['peak', 'flat', 'valley'];
            const currentType = currentPriceScheme.periods[periodIndex].type;
            const currentIndex = types.indexOf(currentType);
            const nextType = types[(currentIndex + 1) % types.length];

            currentPriceScheme.periods[periodIndex].type = nextType;
            currentPriceScheme.periods[periodIndex].label = nextType;

            // Êõ¥Êñ∞‰ª∑Ê†º‰∏∫ËØ•Á±ªÂûãÁöÑÈªòËÆ§‰ª∑Ê†º
            if (nextType === 'peak') currentPriceScheme.periods[periodIndex].price = 0.85;
            else if (nextType === 'flat') currentPriceScheme.periods[periodIndex].price = 0.56;
            else if (nextType === 'valley') currentPriceScheme.periods[periodIndex].price = 0.32;

            renderTimeline();
            renderPeriodList();
        }

        // Ê∏≤ÊüìÊó∂ÊÆµÂàóË°®
        function renderPeriodList() {
            const container = document.getElementById('periodItems');
            if (!container) return;

            container.innerHTML = '';

            currentPriceScheme.periods.forEach((period, index) => {
                const item = document.createElement('div');
                item.className = 'period-item';

                // Â§¥ÈÉ®
                const header = document.createElement('div');
                header.className = 'period-item-header';

                const dot = document.createElement('div');
                dot.className = `period-color-dot ${period.type}`;
                header.appendChild(dot);

                const type = document.createElement('div');
                type.className = 'period-type';
                type.textContent = getPeriodLabel(period.type);
                header.appendChild(type);

                const actions = document.createElement('div');
                actions.className = 'period-actions';

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'icon-btn delete';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.onclick = () => deletePeriod(index);
                actions.appendChild(deleteBtn);

                header.appendChild(actions);
                item.appendChild(header);

                // Êó∂Èó¥ËåÉÂõ¥
                const timeDiv = document.createElement('div');
                timeDiv.className = 'period-time';
                timeDiv.textContent = `${String(period.start).padStart(2, '0')}:00 - ${String(period.end).padStart(2, '0')}:00`;
                item.appendChild(timeDiv);

                // Áîµ‰ª∑ËæìÂÖ•
                const priceInput = document.createElement('div');
                priceInput.className = 'period-price-input';

                const inputWrapper = document.createElement('div');
                inputWrapper.className = 'price-input-wrapper';

                const input = document.createElement('input');
                input.type = 'number';
                input.className = 'price-input';
                input.value = period.price.toFixed(4);
                input.step = '0.0001';
                input.min = '0';
                input.max = '10';
                input.placeholder = t('priceUnit');
                input.oninput = (e) => updatePeriodPrice(index, parseFloat(e.target.value));
                inputWrapper.appendChild(input);

                priceInput.appendChild(inputWrapper);
                item.appendChild(priceInput);

                container.appendChild(item);
            });
        }

        // Êõ¥Êñ∞Êó∂ÊÆµ‰ª∑Ê†º
        function updatePeriodPrice(periodIndex, newPrice) {
            if (isNaN(newPrice) || newPrice < 0) return;
            currentPriceScheme.periods[periodIndex].price = newPrice;
            updatePriceSummary();
        }

        // Âà†Èô§Êó∂ÊÆµ
        function deletePeriod(periodIndex) {
            if (currentPriceScheme.periods.length <= 1) {
                showNotification('Ëá≥Â∞ëÈúÄË¶Å‰øùÁïô‰∏Ä‰∏™Êó∂ÊÆµ', 'warning');
                return;
            }

            currentPriceScheme.periods.splice(periodIndex, 1);
            renderTimeline();
            renderPeriodList();
        }

        // Ê∑ªÂä†Êó∂ÊÆµ
        function addPeriod() {
            showNotification(t('addPeriodInDevelopment'), 'info');
        }

        // ÊÅ¢Â§çÈªòËÆ§
        function resetToDefault() {
            currentPriceScheme = {
                name: t('defaultPeakValley'),
                periods: [
                    { type: 'valley', start: 0, end: 6, price: 0.32, label: 'valley' },
                    { type: 'peak', start: 6, end: 8, price: 0.85, label: 'peak' },
                    { type: 'flat', start: 8, end: 12, price: 0.56, label: 'flat' },
                    { type: 'peak', start: 12, end: 14, price: 0.85, label: 'peak' },
                    { type: 'flat', start: 14, end: 18, price: 0.56, label: 'flat' },
                    { type: 'peak', start: 18, end: 21, price: 0.85, label: 'peak' },
                    { type: 'valley', start: 21, end: 24, price: 0.32, label: 'valley' }
                ]
            };

            renderTimeline();
            renderPeriodList();
            updatePriceDisplay();

            showNotification('Â∑≤ÊÅ¢Â§ç‰∏∫ÈªòËÆ§ÊñπÊ°à', 'success');
        }

        // ‰øùÂ≠òÁîµ‰ª∑ÈÖçÁΩÆ
        function savePriceConfig() {
            // È™åËØÅÊï∞ÊçÆÂÆåÊï¥ÊÄß
            if (!validatePriceScheme()) {
                return;
            }

            // ‰øùÂ≠òÂà∞localStorage
            localStorage.setItem('electricityPriceScheme', JSON.stringify(currentPriceScheme));

            // Êõ¥Êñ∞ÊòæÁ§∫
            updatePriceDisplay();

            showNotification('Áîµ‰ª∑ÊñπÊ°à‰øùÂ≠òÊàêÂäü', 'success');
            closePriceEditor();
        }

        // È™åËØÅÁîµ‰ª∑ÊñπÊ°à
        function validatePriceScheme() {
            // Ê£ÄÊü•ÊòØÂê¶ÊúâÊó∂ÊÆµ
            if (!currentPriceScheme.periods || currentPriceScheme.periods.length === 0) {
                showNotification('ËØ∑Ëá≥Â∞ëÈÖçÁΩÆ‰∏Ä‰∏™Êó∂ÊÆµ', 'error');
                return false;
            }

            // Ê£ÄÊü•ÊØè‰∏™Êó∂ÊÆµÁöÑ‰ª∑Ê†º
            for (const period of currentPriceScheme.periods) {
                if (period.price < 0 || period.price > 10) {
                    showNotification(t('priceRangeError'), 'error');
                    return false;
                }
            }

            // Ê£ÄÊü•Êó∂ÊÆµÊòØÂê¶Ë¶ÜÁõñÂÆåÊï¥ÁöÑ24Â∞èÊó∂
            const hours = new Array(24).fill(false);
            for (const period of currentPriceScheme.periods) {
                for (let h = period.start; h < period.end; h++) {
                    if (hours[h]) {
                        showNotification('Â≠òÂú®Êó∂ÊÆµÈáçÂè†', 'error');
                        return false;
                    }
                    hours[h] = true;
                }
            }

            if (hours.some(h => !h)) {
                showNotification('24Â∞èÊó∂Êó∂ÊÆµÊú™ÂÆåÂÖ®Ë¶ÜÁõñ', 'error');
                return false;
            }

            return true;
        }

    </script>
    <script src="common-header-scripts.js">
        // ========== ÂõΩÈôÖÂåñÂàùÂßãÂåñ ==========

        // ÁõëÂê¨ËØ≠Ë®ÄÂàáÊç¢‰∫ã‰ª∂
        window.addEventListener('languageChanged', function(e) {
            console.log('È°µÈù¢Êé•Êî∂Âà∞ËØ≠Ë®ÄÂàáÊç¢‰∫ã‰ª∂:', e.detail.lang);

            // Êõ¥Êñ∞HTML langÂ±ûÊÄß
            document.documentElement.lang = e.detail.lang === 'zh' ? 'zh-CN' : 'en';

            // ÈáçÊñ∞Â∫îÁî®ÁøªËØëÂà∞ÊâÄÊúâÂÖÉÁ¥†
            if (typeof applyTouchscreenTranslations === 'function') {
                applyTouchscreenTranslations();
            }

            // Êõ¥Êñ∞Áîµ‰ª∑ËÆæÁΩÆÁöÑÂä®ÊÄÅÂÜÖÂÆπ
            currentPriceScheme.name = t('defaultPeakValley');
            updatePriceDisplay();
            renderTimeline();
            renderPeriodList();
        });

        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñËØ≠Ë®Ä
        document.addEventListener('DOMContentLoaded', function() {
            const currentLang = getTouchscreenLang();
            console.log('ÂΩìÂâçÈ°µÈù¢ËØ≠Ë®Ä:', currentLang);

            // ËÆæÁΩÆHTML langÂ±ûÊÄß
            document.documentElement.lang = currentLang === 'zh' ? 'zh-CN' : 'en';

            // HTMLÈªòËÆ§ÊòØËã±Êñá,Âè™ÊúâÂΩìÂâçËØ≠Ë®ÄÊòØ‰∏≠ÊñáÊó∂ÊâçÈúÄË¶ÅÁøªËØë
            if (currentLang === 'zh' && typeof applyTouchscreenTranslations === 'function') {
                applyTouchscreenTranslations();
            }

            // Êõ¥Êñ∞ËØ≠Ë®ÄÂàáÊç¢Âô®ÁöÑÊøÄÊ¥ªÁä∂ÊÄÅ
            document.querySelectorAll('.lang-option').forEach(option => {
                const optionLang = option.getAttribute('onclick').includes("'zh'") ? 'zh' : 'en';
                if (optionLang === currentLang) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
        });

    </script>

    <!-- ÈÄÄÂá∫Á°ÆËÆ§ÂºπÁ™ó -->
    <div id="logoutModal" class="logout-modal">
        <div class="logout-content">
            <div class="logout-icon">
                <i class="fas fa-sign-out-alt"></i>
            </div>
            <div class="logout-title" id="logoutTitle">ÈÄÄÂá∫ÁôªÂΩï</div>
            <div class="logout-message" id="logoutMessage">ÊÇ®Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÂΩìÂâçË¥¶Êà∑ÂêóÔºüÈÄÄÂá∫ÂêéÈúÄË¶ÅÈáçÊñ∞ÁôªÂΩï„ÄÇ</div>
            <div class="logout-buttons">
                <button class="logout-btn-action cancel" id="logoutCancelBtn" onclick="closeLogoutModal()">
                    <i class="fas fa-times"></i> ÂèñÊ∂à
                </button>
                <button class="logout-btn-action confirm" id="logoutConfirmBtn" onclick="confirmLogout()">
                    <i class="fas fa-sign-out-alt"></i> ÈÄÄÂá∫
                </button>
            </div>
        </div>
    </div>
</body>
</html>