# ğŸ”„ é¡µé¢åˆ‡æ¢æ—¶è´§å¸ç¬¦å·æ˜¾ç¤ºä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

**åœºæ™¯:** ç”¨æˆ·åœ¨è‹±æ–‡ç¯å¢ƒä¸‹,ä»å…¶ä»–é¡µé¢(å¦‚ dashboard.html)åˆ‡æ¢åˆ° devices.html æ—¶

**é—®é¢˜ç°è±¡:**
- Profit Statistics å¡ç‰‡æ˜¾ç¤ºçš„æ˜¯ `Â¥12,350` è€Œä¸æ˜¯ `$12,350`
- éœ€è¦å†æ¬¡ç‚¹å‡»è¯­è¨€åˆ‡æ¢æŒ‰é’®æ‰ä¼šæ›´æ–°ä¸º `$` ç¬¦å·

**é¢„æœŸè¡Œä¸º:**
- é¡µé¢åˆ‡æ¢ååº”è¯¥ç«‹å³æ˜¾ç¤ºä¸å½“å‰è¯­è¨€ç¯å¢ƒä¸€è‡´çš„è´§å¸ç¬¦å·

## ğŸ” æ ¹æœ¬åŸå› 

### é—®é¢˜ 1: DOMContentLoaded ä¸ä¼šé‡å¤è§¦å‘

å½“ç”¨æˆ·é€šè¿‡ä¾§è¾¹æ å¯¼èˆªåˆ‡æ¢é¡µé¢æ—¶:
- å¦‚æœé¡µé¢ä¹‹å‰å·²ç»åŠ è½½è¿‡,**ä¸ä¼šå†æ¬¡è§¦å‘ `DOMContentLoaded` äº‹ä»¶**
- é¡µé¢ä¸­çš„æ”¶ç›Šæ•°æ®æ˜¾ç¤ºçš„æ˜¯ HTML ä¸­ç¡¬ç¼–ç çš„åˆå§‹å€¼ `Â¥12,350`
- `updateRevenueCurrency()` æ²¡æœ‰è¢«è°ƒç”¨,å¯¼è‡´è´§å¸ç¬¦å·æ²¡æœ‰æ›´æ–°

### é—®é¢˜ 2: åˆå§‹åŒ–é¡ºåºä¸å½“

devices.html çš„åˆå§‹åŒ–ä»£ç é¡ºåºæœ‰é—®é¢˜:

```javascript
// âŒ é”™è¯¯çš„é¡ºåº
document.addEventListener('DOMContentLoaded', function() {
    // å…ˆè°ƒç”¨ updateRevenueCurrency,ä½†æ­¤æ—¶ currentLang å¯èƒ½è¿˜æœªæ­£ç¡®è®¾ç½®
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // åè®¾ç½®è¯­è¨€
    if (typeof setLanguage === 'function') {
        setLanguage(currentLang);
    }
});
```

### é—®é¢˜ 3: ç¼ºå°‘é¡µé¢æ˜¾ç¤ºç›‘å¬

æ²¡æœ‰ç›‘å¬ `pageshow` äº‹ä»¶,æ— æ³•åœ¨é¡µé¢åˆ‡æ¢æ˜¾ç¤ºæ—¶æ›´æ–°è´§å¸ç¬¦å·ã€‚

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯

**å¤šå±‚ä¿éšœæœºåˆ¶:**
1. **DOMContentLoaded**: é¡µé¢é¦–æ¬¡åŠ è½½æ—¶åˆå§‹åŒ–
2. **languageChanged**: ç”¨æˆ·ä¸»åŠ¨åˆ‡æ¢è¯­è¨€æ—¶æ›´æ–°
3. **pageshow**: é¡µé¢åˆ‡æ¢æ˜¾ç¤ºæ—¶ç¡®ä¿åŒæ­¥ âœ¨ æ–°å¢

### ä¿®å¤æ­¥éª¤

#### æ­¥éª¤ 1: è°ƒæ•´åˆå§‹åŒ–é¡ºåº (devices.html)

ç¡®ä¿ `setLanguage` åœ¨ `updateRevenueCurrency` ä¹‹å‰æ‰§è¡Œ:

**ä¿®å¤å‰:**
```javascript
document.addEventListener('DOMContentLoaded', function() {
    // âŒ å…ˆæ›´æ–°è´§å¸,æ­¤æ—¶è¯­è¨€å¯èƒ½æœªè®¾ç½®
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // åè®¾ç½®è¯­è¨€
    if (typeof setLanguage === 'function') {
        setLanguage(currentLang);
    }
});
```

**ä¿®å¤å:**
```javascript
document.addEventListener('DOMContentLoaded', function() {
    // âœ… å…ˆè®¾ç½®è¯­è¨€(å¿…é¡»ä¼˜å…ˆ)
    if (typeof setLanguage === 'function') {
        setLanguage(currentLang);
    }

    // å†æ›´æ–°è´§å¸æ˜¾ç¤º
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }
});
```

**ä¿®æ”¹ä½ç½®:** [devices.html:7840-7848](devices.html#L7840-L7848)

#### æ­¥éª¤ 2: å¢å¼ºè¯­è¨€åˆ‡æ¢ç›‘å¬å™¨ (devices.html)

åœ¨ `languageChanged` äº‹ä»¶ç›‘å¬å™¨ä¸­æ·»åŠ è´§å¸æ›´æ–°:

**ä¿®å¤å‰:**
```javascript
window.addEventListener('languageChanged', function() {
    // âŒ åªé‡æ–°æ¸²æŸ“è¡¨æ ¼,æ²¡æœ‰æ›´æ–°è´§å¸
    if (typeof renderTable === 'function') {
        renderTable();
    }
});
```

**ä¿®å¤å:**
```javascript
window.addEventListener('languageChanged', function() {
    // âœ… å…ˆæ›´æ–°è´§å¸ç¬¦å·
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // å†é‡æ–°æ¸²æŸ“è¡¨æ ¼
    if (typeof renderTable === 'function') {
        renderTable();
    }
});
```

**ä¿®æ”¹ä½ç½®:** [devices.html:7934-7937](devices.html#L7934-L7937)

#### æ­¥éª¤ 3: æ·»åŠ  pageshow ç›‘å¬å™¨ (devices.html)

**æ–°å¢ç›‘å¬å™¨:**
```javascript
// ç›‘å¬é¡µé¢æ˜¾ç¤ºäº‹ä»¶ï¼ˆå¤„ç†ä»å…¶ä»–é¡µé¢åˆ‡æ¢å›æ¥çš„æƒ…å†µï¼‰
window.addEventListener('pageshow', function() {
    // ç¡®ä¿è´§å¸ç¬¦å·ä¸å½“å‰è¯­è¨€ä¸€è‡´
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }
});
```

**ä½œç”¨:**
- æ¯æ¬¡é¡µé¢æ˜¾ç¤ºæ—¶éƒ½ä¼šè§¦å‘(åŒ…æ‹¬ä»å…¶ä»–é¡µé¢åˆ‡æ¢å›æ¥)
- ç¡®ä¿è´§å¸ç¬¦å·ä¸å½“å‰è¯­è¨€ç¯å¢ƒåŒæ­¥

**æ·»åŠ ä½ç½®:** [devices.html:7945-7951](devices.html#L7945-L7951)

#### æ­¥éª¤ 4: ä¸ºå…¶ä»–é¡µé¢ä¹Ÿæ·»åŠ  pageshow ç›‘å¬å™¨

ä¸ºäº†ä¿æŒä¸€è‡´æ€§,ä¹Ÿä¸º dashboard.html å’Œ data-analysis.html æ·»åŠ åŒæ ·çš„ç›‘å¬å™¨ã€‚

**dashboard.html (3861-3867è¡Œ):**
```javascript
window.addEventListener('pageshow', function() {
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }
});
```

**data-analysis.html (1168-1178è¡Œ):**
```javascript
window.addEventListener('pageshow', function() {
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }
    if (typeof updateTableHeaderCurrency === 'function') {
        updateTableHeaderCurrency();
    }
});
```

## ğŸ“Š å®Œæ•´çš„äº‹ä»¶æµç¨‹

### åœºæ™¯ 1: é¡µé¢é¦–æ¬¡åŠ è½½

```
ç”¨æˆ·æ‰“å¼€ devices.html
        â†“
DOMContentLoaded äº‹ä»¶è§¦å‘
        â†“
setLanguage(currentLang)  â† è®¾ç½®è¯­è¨€ç¯å¢ƒ
        â†“
updateRevenueCurrency()   â† æ›´æ–°è´§å¸ç¬¦å·
        â†“
æ˜¾ç¤º: $12,350 (è‹±æ–‡) / Â¥12,350 (ä¸­æ–‡)
```

### åœºæ™¯ 2: ç”¨æˆ·ä¸»åŠ¨åˆ‡æ¢è¯­è¨€

```
ç”¨æˆ·ç‚¹å‡»è¯­è¨€åˆ‡æ¢æŒ‰é’®
        â†“
selectLanguage(lang) in common.js
        â†“
window.dispatchEvent('languageChanged')
        â†“
languageChanged ç›‘å¬å™¨è§¦å‘
        â†“
updateRevenueCurrency()
        â†“
è´§å¸ç¬¦å·æ›´æ–°å®Œæˆ
```

### åœºæ™¯ 3: ä»å…¶ä»–é¡µé¢åˆ‡æ¢åˆ°å½“å‰é¡µé¢ âœ¨

```
ç”¨æˆ·åœ¨è‹±æ–‡ç¯å¢ƒä¸‹
        â†“
ä» dashboard.html åˆ‡æ¢åˆ° devices.html
        â†“
pageshow äº‹ä»¶è§¦å‘ âœ¨
        â†“
updateRevenueCurrency()
        â†“
æ£€æŸ¥ currentLang = 'en'
        â†“
æ›´æ–°æ‰€æœ‰ data-revenue å…ƒç´ ä¸º $
        â†“
æ˜¾ç¤º: $12,350 âœ…
```

## ğŸ¯ ä¿®å¤æ•ˆæœå¯¹æ¯”

### ä¿®å¤å‰

| æ“ä½œæ­¥éª¤ | æ˜¾ç¤ºç»“æœ | é—®é¢˜ |
|---------|---------|------|
| 1. åˆ‡æ¢åˆ°è‹±æ–‡ | âœ… æ­£ç¡®æ˜¾ç¤º $ | - |
| 2. å¯¼èˆªåˆ° devices.html | âŒ æ˜¾ç¤º Â¥ | **éœ€è¦å†ç‚¹ä¸€æ¬¡è¯­è¨€æŒ‰é’®** |
| 3. å†æ¬¡ç‚¹å‡»è‹±æ–‡æŒ‰é’® | âœ… æ˜¾ç¤º $ | ç”¨æˆ·ä½“éªŒå·® |

### ä¿®å¤å

| æ“ä½œæ­¥éª¤ | æ˜¾ç¤ºç»“æœ | é—®é¢˜ |
|---------|---------|------|
| 1. åˆ‡æ¢åˆ°è‹±æ–‡ | âœ… æ­£ç¡®æ˜¾ç¤º $ | - |
| 2. å¯¼èˆªåˆ° devices.html | âœ… è‡ªåŠ¨æ˜¾ç¤º $ | **ç«‹å³åŒæ­¥** âœ¨ |

## âœ… éªŒè¯æ¸…å•

### åŸºç¡€éªŒè¯
- [ ] é¡µé¢é¦–æ¬¡åŠ è½½,ä¸­æ–‡ç¯å¢ƒæ˜¾ç¤º `Â¥`
- [ ] é¡µé¢é¦–æ¬¡åŠ è½½,è‹±æ–‡ç¯å¢ƒæ˜¾ç¤º `$`

### è¯­è¨€åˆ‡æ¢éªŒè¯
- [ ] åœ¨å½“å‰é¡µé¢åˆ‡æ¢è¯­è¨€,è´§å¸ç¬¦å·ç«‹å³æ›´æ–°
- [ ] ä¸­æ–‡ â†’ è‹±æ–‡: `Â¥` â†’ `$`
- [ ] è‹±æ–‡ â†’ ä¸­æ–‡: `$` â†’ `Â¥`

### é¡µé¢åˆ‡æ¢éªŒè¯ âœ¨ é‡ç‚¹
- [ ] **è‹±æ–‡ç¯å¢ƒ**,ä» dashboard åˆ‡æ¢åˆ° devices,æ˜¾ç¤º `$`
- [ ] **è‹±æ–‡ç¯å¢ƒ**,ä» devices åˆ‡æ¢åˆ° data-analysis,æ˜¾ç¤º `$`
- [ ] **ä¸­æ–‡ç¯å¢ƒ**,é¡µé¢åˆ‡æ¢åæ˜¾ç¤º `Â¥`
- [ ] å¤šæ¬¡æ¥å›åˆ‡æ¢é¡µé¢,è´§å¸ç¬¦å·å§‹ç»ˆæ­£ç¡®

### å®Œæ•´æµç¨‹éªŒè¯
1. æ‰“å¼€ä»»æ„é¡µé¢(ä¸­æ–‡ç¯å¢ƒ)
2. åˆ‡æ¢åˆ°è‹±æ–‡
3. å¯¼èˆªåˆ° devices.html
4. **éªŒè¯:** Profit Statistics æ˜¾ç¤º `$12,350` âœ…
5. å¯¼èˆªåˆ° data-analysis.html
6. **éªŒè¯:** è¡¨å¤´æ˜¾ç¤º `Charge Cost($)` âœ…
7. å¯¼èˆªå› dashboard.html
8. **éªŒè¯:** æ”¶ç›Šå¡ç‰‡æ˜¾ç¤º `$` âœ…

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### pageshow äº‹ä»¶ç‰¹æ€§

**è§¦å‘æ—¶æœº:**
- é¡µé¢é¦–æ¬¡åŠ è½½æ—¶
- ä»æµè§ˆå™¨åé€€/å‰è¿›ç¼“å­˜æ¢å¤æ—¶
- **ä»å…¶ä»–é¡µé¢å¯¼èˆªåˆ°å½“å‰é¡µé¢æ—¶** âœ¨

**ä¸ DOMContentLoaded çš„åŒºåˆ«:**

| äº‹ä»¶ | è§¦å‘æ¡ä»¶ | æ˜¯å¦é‡å¤è§¦å‘ |
|------|---------|------------|
| DOMContentLoaded | DOM å®Œå…¨åŠ è½½ | âŒ ä»…è§¦å‘ä¸€æ¬¡ |
| pageshow | é¡µé¢æ˜¾ç¤º | âœ… æ¯æ¬¡æ˜¾ç¤ºéƒ½è§¦å‘ |

**ç¤ºä¾‹:**
```javascript
// DOMContentLoaded: åªåœ¨é¡µé¢é¦–æ¬¡åŠ è½½æ—¶è§¦å‘
document.addEventListener('DOMContentLoaded', function() {
    console.log('é¡µé¢åŠ è½½å®Œæˆ');  // åªè¾“å‡ºä¸€æ¬¡
});

// pageshow: æ¯æ¬¡é¡µé¢æ˜¾ç¤ºæ—¶éƒ½ä¼šè§¦å‘
window.addEventListener('pageshow', function() {
    console.log('é¡µé¢æ˜¾ç¤º');  // åˆ‡æ¢å›æ¥ä¹Ÿä¼šè¾“å‡º
});
```

### ä¸ºä»€ä¹ˆéœ€è¦å¤šä¸ªç›‘å¬å™¨?

**ä¸‰å±‚ä¿éšœæœºåˆ¶:**

1. **DOMContentLoaded** - è´Ÿè´£é¡µé¢é¦–æ¬¡åŠ è½½åˆå§‹åŒ–
   - ç¡®ä¿é¡µé¢æ‰“å¼€æ—¶æ­£ç¡®æ˜¾ç¤º
   - è®¾ç½®åˆå§‹çŠ¶æ€

2. **languageChanged** - è´Ÿè´£ç”¨æˆ·ä¸»åŠ¨åˆ‡æ¢è¯­è¨€
   - å“åº”ç”¨æˆ·æ“ä½œ
   - æ›´æ–°æ‰€æœ‰è¯­è¨€ç›¸å…³å†…å®¹

3. **pageshow** - è´Ÿè´£é¡µé¢åˆ‡æ¢åŒæ­¥
   - å¤„ç†å¯¼èˆªåœºæ™¯
   - ç¡®ä¿çŠ¶æ€ä¸€è‡´æ€§

**å®ƒä»¬æ˜¯äº’è¡¥çš„,è€Œä¸æ˜¯é‡å¤çš„!**

## ğŸš€ æ‰©å±•åº”ç”¨

### å…¶ä»–éœ€è¦åŒæ­¥çš„åœºæ™¯

å¦‚æœé¡µé¢æœ‰å…¶ä»–éœ€è¦åœ¨é¡µé¢æ˜¾ç¤ºæ—¶åŒæ­¥çš„çŠ¶æ€:

```javascript
window.addEventListener('pageshow', function() {
    // åŒæ­¥è´§å¸ç¬¦å·
    if (typeof updateRevenueCurrency === 'function') {
        updateRevenueCurrency();
    }

    // åŒæ­¥ä¸»é¢˜(å¦‚æœæœ‰æš—è‰²æ¨¡å¼)
    if (typeof applyTheme === 'function') {
        applyTheme();
    }

    // åŒæ­¥ç”¨æˆ·åå¥½è®¾ç½®
    if (typeof syncUserPreferences === 'function') {
        syncUserPreferences();
    }
});
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

`pageshow` ä¼šé¢‘ç¹è§¦å‘,å¦‚æœæ›´æ–°æ“ä½œå¾ˆé‡,å¯ä»¥æ·»åŠ é˜²æŠ–:

```javascript
let updateTimer;
window.addEventListener('pageshow', function() {
    clearTimeout(updateTimer);
    updateTimer = setTimeout(function() {
        if (typeof updateRevenueCurrency === 'function') {
            updateRevenueCurrency();
        }
    }, 100);  // 100ms é˜²æŠ–
});
```

ä½†å¯¹äº `updateRevenueCurrency` è¿™æ ·çš„è½»é‡çº§æ“ä½œ,ä¸éœ€è¦é˜²æŠ–ã€‚

## ğŸ“ ä¿®æ”¹æ€»ç»“

| æ–‡ä»¶ | ä¿®æ”¹ä½ç½® | ä¿®æ”¹å†…å®¹ | è¯´æ˜ |
|------|---------|---------|------|
| devices.html | 7840-7848 | è°ƒæ•´åˆå§‹åŒ–é¡ºåº | setLanguage ä¼˜å…ˆ |
| devices.html | 7934-7937 | å¢å¼ºè¯­è¨€åˆ‡æ¢ç›‘å¬ | æ·»åŠ è´§å¸æ›´æ–° |
| devices.html | 7945-7951 | æ–°å¢ pageshow ç›‘å¬ | å¤„ç†é¡µé¢åˆ‡æ¢ âœ¨ |
| dashboard.html | 3861-3867 | æ–°å¢ pageshow ç›‘å¬ | ä¿æŒä¸€è‡´æ€§ |
| data-analysis.html | 1168-1178 | æ–°å¢ pageshow ç›‘å¬ | ä¿æŒä¸€è‡´æ€§ |

## âœ… ä¿®å¤å®Œæˆç¡®è®¤

- âœ… devices.html åˆå§‹åŒ–é¡ºåºå·²è°ƒæ•´
- âœ… devices.html è¯­è¨€åˆ‡æ¢ç›‘å¬å™¨å·²å¢å¼º
- âœ… æ‰€æœ‰ä¸‰ä¸ªé¡µé¢éƒ½æ·»åŠ äº† pageshow ç›‘å¬å™¨
- âœ… é¡µé¢åˆ‡æ¢æ—¶è´§å¸ç¬¦å·è‡ªåŠ¨åŒæ­¥

---

**ä¿®å¤å®Œæˆæ—¥æœŸ**: 2026-01-13
**ä¿®å¤è€…**: Claude Code
**ç›¸å…³æ–‡æ¡£**:
- [æ”¶ç›Šè´§å¸ç¬¦å·å›½é™…åŒ–è¯´æ˜.md](./æ”¶ç›Šè´§å¸ç¬¦å·å›½é™…åŒ–è¯´æ˜.md)
- [è¡¨å¤´è´§å¸ç¬¦å·ä¿®å¤è¯´æ˜.md](./è¡¨å¤´è´§å¸ç¬¦å·ä¿®å¤è¯´æ˜.md)
