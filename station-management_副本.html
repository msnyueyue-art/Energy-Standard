<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电站管理 - 工商储能管理系统</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.5;
            color: #1e293b;
            background: #EBEDF5;
            min-height: 100vh;
        }

        /* 侧边栏样式 */
        .sidebar {
            position: fixed;
            left: 0;
            top: 64px;
            width: 256px;
            height: calc(100vh - 64px);
            background: white;
            border-right: 1px solid #e2e8f0;
            transition: all 300ms ease;
            z-index: 100;
            overflow-y: auto;
        }
        
        .sidebar.collapsed {
            transform: translateX(-100%);
        }


        .menu-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: #64748b;
            text-decoration: none;
            transition: all 150ms ease;
            position: relative;
        }

        .menu-item:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .menu-item.active {
            background: #eff6ff;
            color: #3562E3;
        }

        .menu-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: #3562E3;
        }

        .menu-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 主内容区域 */
        .main-content {
            margin-left: 256px;
            margin-top: 64px;
            padding: 24px;
            min-height: calc(100vh - 64px);
            background: transparent;
            transition: margin-left 0.3s ease;
        }
        
        .main-content.expanded {
            margin-left: 0;
        }

        /* 顶部导航栏 */
        .navbar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 2rem;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .page-header {
            margin-bottom: 24px;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            transition: all 150ms ease;
        }

        .nav-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        /* 内容区域 */
        .content {
            flex: 1;
            padding: 2rem;
        }

        /* 搜索和筛选区域 */
        .search-filter-section {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e2e8f0;
        }

        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .search-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            align-items: end;
        }

        .search-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-label {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }

        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            background: white;
            color: #1e293b;
            transition: all 150ms ease;
            min-width: 200px;
        }
        
        .search-select {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            background: white;
            color: #1e293b;
            transition: all 150ms ease;
            min-width: 180px;
            cursor: pointer;
        }
        
        .search-select:disabled {
            background: #f8fafc;
            color: #94a3b8;
            cursor: not-allowed;
        }

        .search-input:focus,
        .search-select:focus {
            outline: none;
            border-color: #3562E3;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-button {
            padding: 0.5rem 1.5rem;
            background: #3562E3;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            height: 2.5rem;
        }

        .search-button:hover {
            background: #2951d9;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .reset-button {
            padding: 0.5rem 1.5rem;
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .reset-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }
        
        .create-button {
            padding: 0.5rem 1.5rem;
            background: #3562E3;
            color: white;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            height: 2.5rem;
        }
        
        .create-button:hover {
            background: #2951d9;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .create-button span {
            color: white !important;
        }
        
        .create-button span:first-child {
            filter: brightness(0) invert(1);
        }

        .filter-button {
            padding: 0.5rem 1rem;
            background: white;
            color: #64748b;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 150ms ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }


        /* 电站列表区域 */
        .station-section {
            background: white;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
        }
        
        /* 电站状态Tab */
        .station-tabs {
            display: flex;
            gap: 0;
            border-bottom: 1px solid #e5e7eb;
            padding: 0 1.5rem;
        }
        
        .station-tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            position: relative;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .station-tab:hover {
            color: #374151;
        }
        
        .station-tab.active {
            color: #3562E3;
        }
        
        .station-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: #3562E3;
        }
        
        .tab-badge {
            background: #f3f4f6;
            color: #374151;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .station-tab.active .tab-badge {
            background: #dbeafe;
            color: #3562E3;
        }
        
        .station-tab.online .tab-badge {
            background: #d1fae5;
            color: #059669;
        }
        
        .station-tab.offline .tab-badge {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .station-tab.warning .tab-badge {
            background: #fef3c7;
            color: #d97706;
        }
        
        /* 分页样式 */
        .pagination-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .pagination-info {
            font-size: 0.875rem;
            color: #6b7280;
            transform: translateX(-20px);
        }
        
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(50px);
        }
        
        .pagination {
            display: flex;
            gap: 0.25rem;
        }
        
        .page-btn {
            min-width: 2rem;
            height: 2rem;
            padding: 0 0.5rem;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            color: #374151;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
        }
        
        .page-btn:hover:not(:disabled) {
            background: #f3f4f6;
            border-color: #d1d5db;
        }
        
        .page-btn.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }
        
        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .page-size-select {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .page-size-select select {
            padding: 0.25rem 0.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            background: white;
            cursor: pointer;
        }

        .section-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .view-toggles {
            display: flex;
            gap: 0.5rem;
        }

        .view-toggle {
            padding: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 150ms ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .view-toggle:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }

        .view-toggle.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }

        /* 电站卡片视图 */
        .station-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            padding: 1.5rem;
        }

        .station-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            overflow: hidden;
            transition: all 150ms ease;
            cursor: pointer;
        }

        .station-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .station-header {
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .station-name {
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .station-status {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-online {
            background: #f0fdf4;
            color: #16a34a;
        }

        .status-offline {
            background: #fef2f2;
            color: #dc2626;
        }

        .status-warning {
            background: #fff7ed;
            color: #ea580c;
        }

        .station-body {
            padding: 1rem;
        }

        .station-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .station-info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.75rem;
            color: #64748b;
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }

        .station-actions {
            display: flex;
            gap: 0.5rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .action-button {
            flex: 1;
            padding: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            cursor: pointer;
            transition: all 150ms ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .action-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        .action-button.favorite.active {
            color: #f59e0b;
        }
        
        /* 表格操作按钮 */
        .table-action {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.375rem;
            border-radius: 0.25rem;
            color: #374151;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .table-action:hover {
            background: #f3f4f6;
            color: #111827;
        }
        
        .table-action svg {
            width: 1rem;
            height: 1rem;
        }

        /* 电站列表视图 */
        #list-view-content {
            padding: 1.5rem;
        }
        
        .station-table {
            width: 100%;
            border-collapse: collapse;
        }

        .station-table th {
            background: #f8fafc;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #64748b;
            font-size: 0.875rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .station-table td {
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .station-table tr:hover {
            background: #f8fafc;
        }

        /* 分页 */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1.5rem;
        }

        .page-button {
            padding: 0.5rem 0.75rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            cursor: pointer;
            transition: all 150ms ease;
            min-width: 40px;
            text-align: center;
        }

        .page-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        .page-button.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }

        .page-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* 深色主题 */
        [data-theme="dark"] body {
            background: #0f172a;
            color: #f1f5f9;
        }

        [data-theme="dark"] .sidebar {
            background: #1e293b;
            border-color: #334155;
        }

        [data-theme="dark"] .sidebar-header {
            border-color: #334155;
        }

        [data-theme="dark"] .logo {
            color: #f1f5f9;
        }

        [data-theme="dark"] .menu-item {
            color: #cbd5e1;
        }

        [data-theme="dark"] .menu-item:hover {
            background: #334155;
            color: #f1f5f9;
        }

        [data-theme="dark"] .menu-item.active {
            background: #1e3a8a;
            color: #60a5fa;
        }

        [data-theme="dark"] .navbar {
            background: #1e293b;
            border-color: #334155;
        }

        [data-theme="dark"] .page-title {
            color: #f1f5f9;
        }

        [data-theme="dark"] .nav-button {
            background: #334155;
            border-color: #475569;
            color: #cbd5e1;
        }

        [data-theme="dark"] .nav-button:hover {
            background: #475569;
            border-color: #64748b;
            color: #f1f5f9;
        }

        [data-theme="dark"] .search-filter-section,
        [data-theme="dark"] .station-section,
        [data-theme="dark"] .station-card {
            background: #1e293b;
            border-color: #334155;
        }

        [data-theme="dark"] .search-input {
            background: #334155;
            border-color: #475569;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .search-input::placeholder {
            color: #94a3b8;
        }
        
        [data-theme="dark"] .search-input:focus {
            border-color: #3562E3;
        }
        
        [data-theme="dark"] .search-select {
            background: #334155;
            border-color: #475569;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .search-select:disabled {
            background: #1e293b;
            color: #64748b;
        }
        
        [data-theme="dark"] .reset-button {
            background: #374151;
            color: #d1d5db;
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .reset-button:hover {
            background: #4b5563;
            border-color: #6b7280;
        }
        
        [data-theme="dark"] .create-button {
            background: #60a5fa;
        }
        
        [data-theme="dark"] .create-button:hover {
            background: #3562E3;
        }
        
        [data-theme="dark"] .station-tabs {
            border-bottom-color: #374151;
        }
        
        [data-theme="dark"] .station-tab {
            color: #9ca3af;
        }
        
        [data-theme="dark"] .station-tab:hover {
            color: #e5e7eb;
        }
        
        [data-theme="dark"] .station-tab.active {
            color: #60a5fa;
        }
        
        [data-theme="dark"] .station-tab.active::after {
            background: #60a5fa;
        }
        
        [data-theme="dark"] .tab-badge {
            background: #374151;
            color: #d1d5db;
        }
        
        [data-theme="dark"] .station-tab.active .tab-badge {
            background: #1e3a8a;
            color: #60a5fa;
        }
        
        [data-theme="dark"] .station-tab.online .tab-badge {
            background: #064e3b;
            color: #10b981;
        }
        
        [data-theme="dark"] .station-tab.offline .tab-badge {
            background: #7f1d1d;
            color: #ef4444;
        }
        
        [data-theme="dark"] .station-tab.warning .tab-badge {
            background: #78350f;
            color: #fbbf24;
        }
        
        [data-theme="dark"] .pagination-wrapper {
            border-top-color: #374151;
        }
        
        [data-theme="dark"] .pagination-info {
            color: #9ca3af;
        }
        
        [data-theme="dark"] .page-btn {
            background: #1f2937;
            border-color: #374151;
            color: #d1d5db;
        }
        
        [data-theme="dark"] .page-btn:hover:not(:disabled) {
            background: #374151;
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .page-btn.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }
        
        [data-theme="dark"] .page-size-select select {
            background: #374151;
            border-color: #4b5563;
            color: #d1d5db;
        }
        
        /* 弹窗样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 0.5rem;
            max-width: 800px;
            max-height: 90vh;
            width: 90%;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 0.25rem;
        }
        
        .modal-close:hover {
            color: #374151;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.25rem;
        }
        
        .form-label.required::before {
            content: "*";
            color: #ef4444;
            margin-right: 0.25rem;
        }
        
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.65rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: border-color 0.2s ease;
            height: 42px;
            box-sizing: border-box;
            line-height: 1.4;
        }
        
        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #3562E3;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .file-upload {
            border: 2px dashed #d1d5db;
            border-radius: 0.375rem;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }
        
        .file-upload:hover {
            border-color: #3562E3;
        }
        
        .file-upload-text {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .device-section {
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .device-input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .device-input {
            flex: 1;
        }
        
        .add-device-btn {
            padding: 0.5rem 1rem;
            background: #3562E3;
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .add-device-btn:hover {
            background: #3562E3;
        }
        
        .qr-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .qr-upload {
            width: 100px;
            height: 100px;
            border: 2px dashed #d1d5db;
            border-radius: 0.375rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .qr-upload:hover {
            border-color: #3562E3;
        }
        
        .price-type-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .radio-group {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .radio-group input[type="radio"] {
            margin: 0;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            color: #374151;
        }
        
        .radio-option input[type="radio"] {
            margin: 0;
            cursor: pointer;
        }
        
        .radio-option span {
            user-select: none;
        }
        
        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }
        
        .btn-cancel {
            padding: 0.5rem 1.5rem;
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .btn-cancel:hover {
            background: #e5e7eb;
        }
        
        .btn-submit {
            padding: 0.5rem 1.5rem;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .btn-submit:hover {
            background: #059669;
        }
        
        /* 深色主题适配 */
        [data-theme="dark"] .modal-content {
            background: #1f2937;
        }
        
        [data-theme="dark"] .modal-header {
            border-color: #374151;
        }
        
        [data-theme="dark"] .modal-title,
        [data-theme="dark"] .section-title,
        [data-theme="dark"] .form-label {
            color: #f9fafb;
        }
        
        [data-theme="dark"] .section-title {
            border-color: #374151;
        }
        
        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] .form-textarea {
            background: #374151;
            border-color: #4b5563;
            color: #f9fafb;
        }
        
        [data-theme="dark"] .form-input:focus,
        [data-theme="dark"] .form-select:focus,
        [data-theme="dark"] .form-textarea:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }
        
        [data-theme="dark"] .device-section {
            border-color: #374151;
        }
        
        [data-theme="dark"] .file-upload,
        [data-theme="dark"] .qr-upload {
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .file-upload:hover,
        [data-theme="dark"] .qr-upload:hover {
            border-color: #60a5fa;
        }
        
        [data-theme="dark"] .file-upload-text {
            color: #9ca3af;
        }
        
        [data-theme="dark"] .modal-footer {
            border-color: #374151;
        }
        
        [data-theme="dark"] .btn-cancel {
            background: #374151;
            color: #d1d5db;
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .btn-cancel:hover {
            background: #4b5563;
        }
        
        
        /* 移动端响应式 - 查询功能 */
        @media (max-width: 768px) {
            .search-input,
            .search-select {
                min-width: auto;
            }
            
            .station-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .station-tabs::-webkit-scrollbar {
                display: none;
            }
            
            .station-tab {
                padding: 0.75rem 1rem;
                white-space: nowrap;
                flex-shrink: 0;
            }
            
            .tab-badge {
                padding: 0.125rem 0.375rem;
                font-size: 0.7rem;
            }
        }

        [data-theme="dark"] .search-input:focus,
        [data-theme="dark"] .search-select:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        [data-theme="dark"] .stat-title,
        [data-theme="dark"] .search-label,
        [data-theme="dark"] .info-label {
            color: #94a3b8;
        }

        [data-theme="dark"] .stat-value,
        [data-theme="dark"] .section-title,
        [data-theme="dark"] .station-name,
        [data-theme="dark"] .info-value {
            color: #f1f5f9;
        }

        [data-theme="dark"] .section-header,
        [data-theme="dark"] .station-header,
        [data-theme="dark"] .station-actions {
            border-color: #334155;
        }

        [data-theme="dark"] .view-toggle {
            background: #334155;
            border-color: #475569;
            color: #cbd5e1;
        }

        [data-theme="dark"] .view-toggle:hover {
            background: #475569;
            border-color: #64748b;
            color: #f1f5f9;
        }

        [data-theme="dark"] .view-toggle.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }

        [data-theme="dark"] .action-button {
            background: #334155;
            border-color: #475569;
            color: #cbd5e1;
        }

        [data-theme="dark"] .action-button:hover {
            background: #475569;
            border-color: #64748b;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .table-action {
            color: #d1d5db;
        }
        
        [data-theme="dark"] .table-action:hover {
            background: #374151;
            color: #f3f4f6;
        }

        [data-theme="dark"] .station-table th {
            background: #334155;
            color: #94a3b8;
            border-color: #475569;
        }

        [data-theme="dark"] .station-table td {
            border-color: #334155;
        }

        [data-theme="dark"] .station-table tr:hover {
            background: #334155;
        }

        [data-theme="dark"] .page-button {
            background: #334155;
            border-color: #475569;
            color: #cbd5e1;
        }

        [data-theme="dark"] .page-button:hover {
            background: #475569;
            border-color: #64748b;
            color: #f1f5f9;
        }

        [data-theme="dark"] .page-button.active {
            background: #3562E3;
            color: white;
            border-color: #3562E3;
        }

        /* 弹窗样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .modal-content.modal-large {
            max-width: 1200px;
        }
        
        .station-detail-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            min-height: 600px;
        }
        
        .station-detail-info {
            padding-right: 2rem;
            border-right: 1px solid #e2e8f0;
        }
        
        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .topology-container {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            position: relative;
        }
        
        .topology-fullscreen-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 150ms ease;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.875rem;
            color: #64748b;
        }
        
        .topology-fullscreen-btn:hover {
            background: #f8fafc;
            border-color: #3562E3;
            color: #3562E3;
        }
        
        .topology-image {
            width: 100%;
            height: auto;
            max-width: 100%;
            object-fit: contain;
            border-radius: 4px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .metric-card {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .device-status-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .device-status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 6px;
        }
        
        .device-name {
            font-size: 0.875rem;
            color: #475569;
        }
        
        .device-status {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-weight: 500;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            border-radius: 0.5rem;
            transition: all 150ms ease;
        }

        .modal-close:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .modal-body {
            padding: 1.5rem;
            max-height: calc(90vh - 140px);
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.65rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 150ms ease;
            height: 42px;
            box-sizing: border-box;
            line-height: 1.4;
        }

        .form-input:focus {
            outline: none;
            border-color: #3562E3;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 150ms ease;
            border: none;
            font-weight: 500;
        }

        .btn-cancel {
            background: white;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .btn-cancel:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        .btn-primary {
            background: #3562E3;
            color: white;
            border-radius: 0.5rem;
        }

        .btn-primary:hover {
            background: #2951d9;
        }

        [data-theme="dark"] .modal-content {
            background: #1e293b;
        }

        [data-theme="dark"] .modal-header,
        [data-theme="dark"] .modal-footer {
            border-color: #334155;
        }

        [data-theme="dark"] .modal-title,
        [data-theme="dark"] .form-label {
            color: #f1f5f9;
        }

        [data-theme="dark"] .modal-close {
            color: #94a3b8;
        }

        [data-theme="dark"] .modal-close:hover {
            background: #334155;
            color: #f1f5f9;
        }
        
        /* 向导步骤样式 */
        .wizard-steps {
            display: flex;
            justify-content: flex-start;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
            position: relative;
            width: 100%;
            overflow: visible;
        }
        
        .wizard-step {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: none;
            position: relative;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
            white-space: nowrap;
        }
        
        .wizard-step.active {
            opacity: 1;
        }
        
        .wizard-step.completed {
            opacity: 1;
        }
        
        .wizard-step:not(:last-child)::after {
            content: '';
            position: absolute;
            left: calc(100% + 1rem);
            top: 50%;
            transform: translateY(-50%);
            height: 2px;
            background: #e5e7eb;
        }
        
        .wizard-step[data-step="1"]::after {
            width: 168px;
        }
        
        .wizard-step[data-step="2"]::after {
            width: 168px;
        }
        
        .wizard-step.completed:not(:last-child)::after {
            background: #3562E3;
        }
        
        .step-number {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            background: #e5e7eb;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.2s;
            flex-shrink: 0;
            min-width: 2rem;
            min-height: 2rem;
        }
        
        .wizard-step.active .step-number {
            background: #3562E3;
            color: white;
        }
        
        .wizard-step.completed .step-number {
            background: #3562E3;
            color: white;
        }
        
        .wizard-step.completed .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .wizard-step.completed .step-number::before {
            content: '✓';
            font-size: 1rem;
            font-weight: bold;
        }
        
        .wizard-step.completed .step-number {
            font-size: 0;
        }
        
        .step-title {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }
        
        .wizard-step.active .step-title,
        .wizard-step.completed .step-title {
            color: #1f2937;
        }
        
        /* 步骤内容 */
        .wizard-content {
            display: none;
        }
        
        .wizard-content.active {
            display: block;
        }
        
        .wizard-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f9fafb;
        }
        
        .wizard-nav {
            display: flex;
            gap: 0.75rem;
        }
        
        .btn-secondary {
            background: white;
            color: #4b5563;
            border: 1px solid #d1d5db;
        }
        
        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }
        
        [data-theme="dark"] .wizard-footer {
            background: #1e293b;
            border-color: #374151;
        }
        
        [data-theme="dark"] .btn-secondary {
            background: #374151;
            color: #f3f4f6;
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .btn-secondary:hover {
            background: #4b5563;
            border-color: #6b7280;
        }
        
        /* 步骤按钮区域暗色主题 */
        [data-theme="dark"] .wizard-content div[style*="border-top"] {
            border-color: #374151 !important;
        }
        
        /* 设备表单暗色主题 */
        [data-theme="dark"] .device-form {
            background: #1e293b !important;
            border: 1px solid #374151;
        }
        
        [data-theme="dark"] .device-list-container h4,
        [data-theme="dark"] .device-form h4 {
            color: #f1f5f9 !important;
        }
        
        /* 向导按钮 */
        .wizard-buttons {
            display: flex;
            justify-content: space-between;
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            background: #f9fafb;
        }
        
        .wizard-buttons .btn-prev {
            background: white;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }
        
        .wizard-buttons .btn-prev:hover {
            background: #f9fafb;
        }
        
        .wizard-buttons .btn-next {
            background: #3562E3;
            color: white;
        }
        
        .wizard-buttons .btn-next:hover {
            background: #3562E3;
        }
        
        .wizard-buttons .btn-complete {
            background: #10b981;
            color: white;
        }
        
        .wizard-buttons .btn-complete:hover {
            background: #059669;
        }
        
        /* 深色主题适配 */
        [data-theme="dark"] .wizard-steps {
            background: #1e293b;
            border-color: #334155;
        }
        
        [data-theme="dark"] .wizard-step:not(:last-child)::after {
            background: #334155;
        }
        
        [data-theme="dark"] .step-number {
            background: #334155;
            color: #9ca3af;
        }
        
        [data-theme="dark"] .wizard-step.active .step-title,
        [data-theme="dark"] .wizard-step.completed .step-title {
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .wizard-buttons {
            background: #1e293b;
            border-color: #334155;
        }
        
        [data-theme="dark"] .wizard-buttons .btn-prev {
            background: #374151;
            color: #f1f5f9;
            border-color: #4b5563;
        }
        
        [data-theme="dark"] .wizard-buttons .btn-prev:hover {
            background: #4b5563;
        }

        [data-theme="dark"] .form-input {
            background: #334155;
            border-color: #475569;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .form-input[readonly] {
            background: #1e293b;
            color: #94a3b8;
        }
        
        /* 定位按钮样式 */
        .location-btn {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.15s;
        }
        
        .location-btn:hover {
            color: #3562E3;
        }
        
        [data-theme="dark"] .location-btn {
            color: #9ca3af;
        }
        
        [data-theme="dark"] .location-btn:hover {
            color: #60a5fa;
        }
        
        /* 地图弹窗样式 */
        .map-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .map-modal-content {
            background: white;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 800px;
            height: 80vh;
            max-height: 600px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .map-modal-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .map-search-bar {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            gap: 0.5rem;
        }
        
        .map-search-input {
            flex: 1;
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }
        
        .map-search-btn {
            padding: 0.5rem 1rem;
            background: #3562E3;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .map-search-btn:hover {
            background: #3562E3;
        }
        
        .map-container {
            flex: 1;
            position: relative;
            background: #f3f4f6;
        }
        
        .map-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .map-modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .map-coords {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .map-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        /* 深色主题适配 */
        [data-theme="dark"] .map-modal-content {
            background: #1e293b;
        }
        
        [data-theme="dark"] .map-modal-header,
        [data-theme="dark"] .map-search-bar,
        [data-theme="dark"] .map-modal-footer {
            border-color: #334155;
        }
        
        [data-theme="dark"] .map-search-input {
            background: #334155;
            border-color: #475569;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .map-container {
            background: #0f172a;
        }
        
        [data-theme="dark"] .map-coords {
            color: #9ca3af;
        }

        [data-theme="dark"] .form-input:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        [data-theme="dark"] .btn-cancel {
            background: #334155;
            border-color: #475569;
            color: #cbd5e1;
        }

        [data-theme="dark"] .btn-cancel:hover {
            background: #475569;
            border-color: #64748b;
            color: #f1f5f9;
        }

        /* 响应式设计 */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .station-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        /* 全屏查看模态框 */
        .fullscreen-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            animation: fadeIn 200ms ease;
        }
        
        .fullscreen-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .fullscreen-image {
            max-width: none;
            max-height: none;
            width: auto;
            height: auto;
            object-fit: contain;
            animation: zoomIn 300ms ease;
            cursor: grab;
            transition: transform 0.1s ease-out;
            transform-origin: center center;
            user-select: none;
            -webkit-user-drag: none;
        }
        
        .fullscreen-image.grabbing {
            cursor: grabbing;
        }
        
        /* 缩放控制按钮 */
        .zoom-controls {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.9);
            padding: 0.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .zoom-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #475569;
            transition: all 150ms ease;
        }
        
        .zoom-btn:hover {
            background: #f1f5f9;
            color: #1e293b;
        }
        
        .zoom-info {
            display: flex;
            align-items: center;
            padding: 0 1rem;
            font-size: 0.875rem;
            color: #475569;
            min-width: 60px;
            justify-content: center;
        }
        
        .fullscreen-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            width: 48px;
            height: 48px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #1e293b;
            transition: all 150ms ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .fullscreen-close:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        /* 深色主题 - 缩放控件 */
        [data-theme="dark"] .zoom-controls {
            background: rgba(30, 41, 59, 0.9);
        }
        
        [data-theme="dark"] .zoom-btn {
            background: #1e293b;
            color: #e2e8f0;
        }
        
        [data-theme="dark"] .zoom-btn:hover {
            background: #334155;
            color: #f1f5f9;
        }
        
        [data-theme="dark"] .zoom-info {
            color: #e2e8f0;
        }

        @media (max-width: 1200px) {
            .station-detail-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .station-detail-info {
                padding-right: 0;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 2rem;
            }
        }
        
        @media (max-width: 768px) {
            .content {
                padding: 1rem;
            }

            .search-row {
                flex-direction: column;
            }

            .search-group {
                width: 100%;
            }

            .search-input,
            .search-select {
                width: 100%;
            }


            .station-grid {
                grid-template-columns: 1fr;
            }

            .station-info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="header-left">
            <button class="menu-trigger" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <img src="logo.png" alt="AlwaysControl Technology" />
            </div>
        </div>
        
        <div class="header-right">
            <button class="theme-btn" onclick="toggleTheme()" title="切换主题">
                <i class="fas fa-moon" id="headerThemeIcon"></i>
            </button>
            <button class="lang-btn" onclick="toggleLanguage()" title="切换语言">
                <i class="fas fa-globe"></i>
            </button>
            <div class="notification-badge">
                <i class="fas fa-bell" style="font-size: 20px; color: var(--text-secondary);"></i>
            </div>
            <div class="user-menu" onclick="logout()">
                <div class="avatar">A</div>
                <span class="user-name" id="userName">管理员</span>
            </div>
        </div>
    </header>

    <!-- 侧边栏 -->
    <nav class="sidebar" id="sidebar">
        <div class="menu">
            <a href="dashboard.html" class="menu-item" data-menu="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span id="menuDashboard">仪表盘</span>
            </a>
            <a href="site1.html" class="menu-item" data-menu="site1">
                <i class="fas fa-building"></i>
                <span>站点管理</span>
            </a>
            <a href="devices.html" class="menu-item" data-menu="devices">
                <i class="fas fa-database"></i>
                <span id="menuDevices">设备管理</span>
            </a>
            <a href="#" class="menu-item" style="display: none;">
                <i class="fas fa-cogs"></i>
                <span id="menuControl">设备控制</span>
            </a>
            <a href="alarm-management.html" class="menu-item">
                <i class="fas fa-exclamation-triangle"></i>
                <span id="menuAlarms">告警管理</span>
            </a>
            <a href="rule-engine.html" class="menu-item" data-menu="rule-engine" style="display: none;">
                <i class="fas fa-code-branch"></i>
                <span>规则引擎</span>
            </a>
            <a href="station-management_副本.html" class="menu-item active">
                <i class="fas fa-broadcast-tower"></i>
                <span>电站管理</span>
            </a>
            <a href="system-management.html" class="menu-item">
                <i class="fas fa-users"></i>
                <span id="menuSystem">系统管理</span>
            </a>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-content" id="mainContent">
        <div class="page-header">
            <h1 class="page-title">电站管理</h1>
        </div>
            <!-- 查询区域 -->
            <div class="search-filter-section">
                <div class="search-row" style="justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <div class="search-group" style="flex: 0 0 300px;">
                            <label class="search-label">电站名称：</label>
                            <input type="text" class="search-input" placeholder="请输入电站名称" id="station-name-search">
                        </div>
                        <button class="search-button" onclick="searchStations()">
                            <span>🔍</span>
                            <span>搜索</span>
                        </button>
                        <button class="reset-button" onclick="resetSearch()">
                            <span>🔄</span>
                            <span>重置</span>
                        </button>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="create-button" onclick="createStation()">
                            <span>➕</span>
                            <span>新建</span>
                        </button>
                    </div>
                </div>
            </div>


            <!-- 电站列表 -->
            <div class="station-section">
                <!-- Tab切换 -->
                <div class="station-tabs" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; gap: 0;">
                        <button class="station-tab active" onclick="switchStationTab('all')" id="tab-all">
                            <span>全部</span>
                            <span class="tab-badge i18n-count" data-count="10" data-count-zh="10个" data-count-en="10">10个</span>
                        </button>
                        <button class="station-tab online" onclick="switchStationTab('online')" id="tab-online">
                            <span>在线</span>
                            <span class="tab-badge i18n-count" data-count="7" data-count-zh="7个" data-count-en="7">7个</span>
                        </button>
                        <button class="station-tab offline" onclick="switchStationTab('offline')" id="tab-offline">
                            <span>离线</span>
                            <span class="tab-badge i18n-count" data-count="2" data-count-zh="2个" data-count-en="2">2个</span>
                        </button>
                        <button class="station-tab warning" onclick="switchStationTab('warning')" id="tab-warning">
                            <span>告警</span>
                            <span class="tab-badge i18n-count" data-count="1" data-count-zh="1个" data-count-en="1">1个</span>
                        </button>
                    </div>
                </div>

                <!-- 表格视图 -->
                <div id="list-view-content" style="padding-top: 1.5rem;">
                    <table class="station-table">
                        <thead>
                            <tr>
                                <th class="i18n" data-i18n="station.name">电站名称</th>
                                <th class="i18n" data-i18n="station.status">状态</th>
                                <th class="i18n" data-i18n="station.power.installed">装机功率</th>
                                <th class="i18n" data-i18n="station.power.realtime">实时功率</th>
                                <th class="i18n" data-i18n="station.address">地址</th>
                                <th class="i18n" data-i18n="station.remark">备注</th>
                                <th style="width: 100px;" class="i18n" data-i18n="action.operation">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="上海工业园储能站" data-name-en="Shanghai Industrial Park Energy Storage Station">上海工业园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>2.5 MW</td>
                                <td>1.8 MW</td>
                                <td class="i18n-address" data-address-zh="上海市浦东新区张江高科技园区" data-address-en="Zhangjiang High-Tech Park, Pudong New Area, Shanghai">上海市浦东新区张江高科技园区</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST001')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST001')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="北京科技园储能站" data-name-en="Beijing Science Park Energy Storage Station">北京科技园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-warning i18n" data-i18n="station.status.warning">告警</span></td>
                                <td>3.0 MW</td>
                                <td>2.1 MW</td>
                                <td class="i18n-address" data-address-zh="北京市海淀区中关村科技园" data-address-en="Zhongguancun Science Park, Haidian District, Beijing">北京市海淀区中关村科技园</td>
                                <td class="i18n-remark" data-remark-zh="需要维护" data-remark-en="Maintenance required">需要维护</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST002')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST002')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="深圳产业园储能站" data-name-en="Shenzhen Industrial Park Energy Storage Station">深圳产业园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-offline i18n" data-i18n="station.status.offline">离线</span></td>
                                <td>1.5 MW</td>
                                <td>0 MW</td>
                                <td class="i18n-address" data-address-zh="深圳市南山区科技园南路" data-address-en="Science Park South Road, Nanshan District, Shenzhen">深圳市南山区科技园南路</td>
                                <td class="i18n-remark" data-remark-zh="设备检修中" data-remark-en="Equipment under maintenance">设备检修中</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST003')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST003')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="广州智慧园储能站" data-name-en="Guangzhou Smart Park Energy Storage Station">广州智慧园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>2.0 MW</td>
                                <td>1.5 MW</td>
                                <td class="i18n-address" data-address-zh="广州市天河区珠江新城" data-address-en="Zhujiang New Town, Tianhe District, Guangzhou">广州市天河区珠江新城</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST004')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST004')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="杭州科创园储能站" data-name-en="Hangzhou Innovation Park Energy Storage Station">杭州科创园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>1.8 MW</td>
                                <td>1.2 MW</td>
                                <td class="i18n-address" data-address-zh="杭州市西湖区文三路" data-address-en="Wensan Road, Xihu District, Hangzhou">杭州市西湖区文三路</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST005')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST005')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="南京高新区储能站" data-name-en="Nanjing High-tech Zone Energy Storage Station">南京高新区储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>2.2 MW</td>
                                <td>1.7 MW</td>
                                <td class="i18n-address" data-address-zh="南京市江宁区高新技术开发区" data-address-en="High-tech Development Zone, Jiangning District, Nanjing">南京市江宁区高新技术开发区</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST006')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST006')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="苏州工业园储能站" data-name-en="Suzhou Industrial Park Energy Storage Station">苏州工业园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>1.9 MW</td>
                                <td>1.4 MW</td>
                                <td class="i18n-address" data-address-zh="苏州市工业园区星湖街" data-address-en="Xinghu Street, Industrial Park, Suzhou">苏州市工业园区星湖街</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST007')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST007')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="武汉光谷储能站" data-name-en="Wuhan Optics Valley Energy Storage Station">武汉光谷储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>2.3 MW</td>
                                <td>1.9 MW</td>
                                <td class="i18n-address" data-address-zh="武汉市东湖新技术开发区" data-address-en="East Lake High-tech Development Zone, Wuhan">武汉市东湖新技术开发区</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST008')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST008')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="成都高新区储能站" data-name-en="Chengdu High-tech Zone Energy Storage Station">成都高新区储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-online i18n" data-i18n="station.status.online">在线</span></td>
                                <td>2.1 MW</td>
                                <td>1.6 MW</td>
                                <td class="i18n-address" data-address-zh="成都市高新区天府大道" data-address-en="Tianfu Avenue, High-tech Zone, Chengdu">成都市高新区天府大道</td>
                                <td class="i18n-remark" data-remark-zh="-" data-remark-en="-">-</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST009')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST009')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="station-name">
                                        <span>🏭</span>
                                        <span class="i18n-station-name" data-name-zh="西安科技园储能站" data-name-en="Xi'an Science Park Energy Storage Station">西安科技园储能站</span>
                                    </div>
                                </td>
                                <td><span class="station-status status-offline i18n" data-i18n="station.status.offline">离线</span></td>
                                <td>1.7 MW</td>
                                <td>0 MW</td>
                                <td class="i18n-address" data-address-zh="西安市高新区科技路" data-address-en="Technology Road, High-tech Zone, Xi'an">西安市高新区科技路</td>
                                <td class="i18n-remark" data-remark-zh="网络故障" data-remark-en="Network failure">网络故障</td>
                                <td>
                                    <div style="display: flex; gap: 0.25rem; justify-content: center;">
                                        <button class="table-action" onclick="editStation(event, 'ST010')" title="编辑">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </button>
                                        <button class="table-action" onclick="deleteStation(event, 'ST010')" title="删除">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
            
            <!-- 分页 -->
            <div class="pagination-wrapper">
                <div class="pagination-info">
                    <span>共 10 条记录</span>
                </div>
                <div class="pagination-controls">
                    <div class="page-size-select">
                        <span>每页显示</span>
                        <select onchange="changePageSize(this.value)">
                            <option value="10">10</option>
                            <option value="20" selected>20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                        <span>条</span>
                    </div>
                    <div class="pagination">
                        <button class="page-btn" onclick="changePage(1)" disabled>
                            <span>«</span>
                        </button>
                        <button class="page-btn" onclick="changePage(currentPage - 1)" disabled>
                            <span>‹</span>
                        </button>
                        
                        <button class="page-btn active" onclick="changePage(1)">1</button>
                        <button class="page-btn" onclick="changePage(2)">2</button>
                        <button class="page-btn" onclick="changePage(3)">3</button>
                        <button class="page-btn" onclick="changePage(4)">4</button>
                        <button class="page-btn" onclick="changePage(5)">5</button>
                        <span style="padding: 0 0.5rem; color: #6b7280;">...</span>
                        <button class="page-btn" onclick="changePage(8)">8</button>
                        
                        <button class="page-btn" onclick="changePage(currentPage + 1)">
                            <span>›</span>
                        </button>
                        <button class="page-btn" onclick="changePage(totalPages)">
                            <span>»</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 筛选弹窗 -->
    <div class="modal" id="filter-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">高级筛选</h3>
                <button class="modal-close" onclick="closeFilterModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">等效小时范围</label>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <input type="number" class="form-input" placeholder="最小值" id="min-hours">
                        <span>-</span>
                        <input type="number" class="form-input" placeholder="最大值" id="max-hours">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">下挂设备</label>
                    <select class="form-input" id="device-type">
                        <option value="">全部</option>
                        <option value="optimizer">优化器</option>
                        <option value="shutdown">关断器</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeFilterModal()">取消</button>
                <button class="btn btn-primary" onclick="applyFilter()">确认</button>
            </div>
        </div>
    </div>

    <!-- 分享弹窗 -->
    <div class="modal" id="share-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">分享电站</h3>
                <button class="modal-close" onclick="closeShareModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">被分享用户手机号</label>
                    <input type="tel" class="form-input" placeholder="请输入手机号" id="share-phone">
                </div>
                <div class="form-group">
                    <label class="form-label">电站权限</label>
                    <select class="form-input" id="share-permission">
                        <option value="viewer">浏览者 - 仅限电站数据的查看</option>
                        <option value="manager">管理者 - 电站的运维管理及数据查看</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeShareModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmShare()">确定</button>
            </div>
        </div>
    </div>

    <!-- 备注弹窗 -->
    <div class="modal" id="remark-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">编辑备注</h3>
                <button class="modal-close" onclick="closeRemarkModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">备注信息（最多150字）</label>
                    <textarea class="form-input" rows="4" placeholder="请输入备注信息" id="remark-text" maxlength="150"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeRemarkModal()">取消</button>
                <button class="btn btn-primary" onclick="saveRemark()">保存</button>
            </div>
        </div>
    </div>
    
    <!-- 电站详情弹窗 -->
    <div class="modal" id="station-detail-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title" id="station-detail-title">电站详情</h3>
                <button class="modal-close" onclick="closeStationDetailModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="station-detail-grid">
                    <div class="station-detail-info">
                        <h4 class="section-title">基本信息</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">电站名称</span>
                                <span class="info-value" id="detail-name">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">设备SN</span>
                                <span class="info-value" id="detail-sn">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">装机功率</span>
                                <span class="info-value" id="detail-power">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">运行状态</span>
                                <span class="info-value" id="detail-status">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">投运时间</span>
                                <span class="info-value" id="detail-date">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">所在地址</span>
                                <span class="info-value" id="detail-address">-</span>
                            </div>
                        </div>
                        <h4 class="section-title" style="margin-top: 2rem;">系统拓扑图</h4>
                        <div class="topology-container">
                            <img src="../images/commercial-topology.jpg" 
                                 alt="工商储能系统拓扑图" 
                                 class="topology-image"
                                 id="topology-image">
                            <button class="topology-fullscreen-btn" onclick="openFullscreenImage()">
                                <span>⛶</span>
                                <span>全屏</span>
                            </button>
                        </div>
                    </div>
                    <div class="station-detail-metrics">
                        <h4 class="section-title">实时数据</h4>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-label">实时功率</div>
                                <div class="metric-value" id="detail-realtime-power">0 MW</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">今日发电</div>
                                <div class="metric-value" id="detail-today-energy">0 MWh</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">累计发电</div>
                                <div class="metric-value" id="detail-total-energy">0 MWh</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">运行时长</div>
                                <div class="metric-value" id="detail-runtime">0 h</div>
                            </div>
                        </div>
                        <h4 class="section-title" style="margin-top: 2rem;">设备状态</h4>
                        <div class="device-status-list">
                            <div class="device-status-item">
                                <span class="device-name">逆变器</span>
                                <span class="device-status status-online">正常</span>
                            </div>
                            <div class="device-status-item">
                                <span class="device-name">电池组</span>
                                <span class="device-status status-online">正常</span>
                            </div>
                            <div class="device-status-item">
                                <span class="device-name">BMS系统</span>
                                <span class="device-status status-online">正常</span>
                            </div>
                            <div class="device-status-item">
                                <span class="device-name">监控系统</span>
                                <span class="device-status status-online">正常</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="goToStationMonitoring()">进入监控</button>
                <button class="btn btn-cancel" onclick="closeStationDetailModal()">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 全屏查看模态框 -->
    <div class="fullscreen-modal" id="fullscreen-modal">
        <div class="fullscreen-content">
            <img src="" alt="全屏查看" class="fullscreen-image" id="fullscreen-image">
            <button class="fullscreen-close" onclick="closeFullscreenImage()">×</button>
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()" title="缩小">-</button>
                <button class="zoom-btn" onclick="resetZoom()" title="重置">⌖</button>
                <div class="zoom-info" id="zoom-info">100%</div>
                <button class="zoom-btn" onclick="zoomIn()" title="放大">+</button>
            </div>
        </div>
    </div>

    <script>
        // 多语言配置
        const i18n = {
            zh: {
                // 页面标题
                'page.title': '电站管理',
                'system.name': '能源管理系统',
                
                // 菜单
                'menu.station': '电站管理',
                'menu.analysis': '数据分析',
                'menu.alarm': '告警管理',
                'menu.device': '设备管理',
                'menu.user': '用户管理',
                'menu.report': '报表中心',
                'menu.setting': '系统设置',
                
                
                // 搜索
                'search.region': '组织区域：',
                'search.organization': '组织名称：',
                'search.type': '电站类型：',
                'search.name': '电站名称/S·N：',
                'search.account': '用户账号：',
                'search.name.placeholder': '请输入电站名称或设备S·N',
                'search.account.placeholder': '请输入用户账号',
                'search.button': '查询',
                'filter.button': '筛选',
                
                // 统计
                'stat.total': '电站总数',
                'stat.power': '总装机功率',
                'stat.realtime': '实时功率',
                'stat.generation': '月发电量',
                'stat.compare.month': '较上月',
                'stat.compare.yesterday': '较昨日',
                
                // 电站信息
                'station.list': '电站列表',
                'station.total': '（共{count}个电站）',
                'station.status.online': '在线',
                'station.status.offline': '离线',
                'station.status.warning': '告警',
                'station.power.installed': '装机功率',
                'station.power.realtime': '实时功率',
                'station.generation.today': '今日发电',
                'station.sn': '设备SN',
                'station.address': '地址',
                'station.remark': '备注',
                'station.name': '电站名称',
                'station.status': '状态',
                
                // 操作
                'action.favorite': '关注',
                'action.favorited': '已关注',
                'action.share': '分享',
                'action.remark': '备注',
                'action.delete': '删除',
                'action.operation': '操作',
                
                // 弹窗
                'modal.filter.title': '高级筛选',
                'modal.filter.hours': '等效小时范围',
                'modal.filter.hours.min': '最小值',
                'modal.filter.hours.max': '最大值',
                'modal.filter.device': '下挂设备',
                'modal.filter.device.all': '全部',
                'modal.filter.device.optimizer': '优化器',
                'modal.filter.device.shutdown': '关断器',
                
                'modal.share.title': '分享电站',
                'modal.share.phone': '被分享用户手机号',
                'modal.share.phone.placeholder': '请输入手机号',
                'modal.share.permission': '电站权限',
                'modal.share.permission.viewer': '浏览者 - 仅限电站数据的查看',
                'modal.share.permission.manager': '管理者 - 电站的运维管理及数据查看',
                
                'modal.remark.title': '编辑备注',
                'modal.remark.label': '备注信息（最多150字）',
                'modal.remark.placeholder': '请输入备注信息',
                
                'modal.button.cancel': '取消',
                'modal.button.confirm': '确认',
                'modal.button.save': '保存',
                
                // 提示
                'confirm.delete': '确定要删除这个电站吗？删除后无法恢复。',
                'success.share': '分享成功',
                'success.remark': '备注保存成功',
                'success.delete': '删除成功',
                
                // 向导步骤
                'wizard.step1': '基础信息',
                'wizard.step2': '添加设备',
                'wizard.step3': '电价设置',
                'wizard.basicInfo': '基础信息',
                
                // 表单字段
                'form.stationName': '电站名称',
                'form.stationNamePlaceholder': '请输入电站名称',
                'form.stationType': '电站类型',
                'form.commercialStorage': '工商储',
                'form.address': '地址',
                'form.addressPlaceholder': '请输入详细地址',
                'form.timezone': '时区',
                'form.selectTimezone': '请选择时区',
                'form.installedCapacity': '装机容量(kWp)',
                'form.installedCapacityPlaceholder': '请输入装机功率',
                'form.gridConnectionTime': '并网时间',
                'form.currency': '货币单位',
                'form.feedPriceType': '上网电价类型',
                'form.consumePriceType': '用电电价类型',
                'form.feedPriceValue': '上网电价值',
                'form.consumePriceValue': '用电电价值',
                'form.fixedPrice': '固定电价',
                'form.feedPricePlaceholder': '请输入上网电价',
                'form.consumePricePlaceholder': '请输入用电电价',
                
                // 按钮
                'btn.cancel': '取消',
                'btn.previous': '上一步',
                'btn.next': '下一步',
                'btn.finish': '完成',
                'btn.addDevice': '添加设备',
                'btn.add': '添加',
                'btn.delete': '删除',
                
                // 模态框
                'modal.createStation': '新建电站',
                'modal.editStation': '编辑电站',
                
                // 设备相关
                'form.deviceSN': '设备SN',
                'form.deviceSNPlaceholder': '请输入设备SN',
                'form.deviceType': '设备类型',
                'form.selectDeviceType': '请选择设备类型',
                'device.inverter': '逆变器',
                'device.pv': '光伏',
                'device.battery': '电池',
                'device.meter': '电表',
                'device.gateway': '网关',
                'device.transformer': '变压器',
                'device.deviceList': '设备列表'
            },
            en: {
                // Page titles
                'page.title': 'Station Management',
                'system.name': 'Energy Management System',
                
                // Menu
                'menu.station': 'Station Management',
                'menu.analysis': 'Data Analysis',
                'menu.alarm': 'Alarm Management',
                'menu.device': 'Device Management',
                'menu.user': 'User Management',
                'menu.report': 'Report Center',
                'menu.setting': 'System Settings',
                
                
                // Search
                'search.region': 'Organization Region:',
                'search.organization': 'Organization Name:',
                'search.type': 'Station Type:',
                'search.name': 'Station Name/S·N:',
                'search.account': 'User Account:',
                'search.name.placeholder': 'Enter station name or device S·N',
                'search.account.placeholder': 'Enter user account',
                'search.button': 'Query',
                'filter.button': 'Filter',
                
                // Statistics
                'stat.total': 'Total Stations',
                'stat.power': 'Total Installed Power',
                'stat.realtime': 'Real-time Power',
                'stat.generation': 'Monthly Generation',
                'stat.compare.month': 'vs Last Month',
                'stat.compare.yesterday': 'vs Yesterday',
                
                // Station info
                'station.list': 'Station List',
                'station.total': '({count} stations in total)',
                'station.status.online': 'Online',
                'station.status.offline': 'Offline',
                'station.status.warning': 'Warning',
                'station.power.installed': 'Installed Power',
                'station.power.realtime': 'Real-time Power',
                'station.generation.today': "Today's Generation",
                'station.sn': 'Device SN',
                'station.address': 'Address',
                'station.remark': 'Remark',
                'station.name': 'Station Name',
                'station.status': 'Status',
                
                // Actions
                'action.favorite': 'Favorite',
                'action.favorited': 'Favorited',
                'action.share': 'Share',
                'action.remark': 'Remark',
                'action.delete': 'Delete',
                'action.operation': 'Operation',
                
                // Modals
                'modal.filter.title': 'Advanced Filter',
                'modal.filter.hours': 'Equivalent Hours Range',
                'modal.filter.hours.min': 'Min Value',
                'modal.filter.hours.max': 'Max Value',
                'modal.filter.device': 'Subordinate Device',
                'modal.filter.device.all': 'All',
                'modal.filter.device.optimizer': 'Optimizer',
                'modal.filter.device.shutdown': 'Shutdown Device',
                
                'modal.share.title': 'Share Station',
                'modal.share.phone': 'Shared User Phone',
                'modal.share.phone.placeholder': 'Enter phone number',
                'modal.share.permission': 'Station Permission',
                'modal.share.permission.viewer': 'Viewer - View station data only',
                'modal.share.permission.manager': 'Manager - Station operation and data viewing',
                
                'modal.remark.title': 'Edit Remark',
                'modal.remark.label': 'Remark (max 150 characters)',
                'modal.remark.placeholder': 'Enter remark',
                
                'modal.button.cancel': 'Cancel',
                'modal.button.confirm': 'Confirm',
                'modal.button.save': 'Save',
                
                // Messages
                'confirm.delete': 'Are you sure you want to delete this station? This action cannot be undone.',
                'success.share': 'Shared successfully',
                'success.remark': 'Remark saved successfully',
                'success.delete': 'Deleted successfully',
                
                // Wizard steps
                'wizard.step1': 'Basic Info',
                'wizard.step2': 'Add Devices',
                'wizard.step3': 'Pricing',
                'wizard.basicInfo': 'Basic Information',
                
                // Form fields
                'form.stationName': 'Station Name',
                'form.stationNamePlaceholder': 'Enter station name',
                'form.stationType': 'Station Type',
                'form.commercialStorage': 'Commercial Storage',
                'form.address': 'Address',
                'form.addressPlaceholder': 'Enter detailed address',
                'form.timezone': 'Timezone',
                'form.selectTimezone': 'Select timezone',
                'form.installedCapacity': 'Installed Capacity (kWp)',
                'form.installedCapacityPlaceholder': 'Enter installed capacity',
                'form.gridConnectionTime': 'Grid Connection Time',
                'form.currency': 'Currency',
                'form.feedPriceType': 'Feed-in Tariff Type',
                'form.consumePriceType': 'Consumption Tariff Type',
                'form.feedPriceValue': 'Feed-in Tariff Rate',
                'form.consumePriceValue': 'Consumption Tariff Rate',
                'form.fixedPrice': 'Fixed Price',
                'form.feedPricePlaceholder': 'Enter feed-in tariff rate',
                'form.consumePricePlaceholder': 'Enter consumption tariff rate',
                
                // Buttons
                'btn.cancel': 'Cancel',
                'btn.previous': 'Previous',
                'btn.next': 'Next',
                'btn.finish': 'Finish',
                'btn.addDevice': 'Add Device',
                'btn.add': 'Add',
                'btn.delete': 'Delete',
                
                // Modal
                'modal.createStation': 'Create Station',
                'modal.editStation': 'Edit Station',
                
                // Device related
                'form.deviceSN': 'Device SN',
                'form.deviceSNPlaceholder': 'Enter device SN',
                'form.deviceType': 'Device Type',
                'form.selectDeviceType': 'Select device type',
                'device.inverter': 'Inverter',
                'device.pv': 'Photovoltaic',
                'device.battery': 'Battery',
                'device.meter': 'Meter',
                'device.gateway': 'Gateway',
                'device.transformer': 'Transformer',
                'device.deviceList': 'Device List'
            }
        };

        // 当前语言
        let currentLang = localStorage.getItem('ess_language') || 'zh';

        // 翻译函数
        function t(key, params = {}) {
            let text = i18n[currentLang][key] || key;
            // 替换参数
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            return text;
        }

        // 应用语言
        function applyLanguage() {
            // 更新页面标题
            document.querySelector('.page-title').textContent = t('page.title');
            document.querySelector('.logo span').textContent = t('system.name');
            
            // 更新菜单
            const menuItems = document.querySelectorAll('.menu-item');
            const menuKeys = ['station', 'analysis', 'alarm', 'device', 'user', 'report', 'setting'];
            menuItems.forEach((item, index) => {
                if (menuKeys[index]) {
                    item.querySelector('span:last-child').textContent = t(`menu.${menuKeys[index]}`);
                }
            });
            
            
            // 更新搜索标签
            const searchLabels = document.querySelectorAll('.search-label');
            searchLabels.forEach((label, index) => {
                const labelKeys = ['search.region', 'search.organization', 'search.type', 'search.name', 'search.account'];
                if (labelKeys[index] && t(labelKeys[index])) {
                    label.textContent = t(labelKeys[index]);
                }
            });
            
            // 更新搜索输入框占位符
            const stationNameInput = document.getElementById('station-name-search');
            if (stationNameInput) {
                stationNameInput.placeholder = t('search.name.placeholder');
            }
            
            const userAccountInput = document.getElementById('user-account-search');
            if (userAccountInput) {
                userAccountInput.placeholder = t('search.account.placeholder');
            }
            
            // 更新按钮
            const searchButtons = document.querySelectorAll('.search-button span:last-child');
            searchButtons.forEach(btn => {
                btn.textContent = t('search.button');
            });
            
            // 更新筛选按钮
            const filterBtnText = document.querySelector('.filter-button span:last-child');
            if (filterBtnText) {
                filterBtnText.textContent = t('filter.button');
            }
            
            // 更新其他元素...
            document.getElementById('lang-text').textContent = currentLang === 'zh' ? '中文' : 'English';
            
            // 更新所有使用翻译的文本
            updateAllTranslations();
        }

        // 更新货币选择器选项
        function updateCurrencyOptions() {
            const currencyOptions = {
                'zh': {
                    'CNY': '人民币 (CNY)',
                    'USD': '美元 (USD)', 
                    'EUR': '欧元 (EUR)',
                    'GBP': '英镑 (GBP)',
                    'JPY': '日元 (JPY)',
                    'KRW': '韩元 (KRW)',
                    'CAD': '加拿大元 (CAD)',
                    'AUD': '澳大利亚元 (AUD)',
                    'CHF': '瑞士法郎 (CHF)',
                    'SGD': '新加坡元 (SGD)'
                },
                'en': {
                    'CNY': 'Chinese Yuan (CNY)',
                    'USD': 'US Dollar (USD)',
                    'EUR': 'Euro (EUR)', 
                    'GBP': 'British Pound (GBP)',
                    'JPY': 'Japanese Yen (JPY)',
                    'KRW': 'Korean Won (KRW)',
                    'CAD': 'Canadian Dollar (CAD)',
                    'AUD': 'Australian Dollar (AUD)',
                    'CHF': 'Swiss Franc (CHF)',
                    'SGD': 'Singapore Dollar (SGD)'
                }
            };
            
            // 更新新建模态框的货币选择器
            const currencySelect = document.getElementById('currency');
            if (currencySelect) {
                const selectedValue = currencySelect.value;
                currencySelect.innerHTML = '';
                Object.entries(currencyOptions[currentLang]).forEach(([code, name]) => {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = name;
                    if (code === selectedValue) option.selected = true;
                    currencySelect.appendChild(option);
                });
            }
            
            // 更新编辑模态框的货币选择器
            const editCurrencySelect = document.getElementById('edit-currency');
            if (editCurrencySelect) {
                const selectedValue = editCurrencySelect.value;
                editCurrencySelect.innerHTML = '';
                Object.entries(currencyOptions[currentLang]).forEach(([code, name]) => {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = name;
                    if (code === selectedValue) option.selected = true;
                    editCurrencySelect.appendChild(option);
                });
            }
        }

        // 更新所有翻译
        function updateAllTranslations() {
            // 更新所有带有i18n类的元素
            document.querySelectorAll('.i18n').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (key && i18n[currentLang][key]) {
                    element.textContent = i18n[currentLang][key];
                }
                
                // 处理placeholder
                const placeholderKey = element.getAttribute('data-i18n-placeholder');
                if (placeholderKey && i18n[currentLang][placeholderKey]) {
                    element.placeholder = i18n[currentLang][placeholderKey];
                }
                
                // 处理value
                const valueKey = element.getAttribute('data-i18n-value');
                if (valueKey && i18n[currentLang][valueKey]) {
                    element.value = i18n[currentLang][valueKey];
                }
            });
            
            // 更新站点状态
            document.querySelectorAll('.station-status').forEach(status => {
                const statusType = status.getAttribute('data-status');
                if (statusType) {
                    status.textContent = t(`station.status.${statusType}`);
                } else if (status.classList.contains('status-online')) {
                    status.textContent = t('station.status.online');
                } else if (status.classList.contains('status-offline')) {
                    status.textContent = t('station.status.offline');
                } else if (status.classList.contains('status-warning')) {
                    status.textContent = t('station.status.warning');
                }
            });
            
            // 更新标签页
            document.querySelector('#tab-all span:first-child').textContent = currentLang === 'zh' ? '全部' : 'All';
            document.querySelector('#tab-online span:first-child').textContent = t('station.status.online');
            document.querySelector('#tab-offline span:first-child').textContent = t('station.status.offline');
            document.querySelector('#tab-warning span:first-child').textContent = t('station.status.warning');
            
            // 更新搜索区域
            document.querySelector('.search-label').textContent = currentLang === 'zh' ? '电站名称：' : 'Station Name:';
            
            // 更新计数器显示（去掉英文模式下的"个"字）
            document.querySelectorAll('.i18n-count').forEach(element => {
                const count = element.getAttribute('data-count');
                if (currentLang === 'zh') {
                    element.textContent = count + '个';
                } else {
                    element.textContent = count;
                }
            });
            
            // 更新placeholder国际化
            document.querySelectorAll('.i18n-placeholder').forEach(element => {
                const placeholderZh = element.getAttribute('data-placeholder-zh');
                const placeholderEn = element.getAttribute('data-placeholder-en');
                if (currentLang === 'zh' && placeholderZh) {
                    element.placeholder = placeholderZh;
                } else if (currentLang === 'en' && placeholderEn) {
                    element.placeholder = placeholderEn;
                }
            });
            
            // 更新货币选择器
            updateCurrencyOptions();
            document.querySelector('#station-name-search').placeholder = currentLang === 'zh' ? '请输入电站名称' : 'Enter station name';
            document.querySelector('.search-button span:last-child').textContent = currentLang === 'zh' ? '搜索' : 'Search';
            document.querySelector('.reset-button span:last-child').textContent = currentLang === 'zh' ? '重置' : 'Reset';
            document.querySelector('.create-button span:last-child').textContent = currentLang === 'zh' ? '新建' : 'Create';
            
            // 更新分页信息
            const paginationInfo = document.querySelector('.pagination-info span');
            if (paginationInfo) {
                paginationInfo.textContent = currentLang === 'zh' ? '共 10 条记录' : 'Total 10 records';
            }
            
            const pageSizeText = document.querySelector('.page-size-select span:first-child');
            if (pageSizeText) {
                pageSizeText.textContent = currentLang === 'zh' ? '每页显示' : 'Show';
            }
            
            const pageSizeUnit = document.querySelector('.page-size-select span:last-child');
            if (pageSizeUnit) {
                pageSizeUnit.textContent = currentLang === 'zh' ? '条' : 'items per page';
            }
            
            // 更新操作按钮的title属性
            document.querySelectorAll('.table-action[title="编辑"]').forEach(btn => {
                btn.title = currentLang === 'zh' ? '编辑' : 'Edit';
            });
            
            document.querySelectorAll('.table-action[title="删除"]').forEach(btn => {
                btn.title = currentLang === 'zh' ? '删除' : 'Delete';
            });
            
            // 更新电站名称、地址和备注
            document.querySelectorAll('.i18n-station-name').forEach(element => {
                const zhText = element.getAttribute('data-name-zh');
                const enText = element.getAttribute('data-name-en');
                element.textContent = currentLang === 'zh' ? zhText : enText;
            });
            
            document.querySelectorAll('.i18n-address').forEach(element => {
                const zhText = element.getAttribute('data-address-zh');
                const enText = element.getAttribute('data-address-en');
                element.textContent = currentLang === 'zh' ? zhText : enText;
            });
            
            document.querySelectorAll('.i18n-remark').forEach(element => {
                const zhText = element.getAttribute('data-remark-zh');
                const enText = element.getAttribute('data-remark-en');
                element.textContent = currentLang === 'zh' ? zhText : enText;
            });
            
            // 更新导航栏
            const navButtons = document.querySelectorAll('.nav-button');
            navButtons.forEach(btn => {
                if (btn.textContent.includes('管理员') || btn.textContent.includes('Admin')) {
                    const span = btn.querySelector('span:last-child');
                    if (span) {
                        span.textContent = currentLang === 'zh' ? '管理员' : 'Admin';
                    }
                }
            });
            
            // 更新模态框标题和内容
            const modalTitles = {
                'filter-modal': currentLang === 'zh' ? '高级筛选' : 'Advanced Filter',
                'share-modal': currentLang === 'zh' ? '分享电站' : 'Share Station',
                'remark-modal': currentLang === 'zh' ? '编辑备注' : 'Edit Remark',
                'station-detail-modal': currentLang === 'zh' ? '电站详情' : 'Station Details',
                'create-station-modal': currentLang === 'zh' ? '新建电站' : 'Create Station'
            };
            
            Object.keys(modalTitles).forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal) {
                    const title = modal.querySelector('.modal-title');
                    if (title) {
                        title.textContent = modalTitles[modalId];
                    }
                }
            });
        }

        // 切换语言
        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            localStorage.setItem('ess_language', currentLang);
            applyLanguage();
        }

        // 切换主题
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'dark' ? '☀️' : '🌙';
            localStorage.setItem('ess_theme', newTheme);
        }


        // 设置视图模式
        function setViewMode(mode) {
            if (mode === 'card') {
                document.getElementById('card-view').classList.add('active');
                document.getElementById('list-view').classList.remove('active');
                document.getElementById('card-view-content').style.display = 'block';
                document.getElementById('list-view-content').style.display = 'none';
            } else {
                document.getElementById('card-view').classList.remove('active');
                document.getElementById('list-view').classList.add('active');
                document.getElementById('card-view-content').style.display = 'none';
                document.getElementById('list-view-content').style.display = 'block';
            }
            
            // 重新应用当前过滤器
            updateStationList(currentStationFilter);
        }

        // 切换查询类型
        
        
        // 搜索电站
        function searchStations() {
            const stationName = document.getElementById('station-name-search').value;
            
            console.log('查询条件：', { stationName });
            
            // 模拟查询结果
            let resultMessage = '查询结果：';
            let matchCount = Math.floor(Math.random() * 20) + 1;
            
            if (stationName.trim()) {
                resultMessage += `名称包含"${stationName}"的电站共 ${matchCount} 个`;
            } else {
                resultMessage += '显示所有电站（共 126 个）';
            }
            
            alert(resultMessage);
            // 这里可以添加实际的电站列表更新逻辑
        }
        
        // 重置搜索
        function resetSearch() {
            document.getElementById('station-name-search').value = '';
        }
        
        // 当前向导步骤
        let currentWizardStep = 1;
        
        // 新建电站
        function createStation() {
            const modal = document.getElementById('create-station-modal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // 初始化表单
            resetCreateStationForm();
            
            // 重置向导到第一步
            currentWizardStep = 1;
            updateWizardStep();
        }
        
        // 关闭新建电站弹窗
        function closeCreateStationModal() {
            const modal = document.getElementById('create-station-modal');
            modal.style.display = 'none';
            document.body.style.overflow = '';
        }
        
        // 更新向导步骤显示
        function updateWizardStep() {
            // 更新步骤指示器
            document.querySelectorAll('.wizard-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentWizardStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentWizardStep) {
                    step.classList.add('active');
                }
            });
            
            // 更新内容显示
            document.querySelectorAll('.wizard-content').forEach((content, index) => {
                content.classList.toggle('active', index + 1 === currentWizardStep);
            });
            
            // 更新按钮显示
            const prevBtn = document.getElementById('wizard-prev');
            const nextBtn = document.getElementById('wizard-next');
            const finishBtn = document.getElementById('wizard-finish');
            
            if (prevBtn) prevBtn.style.display = currentWizardStep > 1 ? 'block' : 'none';
            if (nextBtn) nextBtn.style.display = currentWizardStep < 3 ? 'block' : 'none';
            if (finishBtn) finishBtn.style.display = currentWizardStep === 3 ? 'block' : 'none';
        }
        
        // 上一步
        function prevWizardStep() {
            if (currentWizardStep > 1) {
                currentWizardStep--;
                updateWizardStep();
            }
        }
        
        // 下一步
        function nextWizardStep() {
            if (currentWizardStep < 3) {
                currentWizardStep++;
                updateWizardStep();
            }
        }
        
        // 验证向导步骤
        function validateWizardStep(step) {
            switch (step) {
                case 1:
                    // 验证基础信息
                    const stationName = document.getElementById('station-name').value.trim();
                    const address = document.getElementById('address').value.trim();
                    const timezone = document.getElementById('timezone').value;
                    
                    if (!stationName) {
                        alert('请输入电站名称');
                        document.getElementById('station-name').focus();
                        return false;
                    }
                    if (!address) {
                        alert('请输入地址');
                        document.getElementById('address').focus();
                        return false;
                    }
                    if (!timezone) {
                        alert('请选择时区');
                        document.getElementById('timezone').focus();
                        return false;
                    }
                    
                    return true;
                    
                case 2:
                    // 验证设备信息（可选）
                    return true;
                    
                case 3:
                    // 验证电价信息（可选）
                    return true;
                    
                default:
                    return true;
            }
        }
        
        // 重置表单
        function resetCreateStationForm() {
            // 清空所有输入字段
            document.getElementById('station-name').value = '';
            document.getElementById('station-type').value = '工商储'; // 默认值
            document.getElementById('installed-power').value = '';
            document.getElementById('grid-date').value = '';
            document.getElementById('address').value = '';
            document.getElementById('timezone').value = 'UTC+8'; // 默认北京时间
            document.getElementById('currency').value = 'CNY';
            document.getElementById('feed-price').value = '';
            document.getElementById('consume-price').value = '';
            
            // 重置单选框
            document.getElementById('feed-fixed').checked = true;
            document.getElementById('consume-fixed').checked = true;
            
            // 隐藏条件字段
            document.getElementById('energy-solution-group').style.display = 'none';
            document.getElementById('nmi-group').style.display = 'none';
            
            // 清空图片预览
            const imagePreview = document.getElementById('image-preview');
            imagePreview.style.display = 'none';
            
            // 清空设备列表
            document.getElementById('device-list').innerHTML = '';
            
            // 重置设备输入
            document.getElementById('device-type').value = '';
            
            // 重置设备计数器
            deviceCounter = 0;
        }
        
        // 更新时区
        function updateTimezone() {
            const country = document.getElementById('country').value;
            const timezoneSelect = document.getElementById('timezone');
            const energySolutionGroup = document.getElementById('energy-solution-group');
            const nmiGroup = document.getElementById('nmi-group');
            
            // 清空时区选项
            timezoneSelect.innerHTML = '<option value="">请选择时区</option>';
            
            // 根据国家设置时区选项
            const timezones = {
                'CN': [
                    { value: 'UTC+8', text: 'UTC+8 (北京时间)' }
                ],
                'US': [
                    { value: 'UTC-5', text: 'UTC-5 (东部时间)' },
                    { value: 'UTC-6', text: 'UTC-6 (中部时间)' },
                    { value: 'UTC-7', text: 'UTC-7 (山地时间)' },
                    { value: 'UTC-8', text: 'UTC-8 (太平洋时间)' }
                ],
                'AU': [
                    { value: 'UTC+10', text: 'UTC+10 (悉尼时间)' },
                    { value: 'UTC+9:30', text: 'UTC+9:30 (阿德莱德时间)' },
                    { value: 'UTC+8', text: 'UTC+8 (珀斯时间)' }
                ],
                'DE': [
                    { value: 'UTC+1', text: 'UTC+1 (中欧时间)' }
                ],
                'JP': [
                    { value: 'UTC+9', text: 'UTC+9 (日本时间)' }
                ]
            };
            
            if (timezones[country]) {
                timezones[country].forEach(tz => {
                    const option = document.createElement('option');
                    option.value = tz.value;
                    option.textContent = tz.text;
                    timezoneSelect.appendChild(option);
                });
                
                // 默认选择第一个时区
                if (timezones[country].length > 0) {
                    timezoneSelect.value = timezones[country][0].value;
                }
            }
            
            // 显示/隐藏NMI字段（澳大利亚特有）
            if (country === 'AU') {
                nmiGroup.style.display = 'block';
            } else {
                nmiGroup.style.display = 'none';
            }
        }
        
        // 监听电站类型变化
        document.addEventListener('DOMContentLoaded', function() {
            const stationTypeSelect = document.getElementById('station-type');
            if (stationTypeSelect) {
                stationTypeSelect.addEventListener('change', function() {
                    const energySolutionGroup = document.getElementById('energy-solution-group');
                    if (this.value === 'microgrid') {
                        energySolutionGroup.style.display = 'block';
                    } else {
                        energySolutionGroup.style.display = 'none';
                    }
                });
            }
            
            // 初始化分页
            updatePagination();
        });
        
        // 地图相关变量
        let map = null;
        let selectedLocation = null;
        let marker = null;
        
        // 打开地图弹窗
        function openMapModal() {
            const modal = document.getElementById('map-modal');
            modal.style.display = 'flex';
            
            // 初始化地图（这里使用模拟实现）
            if (!map) {
                initMap();
            }
        }
        
        // 关闭地图弹窗
        function closeMapModal() {
            const modal = document.getElementById('map-modal');
            modal.style.display = 'none';
        }
        
        // 初始化地图（模拟实现）
        function initMap() {
            const mapContainer = document.getElementById('map');
            map = true; // 标记已初始化
            
            // 创建模拟地图界面
            mapContainer.innerHTML = `
                <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: #e5e7eb;">
                    <div style="text-align: center; padding: 2rem;">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" style="margin: 0 auto;">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        <p style="margin-top: 1rem; color: #6b7280;">点击地图选择位置</p>
                        <p style="margin-top: 0.5rem; color: #9ca3af; font-size: 0.875rem;">（演示模式：实际应用中将集成地图API）</p>
                    </div>
                </div>
            `;
            
            // 添加点击事件（模拟）
            mapContainer.addEventListener('click', function(e) {
                // 模拟选择位置
                const mockLocations = [
                    { lat: 31.2304, lng: 121.4737, address: '上海市浦东新区张江高科技园区' },
                    { lat: 39.9042, lng: 116.4074, address: '北京市海淀区中关村科技园' },
                    { lat: 22.5431, lng: 114.0579, address: '深圳市南山区科技园南路' },
                    { lat: 23.1291, lng: 113.2644, address: '广州市天河区科韵路' }
                ];
                
                const randomLocation = mockLocations[Math.floor(Math.random() * mockLocations.length)];
                placeMarker(randomLocation);
            });
        }
        
        // 放置标记（模拟）
        function placeMarker(location) {
            selectedLocation = location;
            
            // 更新坐标显示
            document.getElementById('selected-coords').textContent = 
                `经纬度：${location.lng.toFixed(6)}, ${location.lat.toFixed(6)}`;
            
            // 更新地图显示（模拟）
            const mapContainer = document.getElementById('map');
            mapContainer.innerHTML = `
                <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: #e5e7eb; position: relative;">
                    <div style="text-align: center;">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="#ef4444" stroke="none">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        <p style="margin-top: 1rem; color: #374151; font-weight: 500;">${location.address}</p>
                        <p style="margin-top: 0.5rem; color: #6b7280; font-size: 0.875rem;">已选择位置</p>
                    </div>
                </div>
            `;
        }
        
        // 搜索位置（模拟）
        function searchLocation() {
            const keyword = document.getElementById('map-search').value.trim();
            if (!keyword) return;
            
            // 模拟搜索结果
            const searchResults = {
                '上海': { lat: 31.2304, lng: 121.4737, address: '上海市浦东新区张江高科技园区' },
                '北京': { lat: 39.9042, lng: 116.4074, address: '北京市海淀区中关村科技园' },
                '深圳': { lat: 22.5431, lng: 114.0579, address: '深圳市南山区科技园南路' },
                '广州': { lat: 23.1291, lng: 113.2644, address: '广州市天河区科韵路' },
                '张江': { lat: 31.2304, lng: 121.4737, address: '上海市浦东新区张江高科技园区' },
                '中关村': { lat: 39.9042, lng: 116.4074, address: '北京市海淀区中关村科技园' }
            };
            
            // 简单的关键词匹配
            for (const key in searchResults) {
                if (keyword.includes(key) || key.includes(keyword)) {
                    placeMarker(searchResults[key]);
                    return;
                }
            }
            
            alert('未找到相关地点，请尝试搜索：上海、北京、深圳、广州、张江、中关村');
        }
        
        // 确认选择位置
        function confirmLocation() {
            if (!selectedLocation) {
                alert('请先在地图上选择一个位置');
                return;
            }
            
            // 填充地址到输入框
            document.getElementById('address').value = selectedLocation.address;
            
            // 关闭弹窗
            closeMapModal();
        }
        
        // 处理图片上传
        function handleImageUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImg = document.getElementById('preview-img');
                    const imagePreview = document.getElementById('image-preview');
                    previewImg.src = e.target.result;
                    imagePreview.style.display = 'block';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
        
        // 添加设备
        let deviceCounter = 0;
        function addDevice() {
            deviceCounter++;
            const deviceList = document.getElementById('device-list');
            const deviceItem = document.createElement('div');
            deviceItem.style.cssText = 'display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;';
            deviceItem.setAttribute('data-device-id', deviceCounter);
            
            deviceItem.innerHTML = `
                <input type="text" class="form-input" placeholder="${currentLang === 'zh' ? '请输入设备SN' : 'Enter device SN'}" style="flex: 1;">
                <select class="form-select" style="flex: 1;">
                    <option value="">${currentLang === 'zh' ? '请选择设备类型' : 'Please select device type'}</option>
                    <option value="inverter">${currentLang === 'zh' ? '逆变器' : 'Inverter'}</option>
                    <option value="pv">${currentLang === 'zh' ? '光伏' : 'PV'}</option>
                    <option value="battery">${currentLang === 'zh' ? '电池' : 'Battery'}</option>
                    <option value="storage">${currentLang === 'zh' ? '储能系统' : 'Storage System'}</option>
                    <option value="monitor">${currentLang === 'zh' ? '监控设备' : 'Monitor Device'}</option>
                </select>
                <button type="button" onclick="removeDevice(this)" style="background: none; border: none; color: #6b7280; cursor: pointer; padding: 0.5rem; font-size: 1rem;">
                    <span class="i18n" data-i18n="btn.delete">${currentLang === 'zh' ? '删除' : 'Delete'}</span>
                </button>
            `;
            deviceList.appendChild(deviceItem);
        }
        
        // 删除设备
        function removeDevice(button) {
            button.parentElement.remove();
        }
        
        // 获取设备类型名称
        function getDeviceTypeName(type) {
            const types = {
                zh: {
                    'inverter': '逆变器',
                    'pv': '光伏',
                    'battery': '电池',
                    'meter': '电表',
                    'gateway': '网关',
                    'transformer': '变压器'
                },
                en: {
                    'inverter': 'Inverter',
                    'pv': 'Photovoltaic',
                    'battery': 'Battery',
                    'meter': 'Meter',
                    'gateway': 'Gateway',
                    'transformer': 'Transformer'
                }
            };
            return types[currentLang][type] || type;
        }
        
        // 处理二维码上传
        function handleQRUpload(input) {
            if (input.files && input.files[0]) {
                // 这里可以调用二维码识别API
                // 为了演示，我们模拟识别结果
                setTimeout(() => {
                    // 模拟识别设备类型
                    const deviceTypes = ['inverter', 'battery', 'meter', 'gateway'];
                    const randomType = deviceTypes[Math.floor(Math.random() * deviceTypes.length)];
                    document.getElementById('device-type').value = randomType;
                    alert('二维码识别成功，识别到设备类型：' + getDeviceTypeName(randomType));
                }, 1000);
            }
        }
        
        // 完成创建电站
        function finishCreateStation() {
            submitCreateStation();
        }
        
        // 提交创建电站
        function submitCreateStation() {
            // 最终验证
            if (!validateWizardStep(1)) {
                currentWizardStep = 1;
                updateWizardStep();
                return;
            }
            
            // 如果电站类型是微网，验证储能方案
            const stationType = document.getElementById('station-type').value;
            if (stationType === 'microgrid') {
                const energySolution = document.getElementById('energy-solution').value;
                if (!energySolution) {
                    alert('请选择储能方案');
                    document.getElementById('energy-solution').focus();
                    return;
                }
            }
            
            // 验证手机号格式
            const phone = document.getElementById('owner-phone').value;
            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(phone)) {
                alert('请输入正确的手机号格式');
                document.getElementById('owner-phone').focus();
                return;
            }
            
            // 收集表单数据
            const formData = {
                // 基础信息
                stationName: document.getElementById('station-name').value,
                stationType: '工商储', // 固定值
                gridDate: document.getElementById('grid-date').value || '',
                installedPower: document.getElementById('installed-power').value || '',
                address: document.getElementById('address').value,
                timezone: document.getElementById('timezone').value,
                
                // 设备信息
                devices: [],
                
                // 电价信息
                currency: document.getElementById('currency').value || 'CNY',
                feedPriceType: document.querySelector('input[name="feed-price-type"]:checked')?.value || 'fixed',
                feedPrice: document.getElementById('feed-price').value || '',
                consumePriceType: document.querySelector('input[name="consume-price-type"]:checked')?.value || 'fixed',
                consumePrice: document.getElementById('consume-price').value || ''
            };
            
            // 收集设备信息
            const deviceItems = document.querySelectorAll('#device-list > div');
            deviceItems.forEach(item => {
                const text = item.textContent;
                // 解析设备信息...
            });
            
            console.log('电站创建数据：', formData);
            
            // 模拟提交
            alert('电站创建成功！\n\n电站名称：' + formData.stationName + '\n电站类型：工商储\n地址：' + formData.address + '\n时区：' + formData.timezone);
            
            // 关闭弹窗
            closeCreateStationModal();
        }
        
        // 获取电站类型名称
        function getStationTypeName(type) {
            const types = {
                'commercial': '工商储',
                'residential': '家庭储',
                'charging': '充电站',
                'microgrid': '微网'
            };
            return types[type] || type;
        }
        
        // 切换电站Tab
        let currentStationFilter = 'all';
        function switchStationTab(filter) {
            currentStationFilter = filter;
            
            // 更新Tab状态
            document.querySelectorAll('.station-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`tab-${filter}`).classList.add('active');
            
            // 重置到第一页
            currentPage = 1;
            
            // 更新总数
            totalItems = getFilteredCount();
            totalPages = Math.ceil(totalItems / pageSize);
            
            // 更新分页
            updatePagination();
            
            // 更新电站列表
            updateStationList(filter);
        }
        
        // 更新电站列表
        function updateStationList(filter) {
            // 获取所有电站卡片
            const stationCards = document.querySelectorAll('.station-card');
            let visibleCount = 0;
            
            stationCards.forEach(card => {
                const status = card.querySelector('.status-badge').textContent.trim();
                let shouldShow = false;
                
                switch(filter) {
                    case 'all':
                        shouldShow = true;
                        break;
                    case 'online':
                        shouldShow = status === '在线' || status === 'Online';
                        break;
                    case 'offline':
                        shouldShow = status === '离线' || status === 'Offline';
                        break;
                    case 'warning':
                        shouldShow = status === '告警' || status === 'Warning';
                        break;
                }
                
                if (shouldShow) {
                    visibleCount++;
                    // 根据分页显示
                    const startIndex = (currentPage - 1) * pageSize + 1;
                    const endIndex = currentPage * pageSize;
                    card.style.display = (visibleCount >= startIndex && visibleCount <= endIndex) ? '' : 'none';
                } else {
                    card.style.display = 'none';
                }
            });
            
            // 如果是列表视图，也需要更新
            if (document.getElementById('list-view-content').style.display !== 'none') {
                const tableRows = document.querySelectorAll('.station-table tbody tr');
                let tableVisibleCount = 0;
                
                tableRows.forEach(row => {
                    const statusCell = row.querySelector('.station-status');
                    if (statusCell) {
                        const status = statusCell.textContent.trim();
                        let shouldShow = false;
                        
                        switch(filter) {
                            case 'all':
                                shouldShow = true;
                                break;
                            case 'online':
                                shouldShow = status === '在线' || status === 'Online';
                                break;
                            case 'offline':
                                shouldShow = status === '离线' || status === 'Offline';
                                break;
                            case 'warning':
                                shouldShow = status === '告警' || status === 'Warning';
                                break;
                        }
                        
                        if (shouldShow) {
                            tableVisibleCount++;
                            // 根据分页显示
                            const startIndex = (currentPage - 1) * pageSize + 1;
                            const endIndex = currentPage * pageSize;
                            row.style.display = (tableVisibleCount >= startIndex && tableVisibleCount <= endIndex) ? '' : 'none';
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
            }
        }

        // 分页功能
        let currentPage = 1;
        let pageSize = 20;
        let totalItems = 10; // 初始化为实际总数
        let totalPages = Math.ceil(totalItems / pageSize);
        
        // 改变页码
        function changePage(page) {
            if (page < 1 || page > totalPages || page === currentPage) return;
            
            currentPage = page;
            updatePagination();
            updateStationList(currentStationFilter);
        }
        
        // 改变每页显示数量
        function changePageSize(size) {
            pageSize = parseInt(size);
            totalPages = Math.ceil(totalItems / pageSize);
            currentPage = 1;
            updatePagination();
            updateStationList(currentStationFilter);
        }
        
        // 更新分页显示
        function updatePagination() {
            const paginationContainer = document.querySelector('.pagination');
            if (!paginationContainer) return;
            
            let html = '';
            
            // 首页和上一页
            html += `<button class="page-btn" onclick="changePage(1)" ${currentPage === 1 ? 'disabled' : ''}><span>«</span></button>`;
            html += `<button class="page-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}><span>‹</span></button>`;
            
            // 页码逻辑
            let startPage = 1;
            let endPage = totalPages;
            
            if (totalPages > 7) {
                if (currentPage <= 4) {
                    endPage = 5;
                } else if (currentPage >= totalPages - 3) {
                    startPage = totalPages - 4;
                } else {
                    startPage = currentPage - 2;
                    endPage = currentPage + 2;
                }
            }
            
            // 显示页码
            if (startPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">1</button>`;
                if (startPage > 2) {
                    html += `<span style="padding: 0 0.5rem; color: #6b7280;">...</span>`;
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    html += `<span style="padding: 0 0.5rem; color: #6b7280;">...</span>`;
                }
                html += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }
            
            // 下一页和末页
            html += `<button class="page-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}><span>›</span></button>`;
            html += `<button class="page-btn" onclick="changePage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}><span>»</span></button>`;
            
            paginationContainer.innerHTML = html;
            
            // 更新记录信息
            const infoElement = document.querySelector('.pagination-info span');
            if (infoElement) {
                const filteredCount = getFilteredCount();
                infoElement.textContent = `共 ${filteredCount} 条记录`;
            }
        }
        
        // 获取过滤后的记录数
        function getFilteredCount() {
            // 根据当前过滤状态返回不同的数量
            const counts = {
                'all': 10,
                'online': 7,
                'offline': 2,
                'warning': 1
            };
            return counts[currentStationFilter] || 10;
        }
        
        // 切换关注状态
        function toggleFavorite(event, stationId) {
            event.stopPropagation();
            const button = event.currentTarget;
            button.classList.toggle('active');
            
            if (button.classList.contains('active')) {
                button.querySelector('span:last-child').textContent = t('action.favorited');
            } else {
                button.querySelector('span:last-child').textContent = t('action.favorite');
            }
            
            console.log(`切换关注状态：${stationId}`);
        }

        // 分享电站
        function shareStation(event, stationId) {
            event.stopPropagation();
            document.getElementById('share-modal').style.display = 'flex';
            window.currentStationId = stationId;
        }

        // 编辑备注
        function editRemark(event, stationId) {
            event.stopPropagation();
            document.getElementById('remark-modal').style.display = 'flex';
            window.currentStationId = stationId;
        }

        // 删除电站
        // 编辑电站
        function editStation(event, stationId) {
            event.stopPropagation();
            // 设置当前编辑的电站ID
            window.currentEditStationId = stationId;
            // 打开编辑电站弹窗
            document.getElementById('edit-station-modal').style.display = 'flex';
            // 重置向导步骤
            currentWizardStep = 1;
            updateEditWizardStep();
            // 加载电站数据到表单中
            loadStationData(stationId);
        }
        
        // 关闭编辑电站弹窗
        function closeEditStationModal() {
            document.getElementById('edit-station-modal').style.display = 'none';
            // 重置表单
            document.getElementById('edit-station-form').reset();
        }
        
        // 加载电站数据到编辑表单
        function loadStationData(stationId) {
            // 这里根据stationId加载对应的电站数据
            // 示例数据，实际应该从服务器获取
            const stationData = {
                'ST001': {
                    name: '上海浦东新区张江高科技园区',
                    address: '上海市浦东新区张江高科技园区',
                    installedPower: '500',
                    gridDate: '2023-01-15'
                }
            };
            
            const data = stationData[stationId] || {};
            document.getElementById('edit-station-name').value = data.name || '';
            document.getElementById('edit-address').value = data.address || '';
            document.getElementById('edit-installed-power').value = data.installedPower || '';
            document.getElementById('edit-grid-date').value = data.gridDate || '';
        }
        
        // 更新编辑向导步骤
        function updateEditWizardStep() {
            // 更新步骤指示器
            document.querySelectorAll('#edit-station-modal .wizard-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentWizardStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentWizardStep) {
                    step.classList.add('active');
                }
            });
            
            // 更新内容显示
            document.querySelectorAll('#edit-station-modal .wizard-content').forEach((content, index) => {
                content.classList.toggle('active', index + 1 === currentWizardStep);
            });
            
            // 更新按钮显示
            const prevBtn = document.getElementById('edit-wizard-prev');
            const nextBtn = document.getElementById('edit-wizard-next');
            const finishBtn = document.getElementById('edit-wizard-finish');
            
            if (prevBtn) prevBtn.style.display = currentWizardStep > 1 ? 'inline-flex' : 'none';
            if (nextBtn) nextBtn.style.display = currentWizardStep < 3 ? 'inline-flex' : 'none';
            if (finishBtn) finishBtn.style.display = currentWizardStep === 3 ? 'inline-flex' : 'none';
        }
        
        // 编辑向导下一步
        function nextEditWizardStep() {
            if (currentWizardStep < 3) {
                currentWizardStep++;
                updateEditWizardStep();
            }
        }
        
        // 编辑向导上一步
        function prevEditWizardStep() {
            if (currentWizardStep > 1) {
                currentWizardStep--;
                updateEditWizardStep();
            }
        }
        
        // 完成编辑电站
        function finishEditStation() {
            alert(`编辑电站 ${window.currentEditStationId} 完成`);
            closeEditStationModal();
        }
        
        // 编辑模式添加设备
        let editDeviceCounter = 0;
        function addEditDevice() {
            editDeviceCounter++;
            const deviceList = document.getElementById('edit-device-list');
            const deviceItem = document.createElement('div');
            deviceItem.style.cssText = 'display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;';
            deviceItem.setAttribute('data-device-id', editDeviceCounter);
            
            deviceItem.innerHTML = `
                <input type="text" class="form-input" placeholder="${currentLang === 'zh' ? '请输入设备SN' : 'Enter device SN'}" style="flex: 1;">
                <select class="form-select" style="flex: 1;">
                    <option value="">${currentLang === 'zh' ? '请选择设备类型' : 'Please select device type'}</option>
                    <option value="inverter">${currentLang === 'zh' ? '逆变器' : 'Inverter'}</option>
                    <option value="pv">${currentLang === 'zh' ? '光伏' : 'PV'}</option>
                    <option value="battery">${currentLang === 'zh' ? '电池' : 'Battery'}</option>
                    <option value="storage">${currentLang === 'zh' ? '储能系统' : 'Storage System'}</option>
                    <option value="monitor">${currentLang === 'zh' ? '监控设备' : 'Monitor Device'}</option>
                </select>
                <button type="button" onclick="removeEditDevice(this)" style="background: none; border: none; color: #6b7280; cursor: pointer; padding: 0.5rem; font-size: 1rem;">
                    <span class="i18n" data-i18n="btn.delete">${currentLang === 'zh' ? '删除' : 'Delete'}</span>
                </button>
            `;
            deviceList.appendChild(deviceItem);
        }
        
        // 删除编辑设备
        function removeEditDevice(button) {
            button.parentElement.remove();
        }
        
        // 删除电站
        function deleteStation(event, stationId) {
            event.stopPropagation();
            if (confirm(t('confirm.delete'))) {
                console.log(`删除电站：${stationId}`);
                alert(t('success.delete'));
            }
        }

        // 查看电站详情
        function viewStationDetail(stationId) {
            console.log(`查看电站详情：${stationId}`);
            // 这里可以跳转到详情页面
        }

        // 切换页面
        function changePage(direction) {
            console.log(`切换页面：${direction}`);
        }
        
        // 返回场景选择页面
        function goBack() {
            window.location.href = '../scenario-selection.html';
        }
        
        // 进入监控页面
        function goToStationMonitoring() {
            // 获取当前选中的电站ID
            const stationId = document.getElementById('detail-sn').textContent;
            const stationName = document.getElementById('detail-name').textContent;
            // 跳转到监控页面
            window.location.href = `./station-monitoring.html?station=${stationId}&name=${encodeURIComponent(stationName)}`;
        }

        // 显示筛选弹窗
        function toggleFilterModal() {
            document.getElementById('filter-modal').style.display = 'flex';
        }

        // 关闭筛选弹窗
        function closeFilterModal() {
            document.getElementById('filter-modal').style.display = 'none';
        }

        // 应用筛选
        function applyFilter() {
            const minHours = document.getElementById('min-hours').value;
            const maxHours = document.getElementById('max-hours').value;
            const deviceType = document.getElementById('device-type').value;
            
            console.log('筛选条件：', { minHours, maxHours, deviceType });
            closeFilterModal();
        }

        // 关闭分享弹窗
        function closeShareModal() {
            document.getElementById('share-modal').style.display = 'none';
        }

        // 确认分享
        function confirmShare() {
            const phone = document.getElementById('share-phone').value;
            const permission = document.getElementById('share-permission').value;
            
            console.log('分享信息：', { 
                stationId: window.currentStationId, 
                phone, 
                permission 
            });
            
            alert(t('success.share'));
            closeShareModal();
        }

        // 关闭备注弹窗
        function closeRemarkModal() {
            document.getElementById('remark-modal').style.display = 'none';
        }

        // 保存备注
        function saveRemark() {
            const remark = document.getElementById('remark-text').value;
            
            console.log('保存备注：', {
                stationId: window.currentStationId,
                remark
            });
            
            alert(t('success.remark'));
            closeRemarkModal();
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 应用保存的主题
            const savedTheme = localStorage.getItem('ess_theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'dark' ? '☀️' : '🌙';
            
            // 应用语言
            applyLanguage();
            
            // 点击模态框背景关闭全屏
            document.getElementById('fullscreen-modal').addEventListener('click', function(e) {
                if (e.target === this || e.target.classList.contains('fullscreen-content')) {
                    closeFullscreenImage();
                }
            });
            
            // 地图搜索框回车事件
            const mapSearchInput = document.getElementById('map-search');
            if (mapSearchInput) {
                mapSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchLocation();
                    }
                });
            }
            
            // ESC键关闭全屏
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('fullscreen-modal').style.display === 'flex') {
                    closeFullscreenImage();
                }
            });
        });

        // 点击弹窗外部关闭
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
        
        // 全屏图片相关变量
        let currentScale = 1;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let translateX = 0;
        let translateY = 0;
        
        // 打开全屏图片
        function openFullscreenImage() {
            const img = document.getElementById('topology-image');
            const fullscreenImg = document.getElementById('fullscreen-image');
            const modal = document.getElementById('fullscreen-modal');
            
            fullscreenImg.src = img.src;
            fullscreenImg.alt = img.alt;
            modal.style.display = 'flex';
            
            // 重置缩放和位置
            currentScale = 1;
            translateX = 0;
            translateY = 0;
            updateImageTransform();
            
            // 添加拖动事件
            fullscreenImg.addEventListener('mousedown', handleMouseDown);
            fullscreenImg.addEventListener('mousemove', handleMouseMove);
            fullscreenImg.addEventListener('mouseup', handleMouseUp);
            fullscreenImg.addEventListener('mouseleave', handleMouseUp);
            
            // 添加触摸事件（移动端）
            fullscreenImg.addEventListener('touchstart', handleTouchStart);
            fullscreenImg.addEventListener('touchmove', handleTouchMove);
            fullscreenImg.addEventListener('touchend', handleTouchEnd);
            
            // 添加鼠标滚轮缩放
            modal.addEventListener('wheel', handleWheel);
            
            // 阻止背景滚动
            document.body.style.overflow = 'hidden';
        }
        
        // 关闭全屏图片
        function closeFullscreenImage() {
            const modal = document.getElementById('fullscreen-modal');
            const fullscreenImg = document.getElementById('fullscreen-image');
            
            // 移除事件监听
            fullscreenImg.removeEventListener('mousedown', handleMouseDown);
            fullscreenImg.removeEventListener('mousemove', handleMouseMove);
            fullscreenImg.removeEventListener('mouseup', handleMouseUp);
            fullscreenImg.removeEventListener('mouseleave', handleMouseUp);
            fullscreenImg.removeEventListener('touchstart', handleTouchStart);
            fullscreenImg.removeEventListener('touchmove', handleTouchMove);
            fullscreenImg.removeEventListener('touchend', handleTouchEnd);
            modal.removeEventListener('wheel', handleWheel);
            
            modal.style.display = 'none';
            document.body.style.overflow = '';
        }
        
        // 更新图片变换
        function updateImageTransform() {
            const img = document.getElementById('fullscreen-image');
            img.style.transform = `translate(${translateX}px, ${translateY}px) scale(${currentScale})`;
            document.getElementById('zoom-info').textContent = Math.round(currentScale * 100) + '%';
        }
        
        // 放大
        function zoomIn() {
            currentScale = Math.min(currentScale * 1.2, 5);
            updateImageTransform();
        }
        
        // 缩小
        function zoomOut() {
            currentScale = Math.max(currentScale / 1.2, 0.5);
            updateImageTransform();
        }
        
        // 重置缩放
        function resetZoom() {
            currentScale = 1;
            translateX = 0;
            translateY = 0;
            updateImageTransform();
        }
        
        // 鼠标按下
        function handleMouseDown(e) {
            isDragging = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            e.target.classList.add('grabbing');
        }
        
        // 鼠标移动
        function handleMouseMove(e) {
            if (!isDragging) return;
            e.preventDefault();
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            updateImageTransform();
        }
        
        // 鼠标抬起
        function handleMouseUp(e) {
            isDragging = false;
            e.target.classList.remove('grabbing');
        }
        
        // 触摸开始
        function handleTouchStart(e) {
            if (e.touches.length === 1) {
                isDragging = true;
                startX = e.touches[0].clientX - translateX;
                startY = e.touches[0].clientY - translateY;
            }
        }
        
        // 触摸移动
        function handleTouchMove(e) {
            if (!isDragging || e.touches.length !== 1) return;
            e.preventDefault();
            translateX = e.touches[0].clientX - startX;
            translateY = e.touches[0].clientY - startY;
            updateImageTransform();
        }
        
        // 触摸结束
        function handleTouchEnd(e) {
            isDragging = false;
        }
        
        // 鼠标滚轮缩放
        function handleWheel(e) {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            currentScale = Math.min(Math.max(currentScale * delta, 0.5), 5);
            updateImageTransform();
        }
        
        // 更新详情弹窗的文本
        function updateDetailModalTexts() {
            const lang = localStorage.getItem('ess_language') || 'zh';
            
            // 更新标题和标签
            document.querySelectorAll('.section-title').forEach((el, index) => {
                if (index === 0) el.textContent = i18n[lang]['detail.basicInfo'];
                else if (index === 1) el.textContent = i18n[lang]['detail.systemTopology'];
                else if (index === 2) el.textContent = i18n[lang]['detail.realtimeData'];
                else if (index === 3) el.textContent = i18n[lang]['detail.deviceStatus'];
            });
            
            // 更新信息标签
            const infoLabels = document.querySelectorAll('.info-item .info-label');
            const labelKeys = ['detail.stationName', 'detail.deviceSN', 'detail.installedPower', 'detail.runningStatus', 'detail.commissionDate', 'detail.address'];
            infoLabels.forEach((el, index) => {
                if (labelKeys[index]) {
                    el.textContent = i18n[lang][labelKeys[index]];
                }
            });
            
            // 更新指标标签
            const metricLabels = document.querySelectorAll('.metric-label');
            const metricKeys = ['detail.realtimePower', 'detail.todayGeneration', 'detail.totalGeneration', 'detail.runningTime'];
            metricLabels.forEach((el, index) => {
                if (metricKeys[index]) {
                    el.textContent = i18n[lang][metricKeys[index]];
                }
            });
            
            // 更新设备名称
            const deviceNames = document.querySelectorAll('.device-name');
            const deviceKeys = ['detail.inverter', 'detail.batteryPack', 'detail.bmsSystem', 'detail.monitoringSystem'];
            deviceNames.forEach((el, index) => {
                if (deviceKeys[index]) {
                    el.textContent = i18n[lang][deviceKeys[index]];
                }
            });
            
            // 更新设备状态
            document.querySelectorAll('.device-status').forEach(el => {
                if (el.classList.contains('status-online')) {
                    el.textContent = i18n[lang]['detail.normal'];
                }
            });
            
            // 更新按钮文本
            const modalFooter = document.querySelector('#station-detail-modal .modal-footer');
            if (modalFooter) {
                const buttons = modalFooter.querySelectorAll('button');
                if (buttons[0]) buttons[0].textContent = i18n[lang]['detail.enterMonitoring'];
                if (buttons[1]) buttons[1].textContent = i18n[lang]['detail.close'];
            }
        }

        // 标准菜单功能
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            // 在移动端使用open类，在桌面端使用collapsed类
            if (window.innerWidth <= 1024) {
                sidebar.classList.toggle('open');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const icon = document.getElementById('headerThemeIcon');
            if (icon) {
                icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        }

        function toggleLanguage() {
            // 语言切换功能预留
            console.log('Toggle language');
        }

        function logout() {
            if (confirm('确定要退出登录吗？')) {
                window.location.href = 'login.html';
            }
        }

        // 初始化主题
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            const icon = document.getElementById('headerThemeIcon');
            if (icon) {
                icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        });
    </script>

    <!-- 新建电站弹窗 -->
    <div id="create-station-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title i18n" data-i18n="modal.createStation">新建电站</h2>
                <button class="modal-close" onclick="closeCreateStationModal()">&times;</button>
            </div>
            
            <!-- 步骤指示器 -->
            <div class="wizard-steps">
                <div class="wizard-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title i18n" data-i18n="wizard.step1">基础信息</div>
                </div>
                <div class="wizard-step" data-step="2" style="margin-left: 210px;">
                    <div class="step-number">2</div>
                    <div class="step-title i18n" data-i18n="wizard.step2">添加设备</div>
                </div>
                <div class="wizard-step" data-step="3" style="margin-left: 230px;">
                    <div class="step-number">3</div>
                    <div class="step-title i18n" data-i18n="wizard.step3">电价设置</div>
                </div>
            </div>
            
            <div class="modal-body">
                <!-- 步骤1：基础信息 -->
                <div class="wizard-content active" id="wizard-step-1">
                    <div class="form-section">
                        <h3 class="section-title i18n" data-i18n="wizard.basicInfo">基础信息</h3>
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <!-- 第一排 -->
                            <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div class="form-group">
                                    <label class="form-label required i18n" data-i18n="form.stationName">电站名称</label>
                                    <input type="text" class="form-input i18n" id="station-name" placeholder="请输入电站名称" data-i18n-placeholder="form.stationNamePlaceholder">
                                </div>
                                <div class="form-group">
                                    <label class="form-label i18n" data-i18n="form.stationType">电站类型</label>
                                    <input type="text" class="form-input i18n" id="station-type" value="工商储" data-i18n-value="form.commercialStorage" readonly style="background: #f3f4f6; cursor: not-allowed;">
                                </div>
                            </div>
                            
                            <!-- 第二排 -->
                            <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div class="form-group">
                                    <label class="form-label required i18n" data-i18n="form.address">地址</label>
                                    <div style="position: relative;">
                                        <input type="text" class="form-input i18n" id="address" placeholder="请输入详细地址" data-i18n-placeholder="form.addressPlaceholder" style="padding-right: 2.5rem;">
                                        <button type="button" class="location-btn" onclick="openMapModal()" title="选择地图位置">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                                <circle cx="12" cy="10" r="3"></circle>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label required i18n" data-i18n="form.timezone">时区</label>
                                    <select class="form-select" id="timezone">
                                        <option value="" class="i18n" data-i18n="form.selectTimezone">请选择时区</option>
                                        <option value="UTC+8" selected>UTC+8 (北京时间)</option>
                                        <option value="UTC+7">UTC+7 (东南亚时间)</option>
                                        <option value="UTC+9">UTC+9 (日本/韩国时间)</option>
                                        <option value="UTC+10">UTC+10 (澳大利亚东部时间)</option>
                                        <option value="UTC+5:30">UTC+5:30 (印度时间)</option>
                                        <option value="UTC+1">UTC+1 (中欧时间)</option>
                                        <option value="UTC+0">UTC+0 (格林威治时间)</option>
                                        <option value="UTC-5">UTC-5 (美国东部时间)</option>
                                        <option value="UTC-8">UTC-8 (美国太平洋时间)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- 第三排 -->
                            <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div class="form-group">
                                    <label class="form-label i18n" data-i18n="form.installedCapacity">装机容量(kWp)</label>
                                    <input type="number" class="form-input i18n" id="installed-power" placeholder="请输入装机功率" data-i18n-placeholder="form.installedCapacityPlaceholder">
                                </div>
                                <div class="form-group">
                                    <label class="form-label i18n" data-i18n="form.gridConnectionTime">并网时间</label>
                                    <input type="date" class="form-input" id="grid-date">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 步骤2：添加设备 -->
                <div class="wizard-content" id="wizard-step-2">
                    <div class="form-section">
                        <!-- 标题和添加按钮 -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 class="section-title i18n" data-i18n="wizard.step2" style="margin-bottom: 0; border-bottom: none; padding-bottom: 0;">添加设备</h3>
                            <button type="button" class="btn btn-primary" onclick="addDevice()" style="padding: 0.375rem 1rem; font-size: 0.8rem;">
                                <span class="i18n" data-i18n="btn.add">添加</span>
                            </button>
                        </div>
                        
                        <!-- 设备添加表单 -->
                        <div class="device-form" style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                
                                <!-- 设备列表 -->
                                <div class="device-list-container">
                                    <div id="device-list">
                                        <!-- 设备列表将动态添加到这里 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- 步骤3：电价设置 -->
                <div class="wizard-content" id="wizard-step-3">
                    <div class="form-section">
                        <h3 class="section-title i18n" data-i18n="wizard.step3">电价设置</h3>
                        
                        <!-- 电价设置卡片 -->
                        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 0;">
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <!-- 第一排：货币单位 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.currency">货币单位</label>
                                        <select class="form-select" id="currency">
                                            <option value="CNY">人民币 (CNY)</option>
                                            <option value="USD">美元 (USD)</option>
                                            <option value="EUR">欧元 (EUR)</option>
                                            <option value="GBP">英镑 (GBP)</option>
                                            <option value="JPY">日元 (JPY)</option>
                                            <option value="KRW">韩元 (KRW)</option>
                                            <option value="CAD">加拿大元 (CAD)</option>
                                            <option value="AUD">澳大利亚元 (AUD)</option>
                                            <option value="CHF">瑞士法郎 (CHF)</option>
                                            <option value="SGD">新加坡元 (SGD)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <!-- 空白占位 -->
                                    </div>
                                </div>
                                
                                <!-- 第二排：电价类型 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.feedPriceType">上网电价类型</label>
                                        <select class="form-select" id="feed-price-type">
                                            <option value="fixed" class="i18n" data-i18n="form.fixedPrice">固定电价</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.consumePriceType">用电电价类型</label>
                                        <select class="form-select" id="consume-price-type">
                                            <option value="fixed" class="i18n" data-i18n="form.fixedPrice">固定电价</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- 第三排：电价值 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.feedPriceValue">上网电价值</label>
                                        <input type="number" class="form-input i18n-placeholder" id="feed-price" data-placeholder-zh="请输入上网电价" data-placeholder-en="Enter feed-in tariff rate" placeholder="请输入上网电价" step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.consumePriceValue">用电电价值</label>
                                        <input type="number" class="form-input i18n-placeholder" id="consume-price" data-placeholder-zh="请输入用电电价" data-placeholder-en="Enter consumption tariff rate" placeholder="请输入用电电价" step="0.01">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- 分割线 -->
                <div style="border-top: 1px solid #e5e7eb; width: 733.2px; margin: 0;"></div>
                
                <!-- 向导底部按钮 -->
                <div class="wizard-footer" style="justify-content: flex-end; border-top: none; background: none; padding: 1.5rem 0 0 0; width: 733.2px;">
                <div class="wizard-nav">
                    <button class="btn btn-cancel" onclick="closeCreateStationModal()">
                        <span class="i18n" data-i18n="btn.cancel">取消</span>
                    </button>
                    <button class="btn btn-secondary" id="wizard-prev" onclick="prevWizardStep()" style="display: none;">
                        <span class="i18n" data-i18n="btn.previous">上一步</span>
                    </button>
                    <button class="btn btn-primary" id="wizard-next" onclick="nextWizardStep()">
                        <span class="i18n" data-i18n="btn.next">下一步</span>
                    </button>
                    <button class="btn btn-primary" id="wizard-finish" onclick="finishCreateStation()" style="display: none;">
                        <span class="i18n" data-i18n="btn.finish">完成</span>
                    </button>
                </div>
            </div>
            </div>
        </div>
    </div>

    <!-- 编辑电站弹窗 -->
    <div id="edit-station-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title i18n" data-i18n="modal.editStation">编辑电站</h2>
                <button class="modal-close" onclick="closeEditStationModal()">&times;</button>
            </div>
            
            <!-- 步骤指示器 -->
            <div class="wizard-steps">
                <div class="wizard-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title i18n" data-i18n="wizard.step1">基础信息</div>
                </div>
                <div class="wizard-step" data-step="2" style="margin-left: 210px;">
                    <div class="step-number">2</div>
                    <div class="step-title i18n" data-i18n="wizard.step2">添加设备</div>
                </div>
                <div class="wizard-step" data-step="3" style="margin-left: 230px;">
                    <div class="step-number">3</div>
                    <div class="step-title i18n" data-i18n="wizard.step3">电价设置</div>
                </div>
            </div>
            
            <div class="modal-body">
                <!-- 步骤1：基础信息 -->
                <div class="wizard-content active" id="edit-wizard-step-1">
                    <div class="form-section">
                        <h3 class="section-title i18n" data-i18n="wizard.basicInfo">基础信息</h3>
                        <form id="edit-station-form">
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <!-- 第一排 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label required i18n" data-i18n="form.stationName">电站名称</label>
                                        <input type="text" class="form-input i18n" id="edit-station-name" placeholder="请输入电站名称" data-i18n-placeholder="form.stationNamePlaceholder">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.stationType">电站类型</label>
                                        <input type="text" class="form-input i18n" id="edit-station-type" value="工商储" data-i18n-value="form.commercialStorage" readonly style="background: #f3f4f6; cursor: not-allowed;">
                                    </div>
                                </div>
                                
                                <!-- 第二排 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label required i18n" data-i18n="form.address">地址</label>
                                        <input type="text" class="form-input i18n" id="edit-address" placeholder="请输入详细地址" data-i18n-placeholder="form.addressPlaceholder">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label required i18n" data-i18n="form.timezone">时区</label>
                                        <select class="form-select" id="edit-timezone">
                                            <option value="" class="i18n" data-i18n="form.selectTimezone">请选择时区</option>
                                            <option value="UTC+8" selected>UTC+8 (北京时间)</option>
                                            <option value="UTC+7">UTC+7 (东南亚时间)</option>
                                            <option value="UTC+9">UTC+9 (日本/韩国时间)</option>
                                            <option value="UTC+10">UTC+10 (澳大利亚东部时间)</option>
                                            <option value="UTC+5:30">UTC+5:30 (印度时间)</option>
                                            <option value="UTC+1">UTC+1 (中欧时间)</option>
                                            <option value="UTC+0">UTC+0 (格林威治时间)</option>
                                            <option value="UTC-5">UTC-5 (美国东部时间)</option>
                                            <option value="UTC-8">UTC-8 (美国太平洋时间)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- 第三排 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.installedCapacity">装机容量(kWp)</label>
                                        <input type="number" class="form-input i18n" id="edit-installed-power" placeholder="请输入装机功率" data-i18n-placeholder="form.installedCapacityPlaceholder">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.gridConnectionTime">并网时间</label>
                                        <input type="date" class="form-input" id="edit-grid-date">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- 步骤2：添加设备 -->
                <div class="wizard-content" id="edit-wizard-step-2">
                    <div class="form-section">
                        <!-- 标题和添加按钮 -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 class="section-title i18n" data-i18n="wizard.step2" style="margin-bottom: 0; border-bottom: none; padding-bottom: 0;">添加设备</h3>
                            <button type="button" class="btn btn-primary" onclick="addEditDevice()" style="padding: 0.375rem 1rem; font-size: 0.8rem;">
                                <span class="i18n" data-i18n="btn.add">添加</span>
                            </button>
                        </div>
                        
                        <!-- 设备添加表单 -->
                        <div class="device-form" style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <!-- 设备列表 -->
                                <div class="device-list-container">
                                    <div id="edit-device-list">
                                        <!-- 设备列表将动态添加到这里 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- 步骤3：电价设置 -->
                <div class="wizard-content" id="edit-wizard-step-3">
                    <div class="form-section">
                        <h3 class="section-title i18n" data-i18n="wizard.step3">电价设置</h3>
                        
                        <!-- 电价设置卡片 -->
                        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 0;">
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <!-- 第一排：货币单位 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.currency">货币单位</label>
                                        <select class="form-select" id="edit-currency">
                                            <option value="CNY">人民币 (CNY)</option>
                                            <option value="USD">美元 (USD)</option>
                                            <option value="EUR">欧元 (EUR)</option>
                                            <option value="GBP">英镑 (GBP)</option>
                                            <option value="JPY">日元 (JPY)</option>
                                            <option value="KRW">韩元 (KRW)</option>
                                            <option value="CAD">加拿大元 (CAD)</option>
                                            <option value="AUD">澳大利亚元 (AUD)</option>
                                            <option value="CHF">瑞士法郎 (CHF)</option>
                                            <option value="SGD">新加坡元 (SGD)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <!-- 空白占位 -->
                                    </div>
                                </div>
                                
                                <!-- 第二排：电价类型 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.feedPriceType">上网电价类型</label>
                                        <select class="form-select" id="edit-feed-price-type">
                                            <option value="fixed" class="i18n" data-i18n="form.fixedPrice">固定电价</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.consumePriceType">用电电价类型</label>
                                        <select class="form-select" id="edit-consume-price-type">
                                            <option value="fixed" class="i18n" data-i18n="form.fixedPrice">固定电价</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- 第三排：电价值 -->
                                <div class="form-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.feedPriceValue">上网电价值</label>
                                        <input type="number" class="form-input i18n-placeholder" id="edit-feed-price" data-placeholder-zh="请输入上网电价" data-placeholder-en="Enter feed-in tariff rate" placeholder="请输入上网电价" step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label i18n" data-i18n="form.consumePriceValue">用电电价值</label>
                                        <input type="number" class="form-input i18n-placeholder" id="edit-consume-price" data-placeholder-zh="请输入用电电价" data-placeholder-en="Enter consumption tariff rate" placeholder="请输入用电电价" step="0.01">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- 分割线 -->
                <div style="border-top: 1px solid #e5e7eb; width: 733.2px; margin: 0;"></div>
                
                <!-- 向导底部按钮 -->
                <div class="wizard-footer" style="justify-content: flex-end; border-top: none; background: none; padding: 1.5rem 0 0 0; width: 733.2px;">
                <div class="wizard-nav">
                    <button class="btn btn-cancel" onclick="closeEditStationModal()">
                        <span class="i18n" data-i18n="btn.cancel">取消</span>
                    </button>
                    <button class="btn btn-secondary" id="edit-wizard-prev" onclick="prevEditWizardStep()" style="display: none;">
                        <span class="i18n" data-i18n="btn.previous">上一步</span>
                    </button>
                    <button class="btn btn-primary" id="edit-wizard-next" onclick="nextEditWizardStep()">
                        <span class="i18n" data-i18n="btn.next">下一步</span>
                    </button>
                    <button class="btn btn-primary" id="edit-wizard-finish" onclick="finishEditStation()" style="display: none;">
                        <span class="i18n" data-i18n="btn.finish">完成</span>
                    </button>
                </div>
            </div>
            </div>
        </div>
    </div>
    
    <!-- 地图选择弹窗 -->
    <div id="map-modal" class="map-modal">
        <div class="map-modal-content">
            <div class="map-modal-header">
                <h3 class="modal-title">选择位置</h3>
                <button class="modal-close" onclick="closeMapModal()">&times;</button>
            </div>
            
            <div class="map-search-bar">
                <input type="text" class="map-search-input" id="map-search" placeholder="搜索地点...">
                <button class="map-search-btn" onclick="searchLocation()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    搜索
                </button>
            </div>
            
            <div class="map-container">
                <div id="map" style="width: 100%; height: 100%;"></div>
            </div>
            
            <div class="map-modal-footer">
                <div class="map-coords">
                    <span id="selected-coords">经纬度：未选择</span>
                </div>
                <div class="map-actions">
                    <button class="btn btn-cancel" onclick="closeMapModal()">取消</button>
                    <button class="btn btn-primary" onclick="confirmLocation()">确认选择</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>