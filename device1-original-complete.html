<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ËÆæÂ§á1ËØ¶ÊÉÖ - Â∑•ÂïÜÂÇ®ËÉΩÁÆ°ÁêÜÁ≥ªÁªü</title>
    <link rel="stylesheet" href="../sidebar.css">
    <link rel="stylesheet" href="../tab-component.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.5;
            color: #1e293b;
            background: #EBEDF5;
            min-height: 100vh;
        }

        /* ‰∏ÄÁ∫ßËèúÂçïÊ†∑Âºè */
        .menu-group {
            margin-bottom: 0;
        }
        
        .menu-parent {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1.5rem;
            color: #64748b;
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            position: relative;
        }
        
        .menu-parent:hover {
            background: #f1f5f9;
            color: #1e293b;
        }
        
        .menu-parent.expanded {
            background: transparent;
            color: #3562E3;
        }
        
        .menu-arrow {
            transition: transform 0.2s ease;
            font-size: 0.75rem;
            color: #94a3b8;
        }
        
        .menu-parent.expanded .menu-arrow {
            transform: rotate(90deg);
            color: #64748b;
        }
        
        /* ‰∫åÁ∫ßËèúÂçïÊ†∑Âºè */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: transparent;
        }
        
        .submenu.open {
            max-height: 300px;
        }
        
        .submenu-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem 0.75rem 3rem;
            color: #64748b;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            position: relative;
        }
        
        .submenu-item:hover {
            background: #f1f5f9;
            color: #1e293b;
        }
        
        .submenu-item.active {
            background: #eff6ff;
            color: #3562E3;
        }
        
        .submenu-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: #3562E3;
        }

        .menu-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .menu-icon svg {
            width: 100%;
            height: 100%;
        }

        /* ‰∏ªÂÜÖÂÆπÂå∫Âüü */
        .main-content {
            margin-left: 240px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: transparent;
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .navbar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 2rem;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .page-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            transition: all 150ms ease;
        }

        .nav-button:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        /* ÂÜÖÂÆπÂå∫Âüü */
        .content {
            flex: 1;
            padding: 2rem;
            width: 1129px;
            margin: 0 auto;
        }

        /* ÁîµÁ´ô‰ø°ÊÅØÂ§¥ÈÉ® */
        .station-header {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .station-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .station-name {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .station-power-status {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 8px;
            font-size: 14px;
        }
        
        .power-status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 16px;
            font-weight: 500;
        }
        
        .power-status-badge.feeding {
            background-color: #e0f2fe;
            color: #0369a1;
        }
        
        .power-status-badge.consuming {
            background-color: #fef3c7;
            color: #d97706;
        }
        
        .power-status-badge .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .power-status-badge.feeding .status-dot {
            background-color: #0369a1;
        }
        
        .power-status-badge.consuming .status-dot {
            background-color: #d97706;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .power-value {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .station-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .status-online {
            background: #dcfce7;
            color: #16a34a;
        }

        .status-offline {
            background: #f3f4f6;
            color: #6b7280;
        }

        .status-warning {
            background: #fef3c7;
            color: #d97706;
        }

        .station-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .metric-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .metric-label {
            font-size: 0.875rem;
            color: #64748b;
        }

        .metric-value {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        /* TabÂàáÊç¢ - ‰∏éÊï∞ÊçÆÂàÜÊûê‰øùÊåÅ‰∏ÄËá¥ */
        .detail-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 24px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: -2px;
            max-width: 1129px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 24px;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            border: none;
            background: none;
            cursor: pointer;
            color: #64748b;
            font-weight: 500;
            transition: all 150ms ease;
            position: relative;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }

        .tab-button:hover {
            color: #1e293b;
        }

        .tab-button.active {
            color: #3562E3;
            border-bottom-color: #3562E3;
        }

        /* TabÂÜÖÂÆπÂå∫Âüü */
        .tab-content {
            display: none;
            margin-top: 24px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ê¶ÇËßàÂÜÖÂÆπ */
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .card, .overview-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .card.energy-flow-card {
            background: #f8fafc;
        }

        .card-header {
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .card-content {
            padding: 0;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 0.5rem;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #64748b;
        }

        .stat-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
        }

        /* ËÆæÂ§áÂàóË°® */
        .device-list {
            /* ËÉåÊôØÂíåÈò¥ÂΩ±Â∑≤Âú®.tab-content‰∏≠ËÆæÁΩÆ */
        }

        .device-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* ÊêúÁ¥¢ÂíåÈáçÁΩÆÊåâÈíÆÊ†∑Âºè */
        .search-button {
            padding: 0.5rem 1.5rem;
            background: #3562E3;
            color: white;
            border: 1px solid #3562E3;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            height: 2.5rem;
        }
        
        .search-button:hover {
            background: #2951d9;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .reset-button {
            padding: 0.5rem 1.5rem;
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            height: 2.5rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .reset-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .device-table th {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            font-size: 0.875rem;
        }

        .device-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
            color: #1e293b;
        }

        .device-status {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .device-status.normal {
            background: #dcfce7;
            color: #16a34a;
        }

        .device-status.fault {
            background: #fee2e2;
            color: #dc2626;
        }

        /* ËøêË°åÊï∞ÊçÆ */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .data-card {
            background: #f8fafc;
            border-radius: 0.5rem;
            padding: 1rem;
            border: 1px solid #e2e8f0;
        }

        .chart-placeholder {
            height: 300px;
            background: #f8fafc;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
        }

        /* ËÉΩÈáèÊΩÆÊµÅÂõæÊ†∑Âºè */
        .energy-flow-container {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-top: 1.5rem;
        }

        .energy-metrics-container {
            display: flex;
            gap: 0;
            width: 100%;
        }

        .energy-flow-diagram {
            position: relative;
            height: 600px;
            background: transparent;
            border-radius: 0;
            padding: 120px 60px 120px 60px;
            overflow: hidden;
            flex: 3;
            min-width: 0;
        }

        .data-metrics-card {
            flex: 1;
            background: transparent;
            border-radius: 0;
            padding: 20px;
            height: 600px;
            overflow-y: auto;
            position: relative;
        }

        .metrics-section {
            margin-bottom: 24px;
        }

        .metrics-section:last-child {
            margin-bottom: 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .metrics-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        .metrics-item {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 12px 0;
            text-align: left;
        }

        .metrics-label {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .metrics-value {
            font-size: 18px;
            font-weight: 700;
            color: #0f172a;
            line-height: 1;
        }

        .flow-component {
            position: absolute;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 20;
        }

        .flow-component:hover {
            transform: translateY(-5px);
        }

        .flow-component img {
            width: 80%;
            height: auto;
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.1));
            transition: filter 0.3s ease;
        }

        .flow-component.grid img {
            width: 70%;
        }

        .flow-component:hover img {
            filter: drop-shadow(0 12px 24px rgba(0,0,0,0.15));
        }

        .flow-component.pv {
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
        }

        .flow-component.load {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 160px;
        }

        .flow-component.storage {
            bottom: 10px;
            left: 90px;
            width: 140px;
        }

        .flow-component.grid {
            bottom: 10px;
            right: 110px;
            width: 120px;
        }

        .battery-indicator {
            position: absolute;
            top: 50%;
            left: -60px;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 30;
        }
        
        .battery-icon {
            position: relative;
            width: 30px;
            height: 16px;
            border: 2px solid #64748b;
            border-radius: 3px;
            display: flex;
            align-items: center;
            padding: 2px;
        }
        
        .battery-icon::after {
            content: '';
            position: absolute;
            right: -4px;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 8px;
            background: #64748b;
            border-radius: 0 2px 2px 0;
        }
        
        .battery-level {
            height: 100%;
            background: #10b981;
            border-radius: 1px;
            transition: width 0.3s ease;
        }
        
        .battery-text {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .component-label {
            position: absolute;
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            background: white;
            padding: 8px 20px;
            border-radius: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: inline-block;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .flow-component.pv .component-label {
            right: -80px;
            top: calc(50% - 10px);
            transform: translateY(-50%);
        }
        .flow-component.load .component-label {
            right: -85px;
            top: 50%;
            transform: translateY(-50%);
        }

        .flow-component:hover .component-label {
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }
        .flow-component.pv:hover .component-label,
        .flow-component.load:hover .component-label {
            transform: translateY(-50%) scale(1.05);
        }
        .flow-component.storage .component-label,
        .flow-component.grid .component-label {
            position: static;
            margin-top: 15px;
        }
        .flow-component.storage:hover .component-label,
        .flow-component.grid:hover .component-label {
            transform: scale(1.05);
        }

        .component-power {
            font-size: 1.125rem;
            font-weight: 700;
            color: #3562E3;
            margin-top: 5px;
        }

        .component-status {
            font-size: 0.75rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        .inverter {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 140px;
            height: 80px;
            background: linear-gradient(135deg, #3562E3 0%, #2148C0 100%);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 25;
            box-shadow: 0 8px 24px rgba(53,98,227,0.25);
            transition: all 0.3s ease;
            display: none; /* ÊöÇÊó∂ÈöêËóèÈÄÜÂèòÂô®Ôºå‰ΩøÁî®Ë¥üËΩΩÊõø‰ª£‰∏≠ÂøÉ‰ΩçÁΩÆ */
        }

        .inverter:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 12px 32px rgba(53,98,227,0.35);
        }

        .inverter img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .inverter-label {
            position: absolute;
            bottom: -25px;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .power-label {
            position: absolute;
            background: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 700;
            color: #3562E3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            white-space: nowrap;
            z-index: 15;
            transition: all 0.3s ease;
        }

        .power-label.active {
            background: #3562E3;
            color: white;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* ËÉΩÈáèÊµÅÂä®Á∫ø */
        .energy-flow-svg {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 10;
            opacity: 1;
        }

        .flow-line {
            stroke: #EDEDED;
            stroke-width: 6;
            fill: none;
            opacity: 1;
            stroke-linecap: round;
            stroke-linejoin: round;
            position: relative;
        }
        
        @keyframes flowAnimation {
            0% {
                offset-distance: 0%;
            }
            100% {
                offset-distance: 100%;
            }
        }
        
        .flow-segment {
            stroke: #5C85FF;
            stroke-width: 4;
            stroke-linecap: round;
            filter: drop-shadow(0 0 8px #5C85FF);
            fill: none;
            opacity: 0.9;
        }
        
        @keyframes pathFlow {
            0% {
                stroke-dashoffset: 100%;
            }
            100% {
                stroke-dashoffset: 0%;
            }
        }
        
        .flow-gradient {
            stroke: url(#flowGradient);
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out infinite;
        }
        
        @keyframes fadeInOut {
            0%, 100% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
        }

        /* ÁßªÈô§Âä®ÁîªÊïàÊûúÔºå‰øùÊåÅÁÆÄÊ¥Å */
        .flow-line-active {
            stroke: #E0E0E0;
        }

        .energy-line {
            position: absolute;
            background: linear-gradient(90deg, transparent 0%, #3562E3 20%, #3562E3 80%, transparent 100%);
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
        }

        .energy-line::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.8) 50%, transparent 100%);
            animation: energyFlow 2s linear infinite;
        }

        @keyframes energyFlow {
            to {
                left: 100%;
            }
        }

        .energy-flow-label {
            position: absolute;
            font-size: 12px;
            color: #666;
            background: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .flow-line.pv-to-storage {
            width: 3px;
            height: 180px;
            top: 140px;
            left: 50%;
            transform: translateX(-50%);
        }

        .flow-line.pv-to-storage::after {
            border-width: 8px 6px 0 6px;
            border-color: #3562E3 transparent transparent transparent;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
        }

        .flow-line.grid-to-storage {
            width: 180px;
            height: 3px;
            top: 50%;
            left: 170px;
            transform: translateY(-50%);
        }

        .flow-line.grid-to-storage::after {
            border-width: 6px 0 6px 8px;
            border-color: transparent transparent transparent #3562E3;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
        }

        .flow-line.storage-to-load {
            width: 180px;
            height: 3px;
            bottom: 140px;
            right: 170px;
        }

        .flow-line.storage-to-load::after {
            border-width: 6px 0 6px 8px;
            border-color: transparent transparent transparent #3562E3;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
        }

        /* ÊµÅÂä®Âä®Áîª */
        @keyframes flowAnimation {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 20px 0;
            }
        }

        .flow-line.active {
            background-image: repeating-linear-gradient(
                90deg,
                #3562E3,
                #3562E3 5px,
                transparent 5px,
                transparent 10px
            );
            animation: flowAnimation 1s linear infinite;
        }

        .flow-line.reverse {
            animation-direction: reverse;
        }

        /* ‰∏≠ÂøÉÊû¢Á∫Ω */
        .energy-hub {
            position: absolute;
            width: 80px;
            height: 80px;
            background: #f8fafc;
            border: 3px solid #3562E3;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #3562E3;
            z-index: 15;
        }

        /* ÂëäË≠¶ÂàóË°® */
        .alarm-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            background: white;
            color: #1e293b;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .alarm-list {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .alarm-table {
            width: 100%;
            border-collapse: collapse;
        }

        .alarm-table th {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            font-size: 0.875rem;
        }

        .alarm-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
            color: #1e293b;
        }

        .alarm-level {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .alarm-level.critical {
            background: #fee2e2;
            color: #dc2626;
        }

        .alarm-level.major {
            background: #ffedd5;
            color: #ea580c;
        }

        .alarm-level.minor {
            background: #fef3c7;
            color: #d97706;
        }

        .alarm-level.info {
            background: #dbeafe;
            color: #2563eb;
        }

        /* Êä•Ë°® */
        .report-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .report-filters {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .date-range {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .date-input {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            color: #1e293b;
        }

        .btn-export {
            padding: 0.5rem 1.5rem;
            background: #3562E3;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 150ms ease;
        }

        .btn-export:hover {
            background: #2C50B8;
        }

        .report-content {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Ê∑±Ëâ≤‰∏ªÈ¢ò */
        [data-theme="dark"] body {
            background: #0f172a;
            color: #e2e8f0;
        }

        [data-theme="dark"] .sidebar {
            background: #1e293b;
            border-right-color: #334155;
        }

        [data-theme="dark"] .menu-item {
            color: #cbd5e1;
        }

        [data-theme="dark"] .menu-item:hover {
            background: #334155;
            color: #f1f5f9;
        }

        [data-theme="dark"] .menu-item.active {
            background: #1e3a8a;
            color: #60a5fa;
        }

        [data-theme="dark"] .menu-parent {
            color: #cbd5e1;
        }

        [data-theme="dark"] .menu-parent:hover {
            background: #334155;
            color: #f1f5f9;
        }

        [data-theme="dark"] .navbar {
            background: #1e293b;
            border-bottom-color: #334155;
        }

        [data-theme="dark"] .nav-button {
            background: #334155;
            border-color: #475569;
            color: #e2e8f0;
        }

        [data-theme="dark"] .nav-button:hover {
            background: #475569;
            border-color: #64748b;
        }

        [data-theme="dark"] .station-header,
        [data-theme="dark"] .card,
        [data-theme="dark"] .overview-card,
        [data-theme="dark"] .device-list,
        [data-theme="dark"] .data-card,
        [data-theme="dark"] .alarm-list,
        [data-theme="dark"] .report-content {
            background: #1e293b;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        [data-theme="dark"] .stat-item {
            background: #334155;
        }

        [data-theme="dark"] .chart-placeholder {
            background: #334155;
            color: #64748b;
        }

        [data-theme="dark"] .filter-select,
        [data-theme="dark"] .date-input {
            background: #334155;
            border-color: #475569;
            color: #e2e8f0;
        }

        [data-theme="dark"] .energy-flow-container {
            background: #1e293b;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        [data-theme="dark"] .energy-flow-diagram {
            background: transparent;
        }

        [data-theme="dark"] .data-metrics-card {
            background: transparent;
        }

        [data-theme="dark"] .metrics-title {
            color: #f1f5f9;
            border-bottom-color: #334155;
        }

        [data-theme="dark"] .metrics-label {
            color: #94a3b8;
        }

        [data-theme="dark"] .metrics-value {
            color: #f1f5f9;
        }

        [data-theme="dark"] .card-header {
            border-bottom-color: #334155;
        }

        [data-theme="dark"] .card.energy-flow-card {
            background: #0f172a;
        }

        [data-theme="dark"] select {
            background: #1e293b !important;
            border-color: #334155 !important;
            color: #f1f5f9 !important;
        }

        [data-theme="dark"] #settings-btn {
            background: #1e293b !important;
            border-color: #334155 !important;
            color: #f1f5f9 !important;
        }

        [data-theme="dark"] #settings-panel {
            background: #1e293b !important;
            border-color: #334155 !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
        }

        [data-theme="dark"] #settings-panel div:first-child {
            color: #f1f5f9 !important;
        }

        [data-theme="dark"] #settings-panel span {
            color: #94a3b8 !important;
        }

        [data-theme="dark"] .flow-component img {
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)) brightness(0.9);
        }

        [data-theme="dark"] .component-label {
            background: rgba(51,65,85,0.9);
            border-color: #475569;
            color: #e2e8f0;
        }

        [data-theme="dark"] .inverter {
            background: #1e293b;
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59,130,246,0.3);
        }

        [data-theme="dark"] .inverter span {
            color: #e2e8f0 !important;
        }

        [data-theme="dark"] .power-label {
            background: #334155;
            border-color: #475569;
            color: #60a5fa;
        }

        [data-theme="dark"] .battery-text {
            color: #e2e8f0;
        }
        
        [data-theme="dark"] .battery-icon {
            border-color: #94a3b8;
        }
        
        [data-theme="dark"] .battery-icon::after {
            background: #94a3b8;
        }

        [data-theme="dark"] .energy-flow-label {
            background: #334155;
            border-color: #475569;
            color: #e2e8f0;
        }

        [data-theme="dark"] .flow-line {
            stroke: #374151;
        }

        [data-theme="dark"] .energy-hub {
            background: #334155;
            border-color: #60a5fa;
            color: #60a5fa;
        }

        [data-theme="dark"] .component-name,
        [data-theme="dark"] .component-power {
            color: #e2e8f0;
        }

        [data-theme="dark"] .component-status {
            color: #94a3b8;
        }
        /* TabÂÜÖÂÆπÂåÖË£ÖÂô® */
        .tab-content-wrapper {
            max-width: 1129px;
            margin: 0 auto;
        }

    
</style>
</head>
<body>
    <!-- ‰æßËæπÊ†èÂÆπÂô® -->
    <div id="sidebar-container"></div>

    <!-- ‰æßËæπÊ†è -->
    <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
    <main class="main-content">
        <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
        <nav class="navbar">
            <div class="navbar-left">
                <button class="nav-button" onclick="toggleSidebar()">
                    <span>‚ò∞</span>
                </button>
                <button class="nav-button" onclick="goBack()" title="ËøîÂõûÁîµÁ´ôÂàóË°®">
                    <span>‚Üê</span>
                </button>
                <h1 class="page-title i18n" data-i18n="page.title">ËÆæÂ§á1ËØ¶ÊÉÖ</h1>
            </div>
            <div class="navbar-right">
                <button class="nav-button" onclick="toggleLanguage()">
                    <span>üåê</span>
                    <span id="lang-text">‰∏≠Êñá</span>
                </button>
                <button class="nav-button" onclick="toggleTheme()">
                    <span id="theme-icon">üåô</span>
                </button>
                <button class="nav-button">
                    <span>üë§</span>
                    <span>ÁÆ°ÁêÜÂëò</span>
                </button>
            </div>
        </nav>

        <!-- ÂÜÖÂÆπÂå∫Âüü -->
        <div class="content">
            
            <!-- ÁîµÁ´ô‰ø°ÊÅØÂ§¥ÈÉ® -->
            <div class="station-header" style="width: 1129px; margin: 0 auto; margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <!-- ËøîÂõûÊåâÈíÆ - Âè™ÊúâÂõæÊ†á -->
                    <button onclick="goBack()" style="background: none; border: none; cursor: pointer; font-size: 20px; color: #6b7280; padding: 8px;">
                        ‚Üê
                    </button>
                    
                    <!-- ÁîµÁ´ôÂêçÁß∞ÂíåÁä∂ÊÄÅ -->
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <h2 style="margin: 0; font-size: 20px; font-weight: 600; color: #1f2937;">
                            <span class="i18n" data-i18n="station.name">Á§∫ËåÉÁîµÁ´ôA</span>
                        </h2>
                        
                        <!-- ÈÄöËÆØÁä∂ÊÄÅ -->
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: #6b7280;">
                                <span class="i18n" data-i18n="status.communication">ÈÄöËÆØÔºö</span>
                            </span>
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div style="width: 3px; height: 8px; background: #10b981; border-radius: 1px;"></div>
                                <div style="width: 3px; height: 12px; background: #10b981; border-radius: 1px;"></div>
                                <div style="width: 3px; height: 16px; background: #10b981; border-radius: 1px;"></div>
                                <div style="width: 3px; height: 12px; background: #10b981; border-radius: 1px;"></div>
                                <div style="width: 3px; height: 8px; background: #10b981; border-radius: 1px;"></div>
                            </div>
                        </div>
                        
                        <!-- Áä∂ÊÄÅ -->
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: #6b7280;">
                                <span class="i18n" data-i18n="status.device">Áä∂ÊÄÅÔºö</span>
                            </span>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #10b981;"></div>
                                <span style="font-size: 14px; color: #10b981; font-weight: 500;">
                                    <span class="i18n" data-i18n="status.online">Âú®Á∫ø</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Âè≥‰æßÊéßÂà∂Âå∫Âüü -->
                <div style="display: flex; align-items: center; gap: 20px;">
                    <!-- È¶àÁîµÁä∂ÊÄÅ - Âè™‰øùÁïôÈ¶àÁîµÔºåÊúÄÂ§ßÂúÜËßí -->
                    <div class="power-status-badge feeding" style="display: flex; align-items: center; gap: 4px; padding: 8px 16px; border-radius: 999px; background: #dcfce7; border: 1px solid #bbf7d0;">
                        <div style="width: 6px; height: 6px; border-radius: 50%; background: #16a34a;"></div>
                        <span style="font-size: 14px; color: #16a34a; font-weight: 500;">
                            <span class="i18n" data-i18n="status.feeding">È¶àÁîµ</span>
                        </span>
                    </div>
                    
                    <!-- ËøêË°åÊ®°Âºè - ÁßªÈô§ÊñáÂ≠óÔºåÊîæÂú®ÊúÄÂè≥‰æß -->
                    <select style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; color: #374151; font-size: 14px; cursor: pointer;" onchange="switchMode(this.value)">
                        <option value="self-consumption">Ëá™ÂèëËá™Áî®</option>
                        <option value="time-plan">Êó∂Èó¥ËÆ°Âàí</option>
                        <option value="backup-mode">Â§áÁîµÊ®°Âºè</option>
                        <option value="force-mode" selected>Âº∫Âà∂Ê®°Âºè</option>
                        <option value="vpp-dispatch">VPPË∞ÉÂ∫¶</option>
                        <option value="ai-mode">AIÊ®°Âºè</option>
                    </select>
                </div>
                </div>
            </div>

            <!-- TabÂàáÊç¢ -->
            <div class="detail-tabs" style="width: 1129px; margin: 0 auto; margin-bottom: 24px;">
                <button class="tab-button active" onclick="switchTab('overview')">
                    <span class="i18n" data-i18n="tab.overview">Ê¶ÇËßà</span>
                </button>
                <button class="tab-button" onclick="switchTab('operation')">
                    <span class="i18n" data-i18n="tab.operation">ËøêË°åÊï∞ÊçÆ</span>
                </button>
                <button class="tab-button" onclick="switchTab('alarms')">
                    <span class="i18n" data-i18n="tab.alarms">ÂëäË≠¶</span>
                </button>
                <button class="tab-button" onclick="switchTab('reports')">
                    <span class="i18n" data-i18n="tab.reports">Êä•Ë°®</span>
                </button>
            </div>

            <!-- TabÂÜÖÂÆπ -->
            <!-- Ê¶ÇËßà -->
            <div class="tab-content active" id="overview-tab">
                <!-- ËÉΩÈáèÊΩÆÊµÅÂõæ - ÂÖ®ÂÆΩÂ∫¶ÊòæÁ§∫Âú®Á¨¨‰∏ÄÊéí -->
                <div class="card energy-flow-card" style="margin-bottom: 1.5rem;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 class="card-title" style="margin: 0;">
                            <span class="i18n" data-i18n="overview.energy_flow">ËÉΩÈáèÂõæ</span>
                        </h3>
                        <div style="position: relative;">
                            <button id="settings-btn" style="padding: 8px; background: white; border: 1px solid #e0e0e0; border-radius: 6px; cursor: pointer; font-size: 14px; color: #666; display: flex; align-items: center;" onclick="toggleSettingsPanel()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="m12 1 0 6m0 6 0 6"></path>
                                    <path d="m1 12 6 0m6 0 6 0"></path>
                                </svg>
                                <span style="margin-left: 4px;">ËÆæÁΩÆ</span>
                            </button>
                            <div id="settings-panel" style="display: none; position: absolute; top: 100%; right: 0; background: white; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 16px; min-width: 200px; z-index: 1000;">
                                <div style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: #333;">ÊòæÁ§∫ÊåáÊ†áÈÄâÊã©</div>
                                <div style="display: flex; flex-direction: column; gap: 6px;">
                                    <!-- ÂÖâ‰ºèÊåáÊ†á -->
                                    <div style="font-size: 13px; font-weight: 600; color: #333; margin-top: 8px;">ÂÖâ‰ºè</div>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="pv-daily" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Êó•ÂèëÁîµÈáè</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="pv-total" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">ÊÄªÂèëÁîµÈáè</span>
                                    </label>
                                    
                                    <!-- ÂÇ®ËÉΩÊåáÊ†á -->
                                    <div style="font-size: 13px; font-weight: 600; color: #333; margin-top: 8px;">ÂÇ®ËÉΩ</div>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="storage-daily-charge" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Êó•ÂÖÖÁîµÈáè</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="storage-total-charge" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Á¥ØËÆ°ÂÖÖÁîµÈáè</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="storage-daily-discharge" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Êó•ÊîæÁîµÈáè</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="storage-total-discharge" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Á¥ØËÆ°ÊîæÁîµÈáè</span>
                                    </label>
                                    
                                    <!-- Êî∂ÁõäÊåáÊ†á -->
                                    <div style="font-size: 13px; font-weight: 600; color: #333; margin-top: 8px;">Êî∂Áõä</div>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="revenue-yesterday" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Êò®Êó•Êî∂Áõä</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="revenue-today" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">‰ªäÊó•Êî∂Áõä</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="revenue-month" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">ÂΩìÊúàÊî∂Áõä</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding-left: 12px;">
                                        <input type="checkbox" checked data-metric-item="revenue-total" style="margin: 0;">
                                        <span style="font-size: 13px; color: #666;">Á¥ØËÆ°Êî∂Áõä</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <!-- ËÉΩÈáèÂõæÂíåÊï∞ÊçÆÊåáÊ†áÂÆπÂô® -->
                        <div class="energy-metrics-container">
                            <!-- ËÉΩÈáèÊµÅÂêëÂõæ - Âç†3/4ÂÆΩÂ∫¶ -->
                            <div class="energy-flow-diagram">
                                <!-- SVG ËÉΩÈáèÊµÅÂêëËøûÁ∫ø -->
                                <svg class="energy-flow-svg" id="energy-flow-svg">
                                    <!-- ËøûÁ∫øÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂàõÂª∫ -->
                                </svg>

                                <!-- ÂÖâ‰ºè -->
                                <div class="flow-component pv">
                                    <img src="../../../ÂÖâ‰ºè.png" alt="ÂÖâ‰ºèÈù¢Êùø">
                                    <div class="component-label">
                                        <span class="i18n" data-i18n="component.pv">ÂÖâ‰ºè</span>
                                    </div>
                                </div>

                                <!-- Ë¥üËΩΩÔºàÂ±Ö‰∏≠Ôºâ -->
                                <div class="flow-component load">
                                    <img src="../../../Ë¥üËΩΩ.png" alt="Ë¥üËΩΩ">
                                    <div class="component-label">
                                        <span class="i18n" data-i18n="component.load">Ë¥üËΩΩ</span>
                                    </div>
                                </div>

                                <!-- ÂÇ®ËÉΩÊüúÔºàÂ∑¶‰∏ãÔºâ -->
                                <div class="flow-component storage">
                                    <img src="../../../ÂÇ®ËÉΩÊüú.png" alt="ÂÇ®ËÉΩÁ≥ªÁªü">
                                    <div class="component-label">
                                        <span class="i18n" data-i18n="component.storage">ÂÇ®ËÉΩ</span>
                                    </div>
                                    <div class="battery-indicator">
                                        <div class="battery-icon">
                                            <div class="battery-level" id="battery-level" style="width: 82%"></div>
                                        </div>
                                        <span class="battery-text" id="soc-display">82%</span>
                                    </div>
                                </div>

                                <!-- ÁîµÁΩëÔºàÂè≥‰∏ãÔºâ -->
                                <div class="flow-component grid">
                                    <img src="../../../ÁîµÁΩë.png" alt="ÁîµÁΩë">
                                    <div class="component-label">
                                        <span class="i18n" data-i18n="component.grid">ÁîµÁΩë</span>
                                    </div>
                                </div>

                            </div>
                            
                            <!-- Êï∞ÊçÆÊåáÊ†áÂç°Áâá - Âç†1/4ÂÆΩÂ∫¶ -->
                            <div class="data-metrics-card">
                                <div class="metrics-section" data-metric="pv-generation">
                                    <h4 class="metrics-title">ÂÖâ‰ºè</h4>
                                    <div class="metrics-grid">
                                        <div class="metrics-item" data-metric-item="pv-daily">
                                            <span class="metrics-label">Êó•ÂèëÁîµÈáè</span>
                                            <span class="metrics-value">46.1 kWh</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="pv-total">
                                            <span class="metrics-label">ÊÄªÂèëÁîµÈáè</span>
                                            <span class="metrics-value">12622 kWh</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="metrics-section" data-metric="storage-system">
                                    <h4 class="metrics-title">ÂÇ®ËÉΩ</h4>
                                    <div class="metrics-grid">
                                        <div class="metrics-item" data-metric-item="storage-daily-charge">
                                            <span class="metrics-label">Êó•ÂÖÖÁîµÈáè</span>
                                            <span class="metrics-value">39.8 kWh</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="storage-total-charge">
                                            <span class="metrics-label">Á¥ØËÆ°ÂÖÖÁîµÈáè</span>
                                            <span class="metrics-value">8774 kWh</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="storage-daily-discharge">
                                            <span class="metrics-label">Êó•ÊîæÁîµÈáè</span>
                                            <span class="metrics-value">25.7 kWh</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="storage-total-discharge">
                                            <span class="metrics-label">Á¥ØËÆ°ÊîæÁîµÈáè</span>
                                            <span class="metrics-value">7347 kWh</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="metrics-section" data-metric="system-revenue">
                                    <h4 class="metrics-title">Êî∂Áõä</h4>
                                    <div class="metrics-grid">
                                        <div class="metrics-item" data-metric-item="revenue-yesterday">
                                            <span class="metrics-label">Êò®Êó•Êî∂Áõä</span>
                                            <span class="metrics-value">¬•141.72</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="revenue-today">
                                            <span class="metrics-label">‰ªäÊó•Êî∂Áõä</span>
                                            <span class="metrics-value">¬•81.12</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="revenue-month">
                                            <span class="metrics-label">ÂΩìÊúàÊî∂Áõä</span>
                                            <span class="metrics-value">¬•2518.65</span>
                                        </div>
                                        <div class="metrics-item" data-metric-item="revenue-total">
                                            <span class="metrics-label">Á¥ØËÆ°Êî∂Áõä</span>
                                            <span class="metrics-value">¬•40772.62</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="overview-grid">
                    <!-- ËøêË°åÁªüËÆ° -->
                    <div class="overview-card">
                        <h3 class="card-title i18n" data-i18n="card.operationStats">ËøêË°åÁªüËÆ°</h3>
                        <div class="stat-grid">
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.totalCharge">Á¥ØËÆ°ÂÖÖÁîµÈáè</span>
                                <span class="stat-value">125,678 kWh</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.totalDischarge">Á¥ØËÆ°ÊîæÁîµÈáè</span>
                                <span class="stat-value">118,234 kWh</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.efficiency">ÁªºÂêàÊïàÁéá</span>
                                <span class="stat-value">94.1%</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.cycles">Âæ™ÁéØÊ¨°Êï∞</span>
                                <span class="stat-value">856</span>
                            </div>
                        </div>
                    </div>

                    <!-- Êî∂ÁõäÁªüËÆ° -->
                    <div class="overview-card">
                        <h3 class="card-title i18n" data-i18n="card.revenueStats">Êî∂ÁõäÁªüËÆ°</h3>
                        <div class="stat-grid">
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.todayRevenue">‰ªäÊó•Êî∂Áõä</span>
                                <span class="stat-value">¬•1,856</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.monthRevenue">Êú¨ÊúàÊî∂Áõä</span>
                                <span class="stat-value">¬•45,678</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.yearRevenue">Âπ¥Â∫¶Êî∂Áõä</span>
                                <span class="stat-value">¬•567,890</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.totalRevenue">Á¥ØËÆ°Êî∂Áõä</span>
                                <span class="stat-value">¬•2,345,678</span>
                            </div>
                        </div>
                    </div>

                    <!-- ÂäüÁéáÊõ≤Á∫ø -->
                    <div class="overview-card" style="grid-column: span 2;">
                        <h3 class="card-title i18n" data-i18n="card.powerCurve">‰ªäÊó•ÂäüÁéáÊõ≤Á∫ø</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>

                    <!-- SOCÊõ≤Á∫ø -->
                    <div class="overview-card">
                        <h3 class="card-title i18n" data-i18n="card.socCurve">SOCÂèòÂåñÊõ≤Á∫ø</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>

                    <!-- ÁéØÂ¢É‰ø°ÊÅØ -->
                    <div class="overview-card">
                        <h3 class="card-title i18n" data-i18n="card.environment">ÁéØÂ¢É‰ø°ÊÅØ</h3>
                        <div class="stat-grid">
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.temperature">ÁéØÂ¢ÉÊ∏©Â∫¶</span>
                                <span class="stat-value">26.5¬∞C</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.humidity">ÁéØÂ¢ÉÊπøÂ∫¶</span>
                                <span class="stat-value">65%</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.batteryTemp">ÁîµÊ±†Ê∏©Â∫¶</span>
                                <span class="stat-value">28.3¬∞C</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label i18n" data-i18n="stat.coolingStatus">ÂÜ∑Âç¥Áä∂ÊÄÅ</span>
                                <span class="stat-value i18n" data-i18n="status.running">ËøêË°å‰∏≠</span>
                            </div>
                        </div>
                    </div>
                </div>

                    </div>
                </div>
            </div>


            <!-- ËøêË°åÊï∞ÊçÆ -->
            <div class="tab-content" id="operation-tab">
                <div class="data-grid">
                    <div class="data-card">
                        <h3 class="card-title i18n" data-i18n="card.powerData">ÂäüÁéáÊï∞ÊçÆ</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3 class="card-title i18n" data-i18n="card.voltageData">ÁîµÂéãÊï∞ÊçÆ</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3 class="card-title i18n" data-i18n="card.currentData">ÁîµÊµÅÊï∞ÊçÆ</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3 class="card-title i18n" data-i18n="card.temperatureData">Ê∏©Â∫¶Êï∞ÊçÆ</h3>
                        <div class="chart-placeholder">
                            <span class="i18n" data-i18n="placeholder.chart">ÂõæË°®Âä†ËΩΩ‰∏≠...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÂëäË≠¶ -->
            <div class="tab-content" id="alarms-tab">
            </div>

            <!-- Êä•Ë°® -->
            <div class="tab-content" id="reports-tab">
                <div class="report-actions">
                    <div class="report-filters">
                        <select class="filter-select">
                            <option value="daily" class="i18n" data-i18n="report.daily">Êó•Êä•Ë°®</option>
                            <option value="monthly" class="i18n" data-i18n="report.monthly">ÊúàÊä•Ë°®</option>
                            <option value="yearly" class="i18n" data-i18n="report.yearly">Âπ¥Êä•Ë°®</option>
                        </select>
                        <div class="date-range">
                            <input type="date" class="date-input" value="2024-01-01">
                            <span>-</span>
                            <input type="date" class="date-input" value="2024-01-20">
                        </div>
                    </div>
                    <button class="btn-export" onclick="exportReport()">
                        <span class="i18n" data-i18n="btn.export">ÂØºÂá∫Êä•Ë°®</span>
                    </button>
                </div>
                <div class="report-content">
                    <div class="chart-placeholder" style="height: 500px;">
                        <span class="i18n" data-i18n="placeholder.report">Êä•Ë°®ÁîüÊàê‰∏≠...</span>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </main>

    <script>
        // ÂΩìÂâçËØ≠Ë®Ä
        let currentLang = localStorage.getItem('ess_language') || 'zh';
        
        // Â§öËØ≠Ë®ÄÈÖçÁΩÆ
        const i18n = {
            zh: {
                // È°µÈù¢Ê†áÈ¢ò
                'page.title': 'ËÆæÂ§á1ËØ¶ÊÉÖ',
                
                // ÊåâÈíÆ
                'button.back': 'ËøîÂõû',
                
                // ÁîµÁ´ô‰ø°ÊÅØ
                'station.name': 'Á§∫ËåÉÁîµÁ´ôA',
                'station.location': 'Âåó‰∫¨Â∏ÇÊúùÈò≥Âå∫',
                
                // Ê¶ÇËßà
                'overview.energy_flow': 'ËÉΩÈáèÂõæ',
                
                // ËèúÂçï
                'menu.station': 'ÁîµÁ´ô',
                'menu.stationManagement': 'ÁîµÁ´ôÁÆ°ÁêÜ',
                'menu.priceSettings': 'Áîµ‰ª∑ËÆæÁΩÆ',
                'menu.analysis': 'Êï∞ÊçÆÂàÜÊûê',
                'menu.alarm': 'ÂëäË≠¶ÁÆ°ÁêÜ',
                'menu.device': 'ËÆæÂ§áÁÆ°ÁêÜ',
                'menu.user': 'Áî®Êà∑ÁÆ°ÁêÜ',
                'menu.report': 'Êä•Ë°®‰∏≠ÂøÉ',
                'menu.setting': 'Á≥ªÁªüËÆæÁΩÆ',
                
                // Áä∂ÊÄÅ
                'status.communication': 'ÈÄöËÆØÔºö',
                'status.device': 'Áä∂ÊÄÅÔºö',
                'status.mode': 'Ê®°ÂºèÔºö',
                'status.power': 'ÂäüÁéáÔºö',
                'status.feeding': 'È¶àÁîµ',
                'status.online': 'Âú®Á∫ø',
                'status.offline': 'Á¶ªÁ∫ø',
                'status.warning': 'ÂëäË≠¶',
                'status.normal': 'Ê≠£Â∏∏',
                'status.fault': 'ÊïÖÈöú',
                'status.running': 'ËøêË°å‰∏≠',
                'status.generating': 'ÂèëÁîµ‰∏≠',
                'status.importing': 'Ë¥≠Áîµ',
                'status.exporting': 'ÂîÆÁîµ',
                'status.consuming': 'Áî®Áîµ‰∏≠',
                'status.charging': 'ÂÖÖÁîµ‰∏≠',
                'status.discharging': 'ÊîæÁîµ‰∏≠',
                
                // ÊåáÊ†á
                'metric.capacity': 'Ë£ÖÊú∫ÂÆπÈáè',
                'metric.power': 'È¢ùÂÆöÂäüÁéá',
                'metric.soc': 'ÂΩìÂâçSOC',
                'metric.todayCharge': '‰ªäÊó•ÂÖÖÁîµ',
                'metric.todayDischarge': '‰ªäÊó•ÊîæÁîµ',
                'metric.todayRevenue': '‰ªäÊó•Êî∂Áõä',
                
                // TabÊ†áÁ≠æ
                'tab.overview': 'Ê¶ÇËßà',
                'tab.devices': 'ËÆæÂ§á',
                'tab.operation': 'ËøêË°åÊï∞ÊçÆ',
                'tab.alarms': 'ÂëäË≠¶',
                'tab.reports': 'Êä•Ë°®',
                
                // Âç°ÁâáÊ†áÈ¢ò
                'card.operationStats': 'ËøêË°åÁªüËÆ°',
                'card.revenueStats': 'Êî∂ÁõäÁªüËÆ°',
                'card.powerCurve': '‰ªäÊó•ÂäüÁéáÊõ≤Á∫ø',
                'card.socCurve': 'SOCÂèòÂåñÊõ≤Á∫ø',
                'card.environment': 'ÁéØÂ¢É‰ø°ÊÅØ',
                'card.energyFlow': 'ËÉΩÈáèÊΩÆÊµÅÂõæ',
                'card.deviceList': 'ËÆæÂ§áÂàóË°®',
                'device.search.title': 'ËÆæÂ§áÊü•ËØ¢',
                'card.powerData': 'ÂäüÁéáÊï∞ÊçÆ',
                'card.voltageData': 'ÁîµÂéãÊï∞ÊçÆ',
                'card.currentData': 'ÁîµÊµÅÊï∞ÊçÆ',
                'card.temperatureData': 'Ê∏©Â∫¶Êï∞ÊçÆ',
                
                // ÁªüËÆ°È°π
                'stat.totalCharge': 'Á¥ØËÆ°ÂÖÖÁîµÈáè',
                'stat.totalDischarge': 'Á¥ØËÆ°ÊîæÁîµÈáè',
                'stat.efficiency': 'ÁªºÂêàÊïàÁéá',
                'stat.cycles': 'Âæ™ÁéØÊ¨°Êï∞',
                'stat.todayRevenue': '‰ªäÊó•Êî∂Áõä',
                'stat.monthRevenue': 'Êú¨ÊúàÊî∂Áõä',
                'stat.yearRevenue': 'Âπ¥Â∫¶Êî∂Áõä',
                'stat.totalRevenue': 'Á¥ØËÆ°Êî∂Áõä',
                'stat.temperature': 'ÁéØÂ¢ÉÊ∏©Â∫¶',
                'stat.humidity': 'ÁéØÂ¢ÉÊπøÂ∫¶',
                'stat.batteryTemp': 'ÁîµÊ±†Ê∏©Â∫¶',
                'stat.coolingStatus': 'ÂÜ∑Âç¥Áä∂ÊÄÅ',
                
                // Ë°®Ê†º
                'table.deviceName': 'ËÆæÂ§áÂêçÁß∞',
                'table.deviceType': 'ËÆæÂ§áÁ±ªÂûã',
                'table.deviceSN': 'ËÆæÂ§áSN',
                'table.status': 'Áä∂ÊÄÅ',
                'table.power': 'ÂäüÁéá',
                'table.updateTime': 'Êõ¥Êñ∞Êó∂Èó¥',
                'table.actions': 'Êìç‰Ωú',
                'table.alarmTime': 'ÂëäË≠¶Êó∂Èó¥',
                'table.alarmDevice': 'ËÆæÂ§á',
                'table.alarmLevel': 'Á∫ßÂà´',
                'table.alarmContent': 'ÂëäË≠¶ÂÜÖÂÆπ',
                'table.alarmStatus': 'Áä∂ÊÄÅ',
                'table.clearTime': 'Ê∏ÖÈô§Êó∂Èó¥',
                
                // ËÆæÂ§áÁ±ªÂûã
                'device.pcs': 'ÂÇ®ËÉΩÂèòÊµÅÂô®',
                'device.bms': 'ÁîµÊ±†ÁÆ°ÁêÜÁ≥ªÁªü',
                'device.battery': 'ÁîµÊ±†Á∞á',
                'device.ems': 'ËÉΩÈáèÁÆ°ÁêÜÁ≥ªÁªü',
                'device.hvac': 'Á©∫Ë∞ÉÁ≥ªÁªü',
                
                // ÂëäË≠¶
                'alarm.critical': '‰∏•Èáç',
                'alarm.major': 'ÈáçË¶Å',
                'alarm.minor': 'Ê¨°Ë¶Å',
                'alarm.info': 'ÊèêÁ§∫',
                'alarm.active': 'Ê¥ªÂä®',
                'alarm.cleared': 'Â∑≤Ê∏ÖÈô§',
                
                // Á≠õÈÄâ
                'filter.allLevels': 'ÊâÄÊúâÁ∫ßÂà´',
                'filter.allStatus': 'ÊâÄÊúâÁä∂ÊÄÅ',
                
                // Êä•Ë°®
                'report.daily': 'Êó•Êä•Ë°®',
                'report.monthly': 'ÊúàÊä•Ë°®',
                'report.yearly': 'Âπ¥Êä•Ë°®',
                
                // ÊåâÈíÆ
                'btn.export': 'ÂØºÂá∫Êä•Ë°®',
                
                // ÁªÑ‰ª∂
                'component.pv': 'ÂÖâ‰ºè',
                'component.grid': 'ÁîµÁΩë',
                'component.load': 'Ë¥üËΩΩ',
                'component.storage': 'ÂÇ®ËÉΩ',
                'component.hub': 'Ê±áÊµÅ',
                
                // Âç†‰ΩçÁ¨¶
                'placeholder.chart': 'ÂõæË°®Âä†ËΩΩ‰∏≠...',
                'placeholder.report': 'Êä•Ë°®ÁîüÊàê‰∏≠...'
            },
            en: {
                // È°µÈù¢Ê†áÈ¢ò
                'page.title': 'Station Details',
                
                // ÊåâÈíÆ
                'button.back': 'Back',
                
                // ÁîµÁ´ô‰ø°ÊÅØ
                'station.name': 'Demo Station A',
                'station.location': 'Beijing Chaoyang District',
                
                // Ê¶ÇËßà
                'overview.energy_flow': 'Energy Diagram',
                
                // ËèúÂçï
                'menu.station': 'Station',
                'menu.stationManagement': 'Station Management',
                'menu.priceSettings': 'Price Settings',
                'menu.analysis': 'Data Analysis',
                'menu.alarm': 'Alarm Management',
                'menu.device': 'Device Management',
                'menu.user': 'User Management',
                'menu.report': 'Report Center',
                'menu.setting': 'System Settings',
                
                // Áä∂ÊÄÅ
                'status.communication': 'Communication:',
                'status.device': 'Status:',
                'status.mode': 'Mode:',
                'status.power': 'Power:',
                'status.feeding': 'Feeding',
                'status.online': 'Online',
                'status.offline': 'Offline',
                'status.warning': 'Warning',
                'status.normal': 'Normal',
                'status.fault': 'Fault',
                'status.running': 'Running',
                'status.generating': 'Generating',
                'status.importing': 'Importing',
                'status.exporting': 'Exporting',
                'status.consuming': 'Consuming',
                'status.charging': 'Charging',
                'status.discharging': 'Discharging',
                
                // ÊåáÊ†á
                'metric.capacity': 'Installed Capacity',
                'metric.power': 'Rated Power',
                'metric.soc': 'Current SOC',
                'metric.todayCharge': 'Today Charge',
                'metric.todayDischarge': 'Today Discharge',
                'metric.todayRevenue': 'Today Revenue',
                
                // TabÊ†áÁ≠æ
                'tab.overview': 'Overview',
                'tab.devices': 'Devices',
                'tab.operation': 'Operation Data',
                'tab.alarms': 'Alarms',
                'tab.reports': 'Reports',
                
                // Âç°ÁâáÊ†áÈ¢ò
                'card.operationStats': 'Operation Statistics',
                'card.revenueStats': 'Revenue Statistics',
                'card.powerCurve': 'Today Power Curve',
                'card.socCurve': 'SOC Change Curve',
                'card.environment': 'Environment Info',
                'card.energyFlow': 'Energy Flow Diagram',
                'card.deviceList': 'Device List',
                'device.search.title': 'Device Search',
                'card.powerData': 'Power Data',
                'card.voltageData': 'Voltage Data',
                'card.currentData': 'Current Data',
                'card.temperatureData': 'Temperature Data',
                
                // ÁªüËÆ°È°π
                'stat.totalCharge': 'Total Charge',
                'stat.totalDischarge': 'Total Discharge',
                'stat.efficiency': 'Overall Efficiency',
                'stat.cycles': 'Cycle Count',
                'stat.todayRevenue': 'Today Revenue',
                'stat.monthRevenue': 'Month Revenue',
                'stat.yearRevenue': 'Year Revenue',
                'stat.totalRevenue': 'Total Revenue',
                'stat.temperature': 'Ambient Temp',
                'stat.humidity': 'Ambient Humidity',
                'stat.batteryTemp': 'Battery Temp',
                'stat.coolingStatus': 'Cooling Status',
                
                // Ë°®Ê†º
                'table.deviceName': 'Device Name',
                'table.deviceType': 'Device Type',
                'table.deviceSN': 'Device SN',
                'table.status': 'Status',
                'table.power': 'Power',
                'table.updateTime': 'Update Time',
                'table.actions': 'Actions',
                'table.alarmTime': 'Alarm Time',
                'table.alarmDevice': 'Device',
                'table.alarmLevel': 'Level',
                'table.alarmContent': 'Alarm Content',
                'table.alarmStatus': 'Status',
                'table.clearTime': 'Clear Time',
                
                // ËÆæÂ§áÁ±ªÂûã
                'device.pcs': 'PCS',
                'device.bms': 'BMS',
                'device.battery': 'Battery Cluster',
                'device.ems': 'EMS',
                'device.hvac': 'HVAC System',
                
                // ÂëäË≠¶
                'alarm.critical': 'Critical',
                'alarm.major': 'Major',
                'alarm.minor': 'Minor',
                'alarm.info': 'Info',
                'alarm.active': 'Active',
                'alarm.cleared': 'Cleared',
                
                // Á≠õÈÄâ
                'filter.allLevels': 'All Levels',
                'filter.allStatus': 'All Status',
                
                // Êä•Ë°®
                'report.daily': 'Daily Report',
                'report.monthly': 'Monthly Report',
                'report.yearly': 'Yearly Report',
                
                // ÊåâÈíÆ
                'btn.export': 'Export Report',
                
                // ÁªÑ‰ª∂
                'component.pv': 'PV',
                'component.grid': 'Grid',
                'component.load': 'Load',
                'component.storage': 'Storage',
                'component.hub': 'Hub',
                
                // Âç†‰ΩçÁ¨¶
                'placeholder.chart': 'Loading chart...',
                'placeholder.report': 'Generating report...'
            }
        };

        // Ëé∑ÂèñURLÂèÇÊï∞
        function getUrlParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // ÂàùÂßãÂåñÈ°µÈù¢
        function initPage() {
            const stationId = getUrlParam('id');
            const stationName = getUrlParam('name');
            
            if (stationName) {
                const stationNameEl = document.getElementById('station-name');
                if (stationNameEl) {
                    stationNameEl.textContent = decodeURIComponent(stationName);
                }
            }
            
            // Ê†πÊçÆÁîµÁ´ôIDÂä†ËΩΩÊï∞ÊçÆ
            loadStationData(stationId);
        }

        // Âä†ËΩΩÁîµÁ´ôÊï∞ÊçÆ
        function loadStationData(stationId) {
            // ËøôÈáåÂèØ‰ª•Ê†πÊçÆstationId‰ªéÂêéÁ´ØÂä†ËΩΩÂÖ∑‰ΩìÊï∞ÊçÆ
            // Loading data for station
            
            // ÂêØÂä®ËÉΩÈáèÊµÅÂõæÊï∞ÊçÆÊõ¥Êñ∞
            updateEnergyFlowData();
            setInterval(updateEnergyFlowData, 5000); // ÊØè5ÁßíÊõ¥Êñ∞‰∏ÄÊ¨°
        }

        // Êõ¥Êñ∞ËÉΩÈáèÊµÅÂõæÊï∞ÊçÆ
        function updateEnergyFlowData() {
            // Ê®°ÊãüÂä®ÊÄÅÊï∞ÊçÆ
            const pvTotal = (Math.random() * 2 + 2.5).toFixed(2); // 2.5-4.5 kW
            const loadPower = (Math.random() * 1.5 + 2).toFixed(2); // 2-3.5 kW Ë¥üËΩΩÂäüÁéá
            const gridPower = (Math.random() * 0.5 + 0.2).toFixed(2); // 0.2-0.7 kW
            const storagePower = Math.random() > 0.5 ? 0 : (Math.random() * 0.5).toFixed(2); // 0 Êàñ 0-0.5 kW
            const inverterPower = loadPower;
            const soc = Math.floor(Math.random() * 20 + 75); // 75-95%
            
            // ËÆ°ÁÆóÂáÄÂäüÁéáÔºàÊ≠£ÂÄº‰∏∫È¶àÁîµÔºåË¥üÂÄº‰∏∫Áî®ÁîµÔºâ
            const netPower = parseFloat(pvTotal) + parseFloat(storagePower) - parseFloat(loadPower);
            
            // Êõ¥Êñ∞ÁîµÁ´ôÂäüÁéáÁä∂ÊÄÅ
            const powerStatusEl = document.getElementById('power-status');
            const powerValueEl = document.getElementById('power-value');
            
            if (powerStatusEl && powerValueEl) {
                if (netPower > 0) {
                    // È¶àÁîµÁä∂ÊÄÅ
                    powerStatusEl.className = 'power-status-badge feeding';
                    powerStatusEl.innerHTML = '<span class="status-dot"></span><span>È¶àÁîµ</span>';
                    powerValueEl.textContent = Math.abs(netPower).toFixed(2) + ' kW';
                } else {
                    // Áî®ÁîµÁä∂ÊÄÅ
                    powerStatusEl.className = 'power-status-badge consuming';
                    powerStatusEl.innerHTML = '<span class="status-dot"></span><span>Áî®Áîµ</span>';
                    powerValueEl.textContent = Math.abs(netPower).toFixed(2) + ' kW';
                }
            }
            
            // Êõ¥Êñ∞ÈÄÜÂèòÂô®ÂäüÁéá
            const inverterPowerEl = document.getElementById('inverter-power');
            if (inverterPowerEl) {
                inverterPowerEl.textContent = inverterPower + ' kW';
            }
            
            // Êõ¥Êñ∞ÂÇ®ËÉΩSOC
            const socDisplayEl = document.getElementById('soc-display');
            if (socDisplayEl) {
                socDisplayEl.textContent = soc + '%';
            }
            const batteryLevel = document.getElementById('battery-level');
            if (batteryLevel) {
                batteryLevel.style.width = soc + '%';
            }
            
            // Ê†πÊçÆÁîµÈáèËÆæÁΩÆÈ¢úËâ≤
            if (batteryLevel) {
                if (soc > 60) {
                    batteryLevel.style.background = '#10b981'; // ÁªøËâ≤
                } else if (soc > 30) {
                    batteryLevel.style.background = '#f59e0b'; // Ê©ôËâ≤
                } else {
                    batteryLevel.style.background = '#ef4444'; // Á∫¢Ëâ≤
                }
            }
            
            // ÂèØ‰ª•Ê†πÊçÆÂäüÁéáÁä∂ÊÄÅË∞ÉÊï¥Á∫øÊù°Ê†∑Âºè
            const flowLines = document.querySelectorAll('.flow-line');
            flowLines.forEach(line => {
                // ‰øùÊåÅÁÆÄÊ¥ÅÁöÑÁÅ∞Ëâ≤Á∫øÊù°
                line.style.stroke = '#EDEDED';
            });
        }

        // ÁøªËØëÂáΩÊï∞
        function t(key) {
            return i18n[currentLang][key] || key;
        }

        // ÂàáÊç¢ËØ≠Ë®Ä
        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            localStorage.setItem('ess_language', currentLang);
            applyLanguage();
        }

        // Â∫îÁî®ËØ≠Ë®Ä
        function applyLanguage() {
            document.getElementById('lang-text').textContent = currentLang === 'zh' ? '‰∏≠Êñá' : 'English';
            
            // Êõ¥Êñ∞ÁÆ°ÁêÜÂëòÊñáÊú¨
            const navButtons = document.querySelectorAll('.nav-button');
            navButtons.forEach(btn => {
                if (btn.textContent.includes('ÁÆ°ÁêÜÂëò') || btn.textContent.includes('Admin')) {
                    const span = btn.querySelector('span:last-child');
                    if (span) {
                        span.textContent = currentLang === 'zh' ? 'ÁÆ°ÁêÜÂëò' : 'Admin';
                    }
                }
            });
            
            // Êõ¥Êñ∞ÊâÄÊúâÂ∏¶Êúâi18nÁ±ªÁöÑÂÖÉÁ¥†
            document.querySelectorAll('.i18n').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (key && i18n[currentLang][key]) {
                    element.textContent = i18n[currentLang][key];
                }
            });
        }

        // ÂàáÊç¢‰∏ªÈ¢ò
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('ess_theme', newTheme);
            document.getElementById('theme-icon').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        // ÂàáÊç¢‰æßËæπÊ†è
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.querySelector('.main-content');
            
            if (sidebar.style.marginLeft === '-240px') {
                sidebar.style.marginLeft = '0';
                mainContent.style.marginLeft = '240px';
            } else {
                sidebar.style.marginLeft = '-240px';
                mainContent.style.marginLeft = '0';
            }
        }

        // ÂàáÊç¢Â≠êËèúÂçï
        function toggleSubmenu(menuParent) {
            const submenu = menuParent.nextElementSibling;
            const isOpen = submenu.classList.contains('open');
            
            // ÂÖ≥Èó≠ÂÖ∂‰ªñÂ≠êËèúÂçï
            document.querySelectorAll('.submenu.open').forEach(menu => {
                if (menu !== submenu) {
                    menu.classList.remove('open');
                    menu.previousElementSibling.classList.remove('expanded');
                }
            });
            
            if (isOpen) {
                submenu.classList.remove('open');
                menuParent.classList.remove('expanded');
            } else {
                submenu.classList.add('open');
                menuParent.classList.add('expanded');
            }
        }

        // ËøîÂõûÁîµÁ´ôÂàóË°®
        function goBack() {
            window.location.href = './station-management_ÂâØÊú¨.html';
        }

        // ÂàáÊç¢Tab
        function switchTab(tabName) {
            // Êõ¥Êñ∞TabÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ÊâæÂà∞Ë¢´ÁÇπÂáªÁöÑÊåâÈíÆÂπ∂ÊøÄÊ¥ª
            const clickedButton = document.querySelector(`button[onclick="switchTab('${tabName}')"]`);
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
            
            // ÂàáÊç¢ÂÜÖÂÆπ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // ÂØºÂá∫Êä•Ë°®
        function exportReport() {
            // Êä•Ë°®ÂØºÂá∫ÂäüËÉΩÂæÖÂÆûÁé∞
        }

        // ÂàõÂª∫ËÉΩÈáèÊµÅÂêëËøûÁ∫ø
        function createEnergyFlowLines() {
            const svg = document.getElementById('energy-flow-svg');
            if (!svg) {
                return;
            }
            
            // ËÆæÁΩÆSVGÂÜÖÂÆπ
            svg.setAttribute('viewBox', '0 0 1000 600');
            svg.innerHTML = `
                <!-- ÂÖâ‰ºèÂà∞Ë¥üËΩΩ -->
                <line x1="500" y1="130" x2="500" y2="250" stroke="#EDEDED" stroke-width="6" />
                
                <!-- ÂÇ®ËÉΩÂà∞ÂÖâ‰ºè -->
                <path d="M 160 370 L 160 130 Q 160 110 180 110 L 430 110" 
                      stroke="#EDEDED" stroke-width="6" fill="none" />
                
                <!-- ÂÖâ‰ºèÂà∞ÁîµÁΩë -->
                <path d="M 570 110 L 800 110 Q 820 110 820 130 L 820 370" 
                      stroke="#EDEDED" stroke-width="6" fill="none" />
                
                <!-- Ë¥üËΩΩÂà∞ÂÇ®ËÉΩ -->
                <path d="M 485 310 L 485 460 Q 485 480 465 480 L 230 480" 
                      stroke="#EDEDED" stroke-width="6" fill="none" />
                
                <!-- Ë¥üËΩΩÂà∞ÁîµÁΩë -->
                <path d="M 515 310 L 515 460 Q 515 480 535 480 L 750 480" 
                      stroke="#EDEDED" stroke-width="6" fill="none" />
                
                <!-- ÂÇ®ËÉΩÂà∞ÁîµÁΩë -->
                <line x1="230" y1="500" x2="750" y2="500" stroke="#EDEDED" stroke-width="6" />
                
                <!-- Âä®ÁîªÁ∫øÊÆµ -->
                <line x1="0" y1="-10" x2="0" y2="10" stroke="#5C85FF" stroke-width="4" stroke-linecap="round">
                    <animateMotion dur="2s" repeatCount="indefinite">
                        <mpath href="#pvToLoad"/>
                    </animateMotion>
                </line>
                <path id="pvToLoad" d="M 500 130 L 500 250" style="display:none;" />
                
                <!-- ÂäüÁéáÊñáÂ≠ó -->
                <text x="515" y="190" fill="#5C85FF" font-size="14" font-weight="600">7.5 kW</text>
                
                <!-- Á¨¨‰∫å‰∏™Âä®Áîª -->
                <line x1="-10" y1="0" x2="10" y2="0" stroke="#5C85FF" stroke-width="4" stroke-linecap="round">
                    <animateMotion dur="3s" repeatCount="indefinite" rotate="auto">
                        <mpath href="#pvToGrid"/>
                    </animateMotion>
                </line>
                <path id="pvToGrid" d="M 570 110 L 800 110 Q 820 110 820 130 L 820 370" style="display:none;" />
                <text x="710" y="100" fill="#5C85FF" font-size="14" font-weight="600">6.3 kW</text>
            `;
        }

        // Ê®°ÂºèÂàáÊç¢ÂáΩÊï∞
        function switchMode(mode) {
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Ê®°ÂºèÂàáÊç¢ÁöÑÂÖ∑‰ΩìÈÄªËæë
            // ‰æãÂ¶ÇÂèëÈÄÅAPIËØ∑Ê±ÇÂà∞ÊúçÂä°Âô®
        }

        // ËÆæÂ§áÂ±ÇÁ∫ßÂ±ïÂºÄ/Êî∂Ëµ∑
        function toggleDeviceChildren(systemId) {
            const toggleIcon = document.getElementById(`toggle-${systemId}`);
            const childRows = document.querySelectorAll(`tr[data-parent="${systemId}"]`);
            
            if (toggleIcon.textContent === 'üìÇ') {
                // Â±ïÂºÄ
                toggleIcon.textContent = 'üìÅ';
                childRows.forEach(row => {
                    row.style.display = 'table-row';
                });
            } else {
                // Êî∂Ëµ∑
                toggleIcon.textContent = 'üìÇ';
                childRows.forEach(row => {
                    row.style.display = 'none';
                });
            }
        }
        
        // Â±ïÂºÄÊâÄÊúâËÆæÂ§á
        function expandAllDevices() {
            const parentRows = document.querySelectorAll('.parent-row');
            parentRows.forEach(row => {
                const systemId = row.getAttribute('data-device-id');
                const toggleIcon = document.getElementById(`toggle-${systemId}`);
                const childRows = document.querySelectorAll(`tr[data-parent="${systemId}"]`);
                
                toggleIcon.textContent = 'üìÅ';
                childRows.forEach(childRow => {
                    childRow.style.display = 'table-row';
                });
            });
        }
        
        // Êî∂Ëµ∑ÊâÄÊúâËÆæÂ§á
        function collapseAllDevices() {
            const parentRows = document.querySelectorAll('.parent-row');
            parentRows.forEach(row => {
                const systemId = row.getAttribute('data-device-id');
                const toggleIcon = document.getElementById(`toggle-${systemId}`);
                const childRows = document.querySelectorAll(`tr[data-parent="${systemId}"]`);
                
                toggleIcon.textContent = 'üìÇ';
                childRows.forEach(childRow => {
                    childRow.style.display = 'none';
                });
            });
        }
        
        // ËÆæÂ§áÊêúÁ¥¢ÂäüËÉΩ
        function searchDevices() {
            const nameFilter = document.getElementById('device-name-search').value.toLowerCase();
            const typeFilter = document.getElementById('device-type-filter').value;
            const statusFilter = document.getElementById('device-status-filter').value;
            
            const deviceRows = document.querySelectorAll('.device-row');
            
            deviceRows.forEach(row => {
                const nameCell = row.cells[1];
                const typeCell = row.cells[2];
                const statusCell = row.cells[4];
                
                if (!nameCell || !typeCell || !statusCell) return;
                
                const deviceName = nameCell.textContent.toLowerCase();
                const deviceType = typeCell.getAttribute('data-i18n') || '';
                const deviceStatus = statusCell.textContent.toLowerCase();
                
                let showRow = true;
                
                // ÂêçÁß∞ËøáÊª§
                if (nameFilter && !deviceName.includes(nameFilter)) {
                    showRow = false;
                }
                
                // Á±ªÂûãËøáÊª§
                if (typeFilter && !deviceType.includes(typeFilter)) {
                    showRow = false;
                }
                
                // Áä∂ÊÄÅËøáÊª§
                if (statusFilter && !deviceStatus.includes(statusFilter)) {
                    showRow = false;
                }
                
                row.style.display = showRow ? 'table-row' : 'none';
            });
        }
        
        // ÈáçÁΩÆËÆæÂ§áÊêúÁ¥¢
        function resetDeviceSearch() {
            document.getElementById('device-name-search').value = '';
            document.getElementById('device-type-filter').value = '';
            document.getElementById('device-status-filter').value = '';
            
            const deviceRows = document.querySelectorAll('.device-row');
            deviceRows.forEach(row => {
                row.style.display = 'table-row';
            });
            
            // ÈáçÁΩÆÂêéÊî∂Ëµ∑ÊâÄÊúâËÆæÂ§á
            collapseAllDevices();
        }
        
        // Êü•ÁúãËÆæÂ§áËØ¶ÊÉÖ
        function viewDeviceDetails(deviceId) {
            alert(`Êü•ÁúãËÆæÂ§áËØ¶ÊÉÖ: ${deviceId}`);
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÊâìÂºÄËÆæÂ§áËØ¶ÊÉÖÂºπÁ™óÊàñË∑≥ËΩ¨ÁöÑÈÄªËæë
        }
        
        // Âà†Èô§ËÆæÂ§á
        function deleteDevice(deviceId) {
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ËÆæÂ§á ${deviceId} ÂêóÔºü`)) {
                alert(`ËÆæÂ§á ${deviceId} Â∑≤Âà†Èô§`);
                // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Âà†Èô§ËÆæÂ§áÁöÑÈÄªËæë
            }
        }

        // Êñ∞ÁâàËÆæÂ§áÁÆ°ÁêÜÂäüËÉΩ
        function searchDevices() {
            const deviceName = document.getElementById('device-name-search').value;
            const deviceStatus = document.getElementById('device-status-search').value;
            
            console.log('ËÆæÂ§áÊêúÁ¥¢Êù°‰ª∂Ôºö', { deviceName, deviceStatus });
            alert('ËÆæÂ§áÊêúÁ¥¢ÂäüËÉΩ');
        }

        function resetDeviceSearch() {
            document.getElementById('device-name-search').value = '';
            document.getElementById('device-status-search').value = '';
            alert('ËÆæÂ§áÊêúÁ¥¢Êù°‰ª∂Â∑≤ÈáçÁΩÆ');
        }

        function createDevice() {
            alert('Êñ∞Âª∫ËÆæÂ§áÂäüËÉΩ');
        }


        function sortDeviceTable(column, direction) {
            console.log('ËÆæÂ§áË°®Ê†ºÊéíÂ∫èÔºö', column, direction);
            alert(`Êåâ${column}${direction === 'asc' ? 'ÂçáÂ∫è' : 'ÈôçÂ∫è'}ÊéíÂ∫è`);
        }

        function viewDeviceDetails(deviceId) {
            alert(`Êü•ÁúãËÆæÂ§áËØ¶ÊÉÖ: ${deviceId}`);
        }
        
        // ËÆæÂ§áÁä∂ÊÄÅÊõ¥Êñ∞ÂáΩÊï∞
        function updateDeviceStatus(status) {
            const statusElement = document.querySelector('.device-status');
            const statusDot = statusElement.querySelector('.status-dot');
            const statusText = statusElement.querySelector('.status-text');
            
            const statusConfig = {
                'online': { color: '#10b981', text: 'Âú®Á∫ø' },
                'offline': { color: '#ef4444', text: 'Á¶ªÁ∫ø' },
                'alarm': { color: '#f59e0b', text: 'ÂëäË≠¶' }
            };
            
            const config = statusConfig[status];
            if (config) {
                statusDot.style.background = config.color;
                statusText.style.color = config.color;
                statusText.textContent = config.text;
            }
        }

        // ËÆæÁΩÆÈù¢ÊùøÂàáÊç¢ÂáΩÊï∞
        function toggleSettingsPanel() {
            const panel = document.getElementById('settings-panel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // ÊåáÊ†áÊòæÁ§∫ÊéßÂà∂ÂáΩÊï∞
        function toggleMetric(metricName, show) {
            const metricSection = document.querySelector(`[data-metric="${metricName}"]`);
            if (metricSection) {
                metricSection.style.display = show ? 'block' : 'none';
            }
        }

        // ÁªÜÁ≤íÂ∫¶ÊåáÊ†áÊòæÁ§∫ÊéßÂà∂ÂáΩÊï∞
        function toggleMetricItem(itemName, show) {
            const metricItem = document.querySelector(`[data-metric-item="${itemName}"]`);
            if (metricItem) {
                metricItem.style.display = show ? 'flex' : 'none';
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÈöêËóèÊï¥‰∏™ÂàÜÁ±ª
            const parentSection = metricItem.closest('.metrics-section');
            if (parentSection) {
                const visibleItems = parentSection.querySelectorAll('.metrics-item:not([style*="display: none"])');
                const sectionTitle = parentSection.querySelector('.metrics-title');
                if (visibleItems.length === 0) {
                    sectionTitle.style.display = 'none';
                } else {
                    sectionTitle.style.display = 'block';
                }
            }
        }

        // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ËÆæÁΩÆÈù¢Êùø
        document.addEventListener('click', function(event) {
            const settingsBtn = document.getElementById('settings-btn');
            const settingsPanel = document.getElementById('settings-panel');
            
            if (settingsBtn && settingsPanel && 
                !settingsBtn.contains(event.target) && 
                !settingsPanel.contains(event.target)) {
                settingsPanel.style.display = 'none';
            }
        });

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÊâßË°å
        document.addEventListener('DOMContentLoaded', function() {
            // ÂàùÂßãÂåñÈ°µÈù¢
            initPage();
            
            // TabÁªÑ‰ª∂ÊöÇÊó∂‰∏ç‰ΩøÁî®Ôºå‰øùÊåÅÂéüÊúâÁªìÊûÑ
            
            // ÂàùÂßãÂåñËÆæÁΩÆÈù¢ÊùøÂ§çÈÄâÊ°Ü‰∫ã‰ª∂
            const checkboxes = document.querySelectorAll('#settings-panel input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const metricName = this.getAttribute('data-metric');
                    const metricItemName = this.getAttribute('data-metric-item');
                    
                    if (metricItemName) {
                        toggleMetricItem(metricItemName, this.checked);
                    } else if (metricName) {
                        toggleMetric(metricName, this.checked);
                    }
                });
            });
            
            // Â∫îÁî®‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
            const savedTheme = localStorage.getItem('ess_theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            
            // Â∫îÁî®ËØ≠Ë®Ä
            applyLanguage();
            
            // ÂàõÂª∫ËÉΩÈáèÊµÅÂêëËøûÁ∫ø
            setTimeout(function() {
                createEnergyFlowLines();
            }, 100);
            
            // Á™óÂè£Â§ßÂ∞èÊîπÂèòÊó∂ÈáçÊñ∞ÁªòÂà∂ËøûÁ∫ø
            window.addEventListener('resize', createEnergyFlowLines);
            
            // ÂÜçÊ¨°Â∞ùËØïÂàõÂª∫ËøûÁ∫øÔºàÂ§áÁî®Ôºâ
            setTimeout(createEnergyFlowLines, 500);
            
        });
    </script>

    <!-- ÂºïÂÖ•‰æßËæπÊ†èËÑöÊú¨ -->
    <script src="../sidebar.js"></script>
    <script src="../tab-component.js"></script>
</body>
</html>