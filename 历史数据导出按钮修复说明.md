# å†å²æ•°æ®å¯¼å‡ºæŒ‰é’®ä¿®å¤è¯´æ˜

## ğŸ“‹ é—®é¢˜æè¿°

åœ¨è®¾å¤‡è¯¦æƒ…é¡µé¢ ([cabinet-detail.html](cabinet-detail.html)),åŸæœ¬éšè—çš„ã€å†å²æ•°æ®å¯¼å‡ºã€‘æŒ‰é’®éœ€è¦æ¢å¤æ˜¾ç¤º,å¹¶ç¡®ä¿å¯ä»¥æ­£å¸¸ç‚¹å‡»ä½¿ç”¨ã€‚

## ğŸ” é—®é¢˜åˆ†æ

é¡µé¢ä¸­æœ‰ä¸¤ä¸ªå¯¼å‡ºæŒ‰é’®è¢«éšè—:

1. **é¡¶éƒ¨å¯¼å‡ºæŒ‰é’®** ([cabinet-detail.html:797](cabinet-detail.html#L797))
   - ä½ç½®: é¡µé¢å³ä¸Šè§’,è®¾å¤‡çŠ¶æ€ä¿¡æ¯æ—è¾¹
   - æ ·å¼é—®é¢˜: `display: none`
   - æ–‡æœ¬: "å†å²æ•°æ®å¯¼å‡º"

2. **å†å²æ•°æ®æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’®** ([cabinet-detail.html:955](cabinet-detail.html#L955))
   - ä½ç½®: å†å²æ•°æ®æ ‡ç­¾é¡µçš„å³ä¸Šè§’
   - æ ·å¼é—®é¢˜: `display: none`
   - æ–‡æœ¬: "å¯¼å‡ºæ•°æ®"

## âœ¨ è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹æ–‡ä»¶

1. **[cabinet-detail.html](cabinet-detail.html)** - ä¿®å¤æŒ‰é’®æ˜¾ç¤º
2. **[common.js](common.js)** - æ·»åŠ ç¼ºå¤±çš„ç¿»è¯‘é”®

### å…·ä½“ä¿®æ”¹

#### 1. æ¢å¤é¡¶éƒ¨å¯¼å‡ºæŒ‰é’®æ˜¾ç¤º

**ä¿®æ”¹ä½ç½®**: [cabinet-detail.html:797](cabinet-detail.html#L797)

**ä¿®æ”¹å‰:**
```html
<button onclick="navigateToExportPage()"
        style="... display: none; align-items: center; ...">
    <i class="fas fa-download"></i>
    <span data-translate="cabinetHistoryExport">å†å²æ•°æ®å¯¼å‡º</span>
</button>
```

**ä¿®æ”¹å:**
```html
<button onclick="navigateToExportPage()"
        style="... display: flex; align-items: center; ...">
    <i class="fas fa-download"></i>
    <span data-translate="cabinetHistoryExport">å†å²æ•°æ®å¯¼å‡º</span>
</button>
```

**å˜æ›´**: `display: none` â†’ `display: flex`

#### 2. æ¢å¤å†å²æ•°æ®æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’®æ˜¾ç¤º

**ä¿®æ”¹ä½ç½®**: [cabinet-detail.html:955](cabinet-detail.html#L955)

**ä¿®æ”¹å‰:**
```html
<button class="settings-btn export-data-btn"
        onclick="navigateToExportPage()"
        style="... display: none;">
    <i class="fas fa-download"></i>
    <span id="cabinetBtnExportData" data-translate="cabinetBtnExportData">å¯¼å‡ºæ•°æ®</span>
</button>
```

**ä¿®æ”¹å:**
```html
<button class="settings-btn export-data-btn"
        onclick="navigateToExportPage()"
        style="... display: inline-flex;">
    <i class="fas fa-download"></i>
    <span id="cabinetBtnExportData" data-translate="cabinetBtnExportData">å¯¼å‡ºæ•°æ®</span>
</button>
```

**å˜æ›´**: `display: none` â†’ `display: inline-flex`

#### 3. æ·»åŠ ç¼ºå¤±çš„ç¿»è¯‘é”®

**ä¿®æ”¹ä½ç½®**: [common.js](common.js)

**ä¸­æ–‡ç¿»è¯‘** (line 2949):
```javascript
cabinetHistoryExport: 'å†å²æ•°æ®å¯¼å‡º',
cabinetBtnExportData: 'å¯¼å‡ºæ•°æ®',  // æ–°å¢
```

**è‹±æ–‡ç¿»è¯‘** (line 6367):
```javascript
cabinetHistoryExport: 'Export Historical Data',
cabinetBtnExportData: 'Export Data',  // æ–°å¢
```

## ğŸ¨ æŒ‰é’®åŠŸèƒ½è¯´æ˜

### navigateToExportPage() å‡½æ•°

**ä½ç½®**: [cabinet-detail.html:6727](cabinet-detail.html#L6727)

**åŠŸèƒ½**: è·³è½¬åˆ°å†å²æ•°æ®å¯¼å‡ºé¡µé¢

```javascript
function navigateToExportPage() {
    // è·å–å½“å‰ç»„ä»¶
    const component = currentComponent || 'overall';

    // ç»„ä»¶åç§°åˆ°export-data.htmlçš„componentå‚æ•°æ˜ å°„
    const componentParamMap = {
        'overall': 'overall',
        'ems': 'ems',
        'pcs': 'pcs',
        'bms': 'bms',
        'meter': 'meter',
        'thermal': 'thermal',
        'cooling': 'cooling',
        'fire': 'fire'
    };

    // æ„å»ºURLå‚æ•°
    const urlParams = new URLSearchParams(window.location.search);
    const cabinetId = urlParams.get('cabinetId');
    const componentParam = componentParamMap[component];

    // è·³è½¬åˆ°å¯¼å‡ºæ•°æ®é¡µé¢
    window.location.href = `export-data.html?cabinetId=${cabinetId}&component=${componentParam}`;
}
```

**è·³è½¬é€»è¾‘**:
1. è·å–å½“å‰æŸ¥çœ‹çš„ç»„ä»¶(Overall/EMS/PCS/BMSç­‰)
2. è·å–å½“å‰è®¾å¤‡ID(cabinetId)
3. è·³è½¬åˆ° `export-data.html` å¹¶ä¼ é€’å‚æ•°

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

### ç¿»è¯‘é”®åˆ—è¡¨

| ç¿»è¯‘é”® | ä¸­æ–‡ | English | ç”¨é€” |
|--------|------|---------|------|
| `cabinetHistoryExport` | å†å²æ•°æ®å¯¼å‡º | Export Historical Data | é¡¶éƒ¨å¯¼å‡ºæŒ‰é’® |
| `cabinetBtnExportData` | å¯¼å‡ºæ•°æ® | Export Data | å†å²æ•°æ®æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’® |

### ä½¿ç”¨æ–¹å¼

æŒ‰é’®æ–‡æœ¬ä¼šæ ¹æ®å½“å‰è¯­è¨€ç¯å¢ƒè‡ªåŠ¨åˆ‡æ¢:
- **ä¸­æ–‡æ¨¡å¼**: æ˜¾ç¤º"å†å²æ•°æ®å¯¼å‡º"å’Œ"å¯¼å‡ºæ•°æ®"
- **è‹±æ–‡æ¨¡å¼**: æ˜¾ç¤º"Export Historical Data"å’Œ"Export Data"

## ğŸ“Š æŒ‰é’®ä½ç½®ç¤ºæ„

### 1. é¡¶éƒ¨å¯¼å‡ºæŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cabinet 1  â— Online  âš¡ Charging  [å†å²æ•°æ®å¯¼å‡º] â”‚
â”‚ Running Light âœ“  Alarm Light â—  Emergency Stop  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä½ç½®**: é¡µé¢å³ä¸Šè§’,è®¾å¤‡çŠ¶æ€ä¿¡æ¯åŒºåŸŸ
**æ ·å¼**: è“è‰²èƒŒæ™¯æŒ‰é’®,å¸¦ä¸‹è½½å›¾æ ‡

### 2. å†å²æ•°æ®æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å®æ—¶æ•°æ®] [å†å²æ•°æ®] [æ§åˆ¶]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [24å°æ—¶] [7å¤©] [30å¤©] [1å¹´]  [å¯¼å‡ºæ•°æ®] [âš™ï¸è®¾ç½®] â”‚
â”‚                                                 â”‚
â”‚ (å†å²æ•°æ®å›¾è¡¨åŒºåŸŸ)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä½ç½®**: å†å²æ•°æ®æ ‡ç­¾é¡µ,æ—¶é—´èŒƒå›´é€‰æ‹©å™¨å³ä¾§
**æ ·å¼**: è®¾ç½®æŒ‰é’®æ ·å¼,å¸¦ä¸‹è½½å›¾æ ‡

## ğŸ§ª æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•

1. âœ… **é¡¶éƒ¨å¯¼å‡ºæŒ‰é’®**
   - æ‰“å¼€è®¾å¤‡è¯¦æƒ…é¡µé¢
   - ç¡®è®¤å³ä¸Šè§’æ˜¾ç¤º"å†å²æ•°æ®å¯¼å‡º"æŒ‰é’®
   - ç‚¹å‡»æŒ‰é’®è·³è½¬åˆ°å¯¼å‡ºé¡µé¢
   - éªŒè¯è·³è½¬URLåŒ…å«æ­£ç¡®çš„å‚æ•°

2. âœ… **å†å²æ•°æ®æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’®**
   - åˆ‡æ¢åˆ°"å†å²æ•°æ®"æ ‡ç­¾é¡µ
   - ç¡®è®¤å³ä¸Šè§’æ˜¾ç¤º"å¯¼å‡ºæ•°æ®"æŒ‰é’®
   - ç‚¹å‡»æŒ‰é’®è·³è½¬åˆ°å¯¼å‡ºé¡µé¢
   - éªŒè¯è·³è½¬URLåŒ…å«æ­£ç¡®çš„å‚æ•°

### å›½é™…åŒ–æµ‹è¯•

1. âœ… **ä¸­æ–‡æ¨¡å¼**
   - é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º: "å†å²æ•°æ®å¯¼å‡º"
   - æ ‡ç­¾é¡µæŒ‰é’®æ˜¾ç¤º: "å¯¼å‡ºæ•°æ®"

2. âœ… **è‹±æ–‡æ¨¡å¼**
   - é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º: "Export Historical Data"
   - æ ‡ç­¾é¡µæŒ‰é’®æ˜¾ç¤º: "Export Data"

### ä¸åŒç»„ä»¶æµ‹è¯•

æµ‹è¯•åœ¨ä¸åŒç»„ä»¶æ ‡ç­¾é¡µä¸‹ç‚¹å‡»å¯¼å‡ºæŒ‰é’®:

| ç»„ä»¶ | è·³è½¬URLç¤ºä¾‹ |
|------|------------|
| Overall | `export-data.html?cabinetId=1&component=overall` |
| EMS | `export-data.html?cabinetId=1&component=ems` |
| PCS | `export-data.html?cabinetId=1&component=pcs` |
| BMS | `export-data.html?cabinetId=1&component=bms` |
| Meter | `export-data.html?cabinetId=1&component=meter` |
| Thermal | `export-data.html?cabinetId=1&component=thermal` |
| Cooling | `export-data.html?cabinetId=1&component=cooling` |
| Fire | `export-data.html?cabinetId=1&component=fire` |

## ğŸ“Š ä¿®æ”¹ç»Ÿè®¡

```
cabinet-detail.html | 4 +-
common.js          | 2 ++
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2 files changed, 4 insertions(+), 2 deletions(-)
```

### å…·ä½“å˜æ›´

**cabinet-detail.html**:
- ç¬¬ 797 è¡Œ: é¡¶éƒ¨å¯¼å‡ºæŒ‰é’® `display: none` â†’ `display: flex`
- ç¬¬ 955 è¡Œ: æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’® `display: none` â†’ `display: inline-flex`

**common.js**:
- ç¬¬ 2949 è¡Œ: æ·»åŠ ä¸­æ–‡ç¿»è¯‘ `cabinetBtnExportData: 'å¯¼å‡ºæ•°æ®'`
- ç¬¬ 6367 è¡Œ: æ·»åŠ è‹±æ–‡ç¿»è¯‘ `cabinetBtnExportData: 'Export Data'`

## ğŸ¯ æŒ‰é’®æ ·å¼è¯´æ˜

### é¡¶éƒ¨å¯¼å‡ºæŒ‰é’®

```css
height: 40px;
padding: 0 14px;
background: #3b82f6;
color: white;
border: none;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
display: flex;
align-items: center;
gap: 6px;
font-size: 13px;
font-weight: 500;
cursor: pointer;
```

**æ‚¬åœæ•ˆæœ**: èƒŒæ™¯è‰²å˜æ·± `#2563eb`

### æ ‡ç­¾é¡µå¯¼å‡ºæŒ‰é’®

```css
class: settings-btn export-data-btn
display: inline-flex;
margin-bottom: 0;
margin-right: 8px;
```

**æ ·å¼ç‰¹ç‚¹**:
- ä¸è®¾ç½®æŒ‰é’®æ ·å¼ä¿æŒä¸€è‡´
- ä¸å…¶ä»–å·¥å…·æ æŒ‰é’®å¯¹é½
- å“åº”å¼å¸ƒå±€å‹å¥½

## âœ… è®¾è®¡åŸåˆ™éµå¾ª

### KISS (Keep It Simple, Stupid)
- åªä¿®æ”¹å¿…è¦çš„ display å±æ€§
- ä¸æ”¹å˜æŒ‰é’®çš„å…¶ä»–åŠŸèƒ½å’Œæ ·å¼
- ä¿æŒä»£ç ç®€æ´

### DRY (Don't Repeat Yourself)
- ä¸¤ä¸ªæŒ‰é’®å…±ç”¨åŒä¸€ä¸ª `navigateToExportPage()` å‡½æ•°
- å¤ç”¨ç°æœ‰çš„å›½é™…åŒ–ç³»ç»Ÿ

### å•ä¸€èŒè´£åŸåˆ™
- `navigateToExportPage()` å‡½æ•°åªè´Ÿè´£è·³è½¬é€»è¾‘
- å¯¼å‡ºæ•°æ®çš„å…·ä½“å®ç°åœ¨ export-data.html ä¸­

## ğŸ“ æ€»ç»“

æœ¬æ¬¡ä¿®å¤å®Œæ•´æ¢å¤äº†è®¾å¤‡è¯¦æƒ…é¡µé¢çš„å†å²æ•°æ®å¯¼å‡ºåŠŸèƒ½:

âœ… **ä¸¤ä¸ªå¯¼å‡ºæŒ‰é’®å·²æ¢å¤æ˜¾ç¤º**
- é¡¶éƒ¨çš„"å†å²æ•°æ®å¯¼å‡º"æŒ‰é’®
- å†å²æ•°æ®æ ‡ç­¾é¡µçš„"å¯¼å‡ºæ•°æ®"æŒ‰é’®

âœ… **å®Œæ•´çš„å›½é™…åŒ–æ”¯æŒ**
- ä¸­è‹±æ–‡è‡ªåŠ¨åˆ‡æ¢
- æ‰€æœ‰æ–‡æœ¬éƒ½å·²å›½é™…åŒ–

âœ… **åŠŸèƒ½æ­£å¸¸å¯ç”¨**
- ç‚¹å‡»æŒ‰é’®æ­£ç¡®è·³è½¬
- å‚æ•°ä¼ é€’å‡†ç¡®
- é€‚é…æ‰€æœ‰ç»„ä»¶ç±»å‹

âœ… **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
- æŒ‰é’®ä½ç½®é†’ç›®
- æ ·å¼ç»Ÿä¸€ç¾è§‚
- äº¤äº’åé¦ˆæ¸…æ™°

ç°åœ¨å¯ä»¥åœ¨è®¾å¤‡è¯¦æƒ…é¡µé¢æ­£å¸¸ä½¿ç”¨å†å²æ•°æ®å¯¼å‡ºåŠŸèƒ½äº†! ğŸ‰
